[0m10:43:46.708505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082da850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ea4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ead50>]}


============================== 10:43:46.710250 | eb3ce87d-05a4-43f6-862b-b40e84d894c7 ==============================
[0m10:43:46.710250 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:43:46.710574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:43:46.807270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cbe90>]}
[0m10:43:46.813138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cbe90>]}
[0m10:43:46.813641 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:43:46.822821 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m10:43:46.823187 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:43:46.823395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830c150>]}
[0m10:43:47.054061 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m10:43:47.059520 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m10:43:47.088436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108baf350>]}
[0m10:43:47.091204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba5750>]}
[0m10:43:47.091387 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:43:47.092225 [info ] [MainThread]: 
[0m10:43:47.092550 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:43:47.092961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:43:47.098160 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:43:47.098295 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:43:47.098406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:52.128484 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 5.0 seconds
[0m10:43:52.132451 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:52.266869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:43:52.274424 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:43:52.274763 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:43:52.275034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:52.683736 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m10:43:52.687100 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:43:52.816247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa4710>]}
[0m10:43:52.817041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:52.817402 [info ] [MainThread]: 
[0m10:43:52.834926 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.835327 [info ] [Thread-1 (]: 1 of 6 START sql table model DBT_AMOLEIRO.my_first_dbt_model ................... [RUN]
[0m10:43:52.835835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m10:43:52.836050 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.837949 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.838653 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 10:43:52.836184 => 10:43:52.838526
[0m10:43:52.838866 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.855405 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.856208 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.856413 [debug] [Thread-1 (]: On model.refactoring_for_modularity.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.my_first_dbt_model"} */
create or replace transient table analytics.DBT_AMOLEIRO.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:43:52.856598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:54.363495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:43:54.387779 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 10:43:52.838995 => 10:43:54.387613
[0m10:43:54.388146 [debug] [Thread-1 (]: On model.refactoring_for_modularity.my_first_dbt_model: Close
[0m10:43:54.495099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1d790>]}
[0m10:43:54.496350 [info ] [Thread-1 (]: 1 of 6 OK created sql table model DBT_AMOLEIRO.my_first_dbt_model .............. [[32mSUCCESS 1[0m in 1.66s]
[0m10:43:54.497342 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:54.499040 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.499726 [info ] [Thread-1 (]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m10:43:54.500738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m10:43:54.501180 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.517695 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.518673 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 10:43:54.501457 => 10:43:54.518509
[0m10:43:54.518978 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.561136 [debug] [Thread-1 (]: Writing runtime sql for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.561822 [debug] [Thread-1 (]: Using snowflake connection "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.562021 [debug] [Thread-1 (]: On test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from analytics.DBT_AMOLEIRO.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m10:43:54.562191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:55.182309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:43:55.190074 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 10:43:54.519163 => 10:43:55.189722
[0m10:43:55.190691 [debug] [Thread-1 (]: On test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m10:43:55.304010 [error] [Thread-1 (]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.80s]
[0m10:43:55.304905 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:55.305387 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.305917 [info ] [Thread-1 (]: 3 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m10:43:55.306673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m10:43:55.307061 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.313621 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.314363 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 10:43:55.307274 => 10:43:55.314207
[0m10:43:55.314659 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.316736 [debug] [Thread-1 (]: Writing runtime sql for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.317613 [debug] [Thread-1 (]: Using snowflake connection "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.318057 [debug] [Thread-1 (]: On test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.DBT_AMOLEIRO.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:43:55.318345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:55.813273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:43:55.819700 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 10:43:55.314833 => 10:43:55.819147
[0m10:43:55.820688 [debug] [Thread-1 (]: On test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321: Close
[0m10:43:55.942332 [info ] [Thread-1 (]: 3 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m10:43:55.943338 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.944375 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m10:43:55.944883 [info ] [Thread-1 (]: 4 of 6 SKIP relation DBT_AMOLEIRO.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m10:43:55.945442 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m10:43:55.946135 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m10:43:55.946612 [info ] [Thread-1 (]: 5 of 6 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m10:43:55.947146 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m10:43:55.947562 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m10:43:55.948002 [info ] [Thread-1 (]: 6 of 6 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m10:43:55.948496 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m10:43:55.950116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:55.950438 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m10:43:55.950773 [info ] [MainThread]: 
[0m10:43:55.951095 [info ] [MainThread]: Finished running 1 table model, 4 tests, 1 view model in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m10:43:55.951959 [debug] [MainThread]: Command end result
[0m10:43:55.957904 [info ] [MainThread]: 
[0m10:43:55.958228 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:43:55.958485 [info ] [MainThread]: 
[0m10:43:55.958744 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m10:43:55.958995 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:43:55.959235 [info ] [MainThread]: 
[0m10:43:55.959571 [info ] [MainThread]:   compiled Code at target/compiled/refactoring_for_modularity/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m10:43:55.959918 [info ] [MainThread]: 
[0m10:43:55.960229 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m10:43:55.960688 [debug] [MainThread]: Command `dbt build` failed at 10:43:55.960610 after 9.26 seconds
[0m10:43:55.961008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47410>]}
[0m10:43:55.961322 [debug] [MainThread]: Flushing usage events
[0m10:45:30.307075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c6610>]}


============================== 10:45:30.308923 | f0ecf51d-2f3b-461c-9cba-6b4dfe7a32ad ==============================
[0m10:45:30.308923 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:45:30.309256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:45:30.319092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0ecf51d-2f3b-461c-9cba-6b4dfe7a32ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81190>]}
[0m10:45:30.319418 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:45:30.319707 [debug] [MainThread]: Command `dbt deps` succeeded at 10:45:30.319653 after 0.02 seconds
[0m10:45:30.319865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472c250>]}
[0m10:45:30.320017 [debug] [MainThread]: Flushing usage events
[0m10:46:07.336083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104592850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a2410>]}


============================== 10:46:07.337909 | 9f66b2fe-399d-4e1f-a364-9900ba67afbc ==============================
[0m10:46:07.337909 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:46:07.338243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:46:07.348153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045adc90>]}
[0m10:46:07.349059 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-7lefbxz_'
[0m10:46:07.349260 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:46:07.640042 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:46:07.643236 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m10:46:07.842295 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m10:46:07.848063 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:46:08.022935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:46:08.040161 [info ] [MainThread]: Installing dbt-labs/codegen
[0m10:46:08.433565 [info ] [MainThread]: Installed from version 0.10.0
[0m10:46:08.433977 [info ] [MainThread]: Up to date!
[0m10:46:08.434345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104593d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e0b10>]}
[0m10:46:08.434682 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:46:08.936254 [info ] [MainThread]: Installed from version 1.1.1
[0m10:46:08.936521 [info ] [MainThread]: Up to date!
[0m10:46:08.936840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408fe50>]}
[0m10:46:08.937467 [debug] [MainThread]: Command `dbt deps` succeeded at 10:46:08.937400 after 1.61 seconds
[0m10:46:08.937662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b27510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cff410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd4990>]}
[0m10:46:08.937838 [debug] [MainThread]: Flushing usage events
[0m11:41:10.530851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424ba10>]}


============================== 11:41:10.532657 | a1f2e0ca-3429-4fc4-b5df-7122b371555e ==============================
[0m11:41:10.532657 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:41:10.532966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:41:10.637878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104231bd0>]}
[0m11:41:10.643886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104231bd0>]}
[0m11:41:10.644157 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:41:10.659574 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:41:10.678196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:10.678449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:10.681655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ae750>]}
[0m11:41:10.682974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b22010>]}
[0m11:41:10.683188 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:41:10.683365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fc0f50>]}
[0m11:41:10.684217 [info ] [MainThread]: 
[0m11:41:10.684618 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:10.685099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m11:41:10.691212 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:41:10.691406 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:41:10.691536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:13.553502 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 3.0 seconds
[0m11:41:13.557984 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:41:13.673037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f75410>]}
[0m11:41:13.673989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:13.674431 [info ] [MainThread]: 
[0m11:41:13.679436 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.680168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m11:41:13.680514 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.683921 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m11:41:13.684821 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 11:41:13.680728 => 11:41:13.684655
[0m11:41:13.685092 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.685403 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 11:41:13.685264 => 11:41:13.685279
[0m11:41:13.686072 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.686662 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.687235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now model.refactoring_for_modularity.my_second_dbt_model)
[0m11:41:13.687523 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.689866 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_second_dbt_model"
[0m11:41:13.690453 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (compile): 11:41:13.687703 => 11:41:13.690309
[0m11:41:13.690676 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.690935 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (execute): 11:41:13.690821 => 11:41:13.690827
[0m11:41:13.691471 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.691721 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.692188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_second_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:41:13.692400 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.701298 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:41:13.701819 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 11:41:13.692538 => 11:41:13.701699
[0m11:41:13.702033 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.702276 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 11:41:13.702166 => 11:41:13.702173
[0m11:41:13.702776 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.703003 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.703372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m11:41:13.703571 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.707436 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m11:41:13.707840 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 11:41:13.703698 => 11:41:13.707728
[0m11:41:13.708025 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.708241 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 11:41:13.708146 => 11:41:13.708151
[0m11:41:13.708673 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.708882 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.709211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321, now test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778)
[0m11:41:13.709403 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.711799 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778"
[0m11:41:13.712186 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:41:13.709522 => 11:41:13.712083
[0m11:41:13.712368 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.712577 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:41:13.712486 => 11:41:13.712490
[0m11:41:13.712998 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.713197 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.713556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778, now test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:41:13.713733 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.715980 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:41:13.716368 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:41:13.713864 => 11:41:13.716268
[0m11:41:13.716534 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.716727 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:41:13.716643 => 11:41:13.716646
[0m11:41:13.717125 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.717576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:13.717713 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:41:13.718266 [debug] [MainThread]: Command end result
[0m11:41:13.724482 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:41:13.724636 [info ] [MainThread]: Building catalog
[0m11:41:13.725250 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m11:41:13.729027 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m11:41:13.729307 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m11:41:13.729562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:16.178081 [debug] [ThreadPool]: SQL status: SUCCESS 83 in 2.0 seconds
[0m11:41:16.195433 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m11:41:16.337707 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/target/catalog.json
[0m11:41:16.338629 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:41:16.338529 after 5.82 seconds
[0m11:41:16.338904 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:41:16.339108 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m11:41:16.339386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fc1190>]}
[0m11:41:16.339682 [debug] [MainThread]: Flushing usage events
[0m11:45:04.231409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11186a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11187a250>]}


============================== 11:45:04.233187 | 2b78b227-a0c5-47b8-abfe-3e9ef68187b0 ==============================
[0m11:45:04.233187 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:45:04.233489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:45:04.332302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b78b227-a0c5-47b8-abfe-3e9ef68187b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120de010>]}
[0m11:45:04.338082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b78b227-a0c5-47b8-abfe-3e9ef68187b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118caa90>]}
[0m11:46:35.608693 [error] [MainThread]: Encountered an error:

[0m11:46:35.613811 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:46:35.615840 [debug] [MainThread]: Command `dbt docs serve` failed at 11:46:35.615549 after 91.39 seconds
[0m11:46:35.616532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111861850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11186a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112191f90>]}
[0m11:46:35.617149 [debug] [MainThread]: Flushing usage events
[0m11:46:40.911313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b43110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b43990>]}


============================== 11:46:40.913053 | 5941d7f4-5be9-4dbe-970b-b5eb285619bf ==============================
[0m11:46:40.913053 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:46:40.913381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:41.012346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b349d0>]}
[0m11:46:41.018208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109330910>]}
[0m11:46:41.018468 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:46:41.032635 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:46:41.051041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:41.051211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:41.053862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109308ad0>]}
[0m11:46:41.054666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094298d0>]}
[0m11:46:41.054838 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:46:41.055026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c4f50>]}
[0m11:46:41.055853 [info ] [MainThread]: 
[0m11:46:41.056213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:41.056678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m11:46:41.062584 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:46:41.062782 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:46:41.062923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:41.741005 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m11:46:41.743168 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:46:41.855162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0e90>]}
[0m11:46:41.856245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:41.856691 [info ] [MainThread]: 
[0m11:46:41.862650 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.863531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m11:46:41.863974 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.867107 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m11:46:41.867982 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 11:46:41.864200 => 11:46:41.867780
[0m11:46:41.868316 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.868693 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 11:46:41.868522 => 11:46:41.868536
[0m11:46:41.869502 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.870264 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.870902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now model.refactoring_for_modularity.my_second_dbt_model)
[0m11:46:41.871187 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.873464 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_second_dbt_model"
[0m11:46:41.874085 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (compile): 11:46:41.871367 => 11:46:41.873938
[0m11:46:41.874338 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.874639 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (execute): 11:46:41.874503 => 11:46:41.874511
[0m11:46:41.875277 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.875585 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.876119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_second_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:46:41.876361 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.884909 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:46:41.885391 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 11:46:41.876524 => 11:46:41.885273
[0m11:46:41.885595 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.885843 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 11:46:41.885731 => 11:46:41.885737
[0m11:46:41.886318 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.886538 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.886898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m11:46:41.887086 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.891162 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m11:46:41.891573 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 11:46:41.887212 => 11:46:41.891452
[0m11:46:41.891776 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.892021 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 11:46:41.891909 => 11:46:41.891915
[0m11:46:41.892486 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.892703 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.893025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321, now test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778)
[0m11:46:41.893199 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.896465 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778"
[0m11:46:41.897036 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:46:41.893314 => 11:46:41.896924
[0m11:46:41.897220 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.897426 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:46:41.897336 => 11:46:41.897340
[0m11:46:41.897848 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.898065 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.898385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778, now test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:46:41.898565 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.900727 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:46:41.901093 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:46:41.898682 => 11:46:41.900990
[0m11:46:41.901262 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.901456 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:46:41.901371 => 11:46:41.901374
[0m11:46:41.901843 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.902276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:41.902424 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:46:41.902974 [debug] [MainThread]: Command end result
[0m11:46:41.907888 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:46:41.908029 [info ] [MainThread]: Building catalog
[0m11:46:41.908624 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m11:46:41.912367 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m11:46:41.912622 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m11:46:41.912831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:43.793945 [debug] [ThreadPool]: SQL status: SUCCESS 83 in 2.0 seconds
[0m11:46:43.810483 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m11:46:43.971280 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/target/catalog.json
[0m11:46:43.972081 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:46:43.971997 after 3.07 seconds
[0m11:46:43.972323 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:46:43.972494 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m11:46:43.972735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30fe50>]}
[0m11:46:43.973007 [debug] [MainThread]: Flushing usage events
[0m11:46:55.096091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104789a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478b010>]}


============================== 11:46:55.097882 | 35ac56aa-3b18-4e2c-9047-7e637ecaee3e ==============================
[0m11:46:55.097882 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:46:55.098203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:55.196285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35ac56aa-3b18-4e2c-9047-7e637ecaee3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476e750>]}
[0m11:46:55.202077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35ac56aa-3b18-4e2c-9047-7e637ecaee3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f48290>]}
[0m11:55:43.876526 [error] [MainThread]: Encountered an error:

[0m11:55:43.883093 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:55:43.884623 [debug] [MainThread]: Command `dbt docs serve` failed at 11:55:43.884444 after 528.79 seconds
[0m11:55:43.885104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f14fd0>]}
[0m11:55:43.885546 [debug] [MainThread]: Flushing usage events
[0m11:56:46.564885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104133810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104142d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041433d0>]}


============================== 11:56:46.566735 | 8739d017-c4bb-4add-977f-2df74978bf0a ==============================
[0m11:56:46.566735 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:56:46.567026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:56:46.672153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414f8d0>]}
[0m11:56:46.678200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104159310>]}
[0m11:56:46.678470 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:56:46.692911 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:56:46.708765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:46.708925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:46.709143 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m11:56:46.711734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5ae90>]}
[0m11:56:46.715744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104988a10>]}
[0m11:56:46.716048 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:56:46.716236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ead0d0>]}
[0m11:56:46.716798 [info ] [MainThread]: 
[0m11:56:46.717162 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:46.717618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m11:56:46.723821 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m11:56:46.724007 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m11:56:46.724126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:47.622688 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:56:47.625500 [debug] [ThreadPool]: On list_analytics: Close
[0m11:56:47.748733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m11:56:47.757901 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:56:47.758308 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:56:47.758594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:48.450691 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m11:56:48.454999 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:56:48.639961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc6e50>]}
[0m11:56:48.641182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:48.641665 [info ] [MainThread]: 
[0m11:56:48.647980 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m11:56:48.648633 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.customer_orders ....................... [RUN]
[0m11:56:48.649522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m11:56:48.649925 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m11:56:48.651890 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m11:56:48.652781 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 11:56:48.650155 => 11:56:48.652483
[0m11:56:48.653203 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m11:56:48.676831 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.customer_orders"
[0m11:56:48.678626 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.customer_orders"
[0m11:56:48.678962 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
  );
[0m11:56:48.679264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:49.910913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:56:49.939646 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 11:56:48.653436 => 11:56:49.939459
[0m11:56:49.940061 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: Close
[0m11:56:50.080475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104989950>]}
[0m11:56:50.081776 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.customer_orders .................. [[32mSUCCESS 1[0m in 1.43s]
[0m11:56:50.082766 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m11:56:50.085138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:50.085504 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.customer_orders' was properly closed.
[0m11:56:50.085839 [info ] [MainThread]: 
[0m11:56:50.086238 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m11:56:50.087010 [debug] [MainThread]: Command end result
[0m11:56:50.096460 [info ] [MainThread]: 
[0m11:56:50.096992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:50.097326 [info ] [MainThread]: 
[0m11:56:50.097656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:56:50.098195 [debug] [MainThread]: Command `cli run` succeeded at 11:56:50.098104 after 3.54 seconds
[0m11:56:50.098563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100893ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008032d0>]}
[0m11:56:50.098911 [debug] [MainThread]: Flushing usage events
[0m12:03:45.851728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106666510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667ae50>]}


============================== 12:03:45.853751 | 867fca0e-39f2-47f3-aac4-e6cd0d2887e7 ==============================
[0m12:03:45.853751 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:03:45.854075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:03:45.956242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665cc90>]}
[0m12:03:45.962488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f70e50>]}
[0m12:03:45.962817 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:03:45.977271 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:03:45.993594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:45.993775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:45.994024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:03:45.996659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dc850>]}
[0m12:03:46.000539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed8b90>]}
[0m12:03:46.000759 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:03:46.000923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102795510>]}
[0m12:03:46.001508 [info ] [MainThread]: 
[0m12:03:46.001848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:03:46.002349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m12:03:46.008005 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m12:03:46.008155 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m12:03:46.008269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:46.832442 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:03:46.836076 [debug] [ThreadPool]: On list_analytics: Close
[0m12:03:46.973599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m12:03:46.979673 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m12:03:46.979942 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m12:03:46.980137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:47.531667 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m12:03:47.535926 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m12:03:47.649677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e06d10>]}
[0m12:03:47.650655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:03:47.651067 [info ] [MainThread]: 
[0m12:03:47.654102 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:47.654526 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m12:03:47.655113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m12:03:47.655392 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:47.656882 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:03:47.657619 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 12:03:47.655568 => 12:03:47.657466
[0m12:03:47.657883 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:47.679407 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:03:47.681303 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m12:03:47.681660 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
        Orders.USER_ID    as customer_id,
        Orders.ORDER_DATE AS order_placed_at,
            Orders.STATUS AS order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        C.FIRST_NAME    as customer_first_name,
            C.LAST_NAME as customer_last_name
    FROM raw.jaffle_shop.orders as Orders
    left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
from raw.stripe.payment
where STATUS <> 'fail'
group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
    as (select C.ID as customer_id
        , min(ORDER_DATE) as first_order_date
        , max(ORDER_DATE) as most_recent_order_date
        , count(ORDERS.ID) AS number_of_orders
    from raw.jaffle_shop.customers C 
    left join raw.jaffle_shop.orders as Orders
    on orders.USER_ID = C.ID 
    group by 1)

select
    p.*,
    ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
    CASE WHEN c.first_order_date = p.order_placed_at
    THEN 'new'
    ELSE 'return' END as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
    FROM paid_orders p
    left join customer_orders as c USING (customer_id)
    LEFT OUTER JOIN 
    (
            select
            p.order_id,
            sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x on x.order_id = p.order_id
    ORDER BY order_id
  );
[0m12:03:47.681950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:48.224630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:03:48.253312 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 12:03:47.658041 => 12:03:48.253113
[0m12:03:48.253749 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m12:03:49.010101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110827cd0>]}
[0m12:03:49.011536 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 1.35s]
[0m12:03:49.012481 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:49.014556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:49.014902 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m12:03:49.015243 [info ] [MainThread]: 
[0m12:03:49.015652 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m12:03:49.016392 [debug] [MainThread]: Command end result
[0m12:03:49.024525 [info ] [MainThread]: 
[0m12:03:49.024898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:49.025159 [info ] [MainThread]: 
[0m12:03:49.025434 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:03:49.025848 [debug] [MainThread]: Command `cli run` succeeded at 12:03:49.025777 after 3.18 seconds
[0m12:03:49.026120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106687bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10117b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010e7150>]}
[0m12:03:49.026381 [debug] [MainThread]: Flushing usage events
[0m12:04:19.488881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086266d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863af90>]}


============================== 12:04:19.490773 | dd0c439a-2fed-459e-bdfa-10273f3fecda ==============================
[0m12:04:19.490773 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:04:19.491102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:04:19.501948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd0c439a-2fed-459e-bdfa-10273f3fecda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863add0>]}
[0m12:04:19.502845 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-rowxftm7'
[0m12:04:19.503080 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:04:19.784785 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:04:19.787053 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:04:19.941425 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:04:19.944758 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:04:20.111546 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:04:20.116845 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=0.8.0', '<2.0.0', '>=0.7.0', '<0.8.0']
[0m12:04:20.118131 [debug] [MainThread]: Command `dbt deps` failed at 12:04:20.117945 after 0.64 seconds
[0m12:04:20.118622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108674fd0>]}
[0m12:04:20.119097 [debug] [MainThread]: Flushing usage events
[0m12:04:57.350270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108705a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108706a90>]}


============================== 12:04:57.352008 | 8565cd6b-c7c5-4251-86b6-31a31aaf6088 ==============================
[0m12:04:57.352008 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:04:57.352346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:04:57.361025 [error] [MainThread]: Encountered an error:
'version'
[0m12:04:57.363518 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 125, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 158, in wrapper
    project = load_project(
              ^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/runtime.py", line 49, in load_project
    project = Project.from_project_root(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 675, in from_project_root
    return partial.render(renderer)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 288, in render
    return self.create_project(rendered)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 427, in create_project
    packages = package_config_from_data(rendered.packages_dict)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 111, in package_config_from_data
    PackageConfig.validate(packages_data)
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/contracts/project.py", line 102, in validate
    if not package["version"]:
           ~~~~~~~^^^^^^^^^^^
KeyError: 'version'

[0m12:04:57.364196 [debug] [MainThread]: Command `dbt deps` failed at 12:04:57.364108 after 0.02 seconds
[0m12:04:57.364403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bcfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc2e50>]}
[0m12:04:57.364594 [debug] [MainThread]: Flushing usage events
[0m12:05:34.771122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a53990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66e90>]}


============================== 12:05:34.772948 | a571a621-e156-4da8-9ba1-41dc70fb30c4 ==============================
[0m12:05:34.772948 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:05:34.773305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:05:34.784465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a571a621-e156-4da8-9ba1-41dc70fb30c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a67250>]}
[0m12:05:34.785434 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-083cwfvx'
[0m12:05:34.785666 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:05:35.078081 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:05:35.081916 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:05:35.250681 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:05:35.252960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:05:35.416657 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:05:35.421767 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=0.8.0', '<2.0.0', '>=0.7.0', '<0.8.0']
[0m12:05:35.423043 [debug] [MainThread]: Command `dbt deps` failed at 12:05:35.422644 after 0.66 seconds
[0m12:05:35.423666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a49710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa0fd0>]}
[0m12:05:35.424177 [debug] [MainThread]: Flushing usage events
[0m12:06:17.877137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3ef50>]}


============================== 12:06:17.878960 | 32d73340-b75e-441a-9326-761272dd7abb ==============================
[0m12:06:17.878960 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:06:17.879277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:06:17.890315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32d73340-b75e-441a-9326-761272dd7abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429ba90>]}
[0m12:06:17.891288 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-bu0jap77'
[0m12:06:17.891563 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:06:18.168304 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:06:18.172242 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:06:18.337395 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:06:18.342190 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:06:18.519684 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:06:18.531552 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: >=0.7.0, <0.8.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m12:06:18.532647 [debug] [MainThread]: Command `dbt deps` failed at 12:06:18.532492 after 0.66 seconds
[0m12:06:18.533063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d215d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023fae90>]}
[0m12:06:18.533465 [debug] [MainThread]: Flushing usage events
[0m12:07:05.783712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a66850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a70250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7acd0>]}


============================== 12:07:05.785467 | a872e5d7-08ba-434c-a678-3eaa0eda4925 ==============================
[0m12:07:05.785467 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:07:05.785785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:07:05.796654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a872e5d7-08ba-434c-a678-3eaa0eda4925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7a6d0>]}
[0m12:07:05.797770 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-p8_gse_t'
[0m12:07:05.797988 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:07:06.045880 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:07:06.049240 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:07:06.205391 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:07:06.209325 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:07:06.377284 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:07:06.393937 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m12:07:06.749812 [info ] [MainThread]: Installed from version 0.9.0
[0m12:07:06.750243 [info ] [MainThread]: Up to date!
[0m12:07:06.750691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a872e5d7-08ba-434c-a678-3eaa0eda4925', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a89f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aacc50>]}
[0m12:07:06.751074 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:07:07.235728 [info ] [MainThread]: Installed from version 1.1.1
[0m12:07:07.236009 [info ] [MainThread]: Up to date!
[0m12:07:07.236268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a872e5d7-08ba-434c-a678-3eaa0eda4925', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a79310>]}
[0m12:07:07.236998 [debug] [MainThread]: Command `dbt deps` succeeded at 12:07:07.236931 after 1.46 seconds
[0m12:07:07.237210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dcb510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eac310>]}
[0m12:07:07.237385 [debug] [MainThread]: Flushing usage events
[0m12:07:34.033610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722b90>]}


============================== 12:07:34.035455 | 27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46 ==============================
[0m12:07:34.035455 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:07:34.035764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:07:34.046682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722a10>]}
[0m12:07:34.047394 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-4902y0l5'
[0m12:07:34.047620 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:07:34.321928 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:07:34.325466 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:07:34.489871 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:07:34.494171 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:07:34.660746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:07:34.666475 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:07:34.836828 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:07:34.853504 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m12:07:35.193835 [info ] [MainThread]: Installed from version 0.9.0
[0m12:07:35.194183 [info ] [MainThread]: Up to date!
[0m12:07:35.194517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104755390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f150>]}
[0m12:07:35.194806 [info ] [MainThread]: Installing dbt-labs/codegen
[0m12:07:35.535356 [info ] [MainThread]: Installed from version 0.10.0
[0m12:07:35.535710 [info ] [MainThread]: Up to date!
[0m12:07:35.536003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f150>]}
[0m12:07:35.536293 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:07:35.985144 [info ] [MainThread]: Installed from version 1.1.1
[0m12:07:35.985430 [info ] [MainThread]: Up to date!
[0m12:07:35.985666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475f050>]}
[0m12:07:35.986482 [debug] [MainThread]: Command `dbt deps` succeeded at 12:07:35.986406 after 1.96 seconds
[0m12:07:35.986703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c97510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e6f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034893d0>]}
[0m12:07:35.986901 [debug] [MainThread]: Flushing usage events
[0m12:10:02.406890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108652910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108653010>]}


============================== 12:10:02.408697 | 93f47183-5619-4417-9cfd-3afef2cbdb0d ==============================
[0m12:10:02.408697 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:10:02.409029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:02.527439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b5b50>]}
[0m12:10:02.533605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108666190>]}
[0m12:10:02.533984 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:10:02.551568 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:10:02.556613 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:10:02.556870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108697dd0>]}
[0m12:10:02.923272 [debug] [MainThread]: 1699: static parser successfully parsed legacy/fct_customer_orders.sql
[0m12:10:02.928743 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m12:10:02.966738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:10:02.968812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fae010>]}
[0m12:10:02.972430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094aa010>]}
[0m12:10:02.972614 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:10:02.972779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108652fd0>]}
[0m12:10:02.973354 [info ] [MainThread]: 
[0m12:10:02.973527 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:10:02.973739 [debug] [MainThread]: Command end result
[0m12:10:02.977135 [debug] [MainThread]: Command `cli run` succeeded at 12:10:02.977086 after 0.58 seconds
[0m12:10:02.977306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108659bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0f2d0>]}
[0m12:10:02.977448 [debug] [MainThread]: Flushing usage events
[0m12:10:22.442462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ef5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043db2d0>]}


============================== 12:10:22.444420 | 7d7eb559-d4d9-4135-995b-197452ba2cdf ==============================
[0m12:10:22.444420 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:10:22.444743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:22.544765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104407b10>]}
[0m12:10:22.550971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5c9d0>]}
[0m12:10:22.551275 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:10:22.568671 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:10:22.585550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:10:22.585717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:10:22.585954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:10:22.588568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf28d0>]}
[0m12:10:22.592678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdbd90>]}
[0m12:10:22.592890 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:10:22.593058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102165350>]}
[0m12:10:22.593586 [info ] [MainThread]: 
[0m12:10:22.593754 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:10:22.593966 [debug] [MainThread]: Command end result
[0m12:10:22.597230 [debug] [MainThread]: Command `cli test` succeeded at 12:10:22.597184 after 0.16 seconds
[0m12:10:22.597400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b4bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100abb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100abb2d0>]}
[0m12:10:22.597543 [debug] [MainThread]: Flushing usage events
[0m12:16:19.220044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108007510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108007d50>]}


============================== 12:16:19.222392 | 74b03960-0259-4d11-9058-300327a785ad ==============================
[0m12:16:19.222392 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:16:19.222706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:16:19.336927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff9b50>]}
[0m12:16:19.343014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108023dd0>]}
[0m12:16:19.343345 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:16:19.361178 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:16:19.383351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:19.383643 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://analyses/compare_queries.sql
[0m12:16:19.411593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:16:19.413970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f98e90>]}
[0m12:16:19.418425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088595d0>]}
[0m12:16:19.418649 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:16:19.418822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d89250>]}
[0m12:16:19.419550 [info ] [MainThread]: 
[0m12:16:19.419895 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:19.420390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m12:16:19.425889 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m12:16:19.426069 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m12:16:19.426201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:20.182082 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:16:20.185612 [debug] [ThreadPool]: On list_analytics: Close
[0m12:16:20.311177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m12:16:20.319408 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m12:16:20.319767 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m12:16:20.320046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:20.953385 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m12:16:20.957999 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m12:16:21.084795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107699250>]}
[0m12:16:21.086339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:21.086911 [info ] [MainThread]: 
[0m12:16:21.093697 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m12:16:21.094447 [info ] [Thread-1 (]: 1 of 2 START sql view model DBT_AMOLEIRO.customer_orders ....................... [RUN]
[0m12:16:21.095431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m12:16:21.095862 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m12:16:21.097840 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m12:16:21.098570 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 12:16:21.096127 => 12:16:21.098388
[0m12:16:21.098891 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m12:16:21.123178 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.customer_orders"
[0m12:16:21.124968 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.customer_orders"
[0m12:16:21.125363 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
        Orders.USER_ID    as customer_id,
        Orders.ORDER_DATE AS order_placed_at,
            Orders.STATUS AS order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        C.FIRST_NAME    as customer_first_name,
            C.LAST_NAME as customer_last_name
    FROM raw.jaffle_shop.orders as Orders
    left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
from raw.stripe.payment
where STATUS <> 'fail'
group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
    as (select C.ID as customer_id
        , min(ORDER_DATE) as first_order_date
        , max(ORDER_DATE) as most_recent_order_date
        , count(ORDERS.ID) AS number_of_orders
    from raw.jaffle_shop.customers C 
    left join raw.jaffle_shop.orders as Orders
    on orders.USER_ID = C.ID 
    group by 1)

select
    p.*,
    ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
    CASE WHEN c.first_order_date = p.order_placed_at
    THEN 'new'
    ELSE 'return' END as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
    FROM paid_orders p
    left join customer_orders as c USING (customer_id)
    LEFT OUTER JOIN 
    (
            select
            p.order_id,
            sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x on x.order_id = p.order_id
    ORDER BY order_id
  );
[0m12:16:21.125675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:21.799392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:21.813071 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 12:16:21.099094 => 12:16:21.812957
[0m12:16:21.813317 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: Close
[0m12:16:21.923788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967b010>]}
[0m12:16:21.924569 [info ] [Thread-1 (]: 1 of 2 OK created sql view model DBT_AMOLEIRO.customer_orders .................. [[32mSUCCESS 1[0m in 0.83s]
[0m12:16:21.925320 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m12:16:21.925801 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:21.926401 [info ] [Thread-1 (]: 2 of 2 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m12:16:21.927261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.customer_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m12:16:21.927621 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:21.929361 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:16:21.931066 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 12:16:21.927836 => 12:16:21.930869
[0m12:16:21.931419 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:21.934941 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:16:21.937265 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m12:16:21.937662 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
        Orders.USER_ID    as customer_id,
        Orders.ORDER_DATE AS order_placed_at,
            Orders.STATUS AS order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        C.FIRST_NAME    as customer_first_name,
            C.LAST_NAME as customer_last_name
    FROM raw.jaffle_shop.orders as Orders
    left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
from raw.stripe.payment
where STATUS <> 'fail'
group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
    as (select C.ID as customer_id
        , min(ORDER_DATE) as first_order_date
        , max(ORDER_DATE) as most_recent_order_date
        , count(ORDERS.ID) AS number_of_orders
    from raw.jaffle_shop.customers C 
    left join raw.jaffle_shop.orders as Orders
    on orders.USER_ID = C.ID 
    group by 1)

select
    p.*,
    ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
    CASE WHEN c.first_order_date = p.order_placed_at
    THEN 'new'
    ELSE 'return' END as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
    FROM paid_orders p
    left join customer_orders as c USING (customer_id)
    LEFT OUTER JOIN 
    (
            select
            p.order_id,
            sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x on x.order_id = p.order_id
    ORDER BY order_id
  );
[0m12:16:21.938043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:22.825680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:22.832336 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 12:16:21.931631 => 12:16:22.832143
[0m12:16:22.832724 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m12:16:22.943381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d07fd0>]}
[0m12:16:22.944116 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 1.02s]
[0m12:16:22.944837 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:22.946518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:22.946784 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m12:16:22.947067 [info ] [MainThread]: 
[0m12:16:22.947406 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m12:16:22.948122 [debug] [MainThread]: Command end result
[0m12:16:22.955919 [info ] [MainThread]: 
[0m12:16:22.956266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:22.956519 [info ] [MainThread]: 
[0m12:16:22.956788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:16:22.957299 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:22.957227 after 3.75 seconds
[0m12:16:22.957586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466c310>]}
[0m12:16:22.957850 [debug] [MainThread]: Flushing usage events
[0m12:17:01.920307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106143290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106152350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106153a10>]}


============================== 12:17:01.922740 | 37c2af2a-0354-464e-a586-8d46bc1ee3b4 ==============================
[0m12:17:01.922740 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:17:01.923045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:17:02.039394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614fd10>]}
[0m12:17:02.045483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616c4d0>]}
[0m12:17:02.045842 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:17:02.065301 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:17:02.089728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:02.089932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:02.090177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:17:02.093013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dec50>]}
[0m12:17:02.096747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106934dd0>]}
[0m12:17:02.096955 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:17:02.097127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec9250>]}
[0m12:17:02.097815 [info ] [MainThread]: 
[0m12:17:02.098178 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:17:02.098657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m12:17:02.104701 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m12:17:02.104886 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m12:17:02.105008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:02.889339 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m12:17:02.893447 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m12:17:03.012434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106903a10>]}
[0m12:17:03.013659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:17:03.014124 [info ] [MainThread]: 
[0m12:17:03.019493 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m12:17:03.020274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m12:17:03.020650 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m12:17:03.022843 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m12:17:03.023698 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 12:17:03.020884 => 12:17:03.023471
[0m12:17:03.024053 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m12:17:03.024438 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 12:17:03.024266 => 12:17:03.024281
[0m12:17:03.025314 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m12:17:03.025617 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.026223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.customer_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m12:17:03.026559 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.028824 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:17:03.029348 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 12:17:03.026752 => 12:17:03.029203
[0m12:17:03.029611 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.029932 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 12:17:03.029783 => 12:17:03.029790
[0m12:17:03.030586 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.031052 [debug] [Thread-1 (]: Began running node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.031609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.fct_customer_orders, now analysis.refactoring_for_modularity.compare_queries)
[0m12:17:03.031862 [debug] [Thread-1 (]: Began compiling node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.049189 [debug] [Thread-1 (]: Using snowflake connection "analysis.refactoring_for_modularity.compare_queries"
[0m12:17:03.049458 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "analysis.refactoring_for_modularity.compare_queries"} */
describe table analytics.DBT_AMOLEIRO.customer_orders
[0m12:17:03.049658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:03.600398 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.0 seconds
[0m12:17:03.615755 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.refactoring_for_modularity.compare_queries"
[0m12:17:03.616787 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (compile): 12:17:03.032028 => 12:17:03.616573
[0m12:17:03.617133 [debug] [Thread-1 (]: Began executing node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.617515 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (execute): 12:17:03.617350 => 12:17:03.617366
[0m12:17:03.617843 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: Close
[0m12:17:03.734303 [debug] [Thread-1 (]: Finished running node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.736095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:03.736525 [debug] [MainThread]: Connection 'analysis.refactoring_for_modularity.compare_queries' was properly closed.
[0m12:17:03.737781 [debug] [MainThread]: Command end result
[0m12:17:03.750505 [debug] [MainThread]: Command `dbt compile` succeeded at 12:17:03.750370 after 1.84 seconds
[0m12:17:03.750930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061630d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106163190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026cb510>]}
[0m12:17:03.751313 [debug] [MainThread]: Flushing usage events
[0m12:36:18.912304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613b2d0>]}


============================== 12:36:18.914783 | 04288725-dc50-441d-87cc-2f1ad19e1916 ==============================
[0m12:36:18.914783 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:36:18.915096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:36:19.034050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04288725-dc50-441d-87cc-2f1ad19e1916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106141ed0>]}
[0m12:36:19.040112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04288725-dc50-441d-87cc-2f1ad19e1916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106176010>]}
[0m12:36:19.040441 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:36:19.058435 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:36:19.065113 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading refactoring_for_modularity: staging/jaffle_shop/sources.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  | - name: jaffle_shop
    5  |     database: raw
    6  |     tables:
    7  |     - name: customers
    8  |     - name: orders
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
[0m12:36:19.065471 [debug] [MainThread]: Command `cli build` failed at 12:36:19.065415 after 0.16 seconds
[0m12:36:19.065662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281b190>]}
[0m12:36:19.065845 [debug] [MainThread]: Flushing usage events
[0m17:22:13.830330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104063d50>]}


============================== 17:22:13.832364 | 1fcc4e0a-481c-4d26-8f25-0bf0cacc581a ==============================
[0m17:22:13.832364 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:22:13.832680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:22:13.937013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104058d50>]}
[0m17:22:13.943138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031d9110>]}
[0m17:22:13.943413 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:22:13.960573 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:22:13.966496 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:22:13.966749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a0fd0>]}
[0m17:22:14.343283 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:22:14.348908 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:22:14.350402 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:22:14.351985 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:22:14.353412 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:22:14.399755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:22:14.402004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1ddd0>]}
[0m17:22:14.405806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104906b90>]}
[0m17:22:14.406001 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:22:14.406676 [info ] [MainThread]: 
[0m17:22:14.407009 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:14.407463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:22:14.413462 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:22:14.413679 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:22:14.413803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:15.274248 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:22:15.277706 [debug] [ThreadPool]: On list_analytics: Close
[0m17:22:15.403776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:22:15.415738 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:22:15.416245 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:22:15.416582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:15.822363 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m17:22:15.826599 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:22:15.949122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b8090>]}
[0m17:22:15.950228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:15.950689 [info ] [MainThread]: 
[0m17:22:15.956510 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_payment
[0m17:22:15.957057 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_payment ........................... [RUN]
[0m17:22:15.957802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_payment)
[0m17:22:15.958122 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_payment
[0m17:22:15.964834 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_payment"
[0m17:22:15.965675 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (compile): 17:22:15.958334 => 17:22:15.965513
[0m17:22:15.965957 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_payment
[0m17:22:15.985331 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_payment"
[0m17:22:15.986082 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_payment"
[0m17:22:15.986304 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_payment"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_payment
  
   as (
    with source as (
    select * from raw.stripe.payment
)

transform as (
    select
        orderid as order_id,
        created,
        amount
)

select * from transform
  );
[0m17:22:15.986496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:16.331657 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adf436-0000-22b4-0000-58990001002a
[0m17:22:16.332133 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 0 unexpected 'transform'.
syntax error line 15 at position 0 unexpected 'select'.
[0m17:22:16.332674 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (execute): 17:22:15.966123 => 17:22:16.332491
[0m17:22:16.333020 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: Close
[0m17:22:16.447914 [debug] [Thread-1 (]: Database Error in model stg_payment (models/staging/stripe/stg_payment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 0 unexpected 'transform'.
  syntax error line 15 at position 0 unexpected 'select'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_payment.sql
[0m17:22:16.448621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5c490>]}
[0m17:22:16.449369 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_payment .................. [[31mERROR[0m in 0.49s]
[0m17:22:16.449990 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_payment
[0m17:22:16.451864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:16.452187 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_payment' was properly closed.
[0m17:22:16.452506 [info ] [MainThread]: 
[0m17:22:16.452892 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m17:22:16.453532 [debug] [MainThread]: Command end result
[0m17:22:16.463641 [info ] [MainThread]: 
[0m17:22:16.464070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:16.464343 [info ] [MainThread]: 
[0m17:22:16.464606 [error] [MainThread]: [33mDatabase Error in model stg_payment (models/staging/stripe/stg_payment.sql)[0m
[0m17:22:16.464857 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m17:22:16.465093 [error] [MainThread]:   syntax error line 8 at position 0 unexpected 'transform'.
[0m17:22:16.465329 [error] [MainThread]:   syntax error line 15 at position 0 unexpected 'select'.
[0m17:22:16.465561 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_payment.sql
[0m17:22:16.465799 [info ] [MainThread]: 
[0m17:22:16.466068 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:22:16.466487 [debug] [MainThread]: Command `cli build` failed at 17:22:16.466412 after 2.65 seconds
[0m17:22:16.466776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104058050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10072f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104883fd0>]}
[0m17:22:16.467041 [debug] [MainThread]: Flushing usage events
[0m17:22:36.170199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104086850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407fb90>]}


============================== 17:22:36.172320 | f6bb852c-23f3-45e7-9835-ee6195b4290a ==============================
[0m17:22:36.172320 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:22:36.172652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:22:36.275885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104097b50>]}
[0m17:22:36.282004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047edf10>]}
[0m17:22:36.282292 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:22:36.299632 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:22:36.305414 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:22:36.305715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac5350>]}
[0m17:22:36.679570 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:22:36.685324 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:22:36.686876 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:22:36.688387 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:22:36.689941 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:22:36.736534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:22:36.738737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104893350>]}
[0m17:22:36.742633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e9110>]}
[0m17:22:36.742814 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:22:36.743468 [info ] [MainThread]: 
[0m17:22:36.743814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:36.744226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:22:36.749973 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:22:36.750234 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:22:36.750372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:37.408906 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:22:37.412461 [debug] [ThreadPool]: On list_analytics: Close
[0m17:22:37.526411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:22:37.538146 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:22:37.538676 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:22:37.539035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:38.098088 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m17:22:38.101925 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:22:38.226668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101df98d0>]}
[0m17:22:38.227463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:38.227824 [info ] [MainThread]: 
[0m17:22:38.231506 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_customers
[0m17:22:38.232026 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_customers ......................... [RUN]
[0m17:22:38.232731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_customers)
[0m17:22:38.233072 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_customers
[0m17:22:38.239471 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_customers"
[0m17:22:38.240463 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_customers (compile): 17:22:38.233278 => 17:22:38.240269
[0m17:22:38.240756 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_customers
[0m17:22:38.259865 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_customers"
[0m17:22:38.260741 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_customers"
[0m17:22:38.261003 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.customers
),

transform as (
    select
        id as customer_id,
        first_name as customer_first_name,
        last_name as customer_last_name
    from source
),

select * from transform
  );
[0m17:22:38.261213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:38.900396 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adf436-0000-228a-0000-00005899c16d
[0m17:22:38.900789 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 0 unexpected 'select'.
[0m17:22:38.901242 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_customers (execute): 17:22:38.240928 => 17:22:38.901092
[0m17:22:38.901529 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_customers: Close
[0m17:22:39.018404 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/jaffle_shop/stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 0 unexpected 'select'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_customers.sql
[0m17:22:39.018995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a6950>]}
[0m17:22:39.019581 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_customers ................ [[31mERROR[0m in 0.79s]
[0m17:22:39.020097 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_customers
[0m17:22:39.021510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:39.021770 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_customers' was properly closed.
[0m17:22:39.022033 [info ] [MainThread]: 
[0m17:22:39.022319 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m17:22:39.022754 [debug] [MainThread]: Command end result
[0m17:22:39.031329 [info ] [MainThread]: 
[0m17:22:39.031651 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:39.031883 [info ] [MainThread]: 
[0m17:22:39.032100 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/staging/jaffle_shop/stg_customers.sql)[0m
[0m17:22:39.032316 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m17:22:39.032515 [error] [MainThread]:   syntax error line 16 at position 0 unexpected 'select'.
[0m17:22:39.032719 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_customers.sql
[0m17:22:39.032924 [info ] [MainThread]: 
[0m17:22:39.033145 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:22:39.033615 [debug] [MainThread]: Command `cli build` failed at 17:22:39.033520 after 2.87 seconds
[0m17:22:39.033905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10074b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10074b390>]}
[0m17:22:39.034174 [debug] [MainThread]: Flushing usage events
[0m17:23:08.888291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d67610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6be50>]}


============================== 17:23:08.890102 | 74db4d96-53c3-4f4e-8d58-8b34552735ba ==============================
[0m17:23:08.890102 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:23:08.890438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:23:08.994553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d67ad0>]}
[0m17:23:09.000671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104dd2d0>]}
[0m17:23:09.000943 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:23:09.017967 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:23:09.024116 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:23:09.024374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083d410>]}
[0m17:23:09.399845 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:23:09.405459 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:23:09.406980 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:23:09.408587 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:23:09.410126 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:23:09.457301 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:23:09.459536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca9d90>]}
[0m17:23:09.463471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107bbc10>]}
[0m17:23:09.463658 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:23:09.464300 [info ] [MainThread]: 
[0m17:23:09.464634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:09.465097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:23:09.470677 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:23:09.470849 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:23:09.470963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:10.128645 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:23:10.132040 [debug] [ThreadPool]: On list_analytics: Close
[0m17:23:10.248621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:23:10.256484 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:23:10.256869 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:23:10.257143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:10.646849 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m17:23:10.648975 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:23:10.769380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f4750>]}
[0m17:23:10.770118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:10.770472 [info ] [MainThread]: 
[0m17:23:10.773786 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_customers
[0m17:23:10.774209 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_customers ......................... [RUN]
[0m17:23:10.774799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_customers)
[0m17:23:10.775082 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_customers
[0m17:23:10.781098 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_customers"
[0m17:23:10.781777 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_customers (compile): 17:23:10.775260 => 17:23:10.781632
[0m17:23:10.782083 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_customers
[0m17:23:10.800626 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_customers"
[0m17:23:10.801323 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_customers"
[0m17:23:10.801543 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.customers
),

transform as (
    select
        id as customer_id,
        first_name as customer_first_name,
        last_name as customer_last_name
    from source
)

select * from transform
  );
[0m17:23:10.801750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:11.345492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:23:11.368733 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_customers (execute): 17:23:10.782235 => 17:23:11.368560
[0m17:23:11.369080 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_customers: Close
[0m17:23:11.478066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cc70d0>]}
[0m17:23:11.479283 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_customers .................... [[32mSUCCESS 1[0m in 0.70s]
[0m17:23:11.480201 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_customers
[0m17:23:11.482495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:11.482854 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_customers' was properly closed.
[0m17:23:11.483225 [info ] [MainThread]: 
[0m17:23:11.483654 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m17:23:11.484472 [debug] [MainThread]: Command end result
[0m17:23:11.496863 [info ] [MainThread]: 
[0m17:23:11.497472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:11.497807 [info ] [MainThread]: 
[0m17:23:11.498129 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:23:11.498588 [debug] [MainThread]: Command `cli build` succeeded at 17:23:11.498504 after 2.62 seconds
[0m17:23:11.498897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c57a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc7210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc7350>]}
[0m17:23:11.499224 [debug] [MainThread]: Flushing usage events
[0m17:23:28.322580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bfed0>]}


============================== 17:23:28.324419 | 43042d50-75c5-4ba8-a2fb-9ac9bb205c27 ==============================
[0m17:23:28.324419 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:23:28.324741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:23:28.428110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bbb90>]}
[0m17:23:28.434241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106832910>]}
[0m17:23:28.434515 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:23:28.452102 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:23:28.457997 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:23:28.458262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afcfd0>]}
[0m17:23:28.830146 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:23:28.835751 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:23:28.837261 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:23:28.838848 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:23:28.840278 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:23:28.886532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:23:28.888677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f77f10>]}
[0m17:23:28.892606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f86fd0>]}
[0m17:23:28.892792 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:23:28.893465 [info ] [MainThread]: 
[0m17:23:28.893800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:28.894255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:23:28.900044 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:23:28.900203 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:23:28.900321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:29.543253 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:23:29.546718 [debug] [ThreadPool]: On list_analytics: Close
[0m17:23:29.711695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:23:29.720332 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:23:29.720699 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:23:29.720983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:30.314611 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m17:23:30.316607 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:23:30.438823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078da410>]}
[0m17:23:30.440270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:30.440887 [info ] [MainThread]: 
[0m17:23:30.446246 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_orders
[0m17:23:30.446941 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_orders ............................ [RUN]
[0m17:23:30.447867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_orders)
[0m17:23:30.448275 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_orders
[0m17:23:30.457019 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_orders"
[0m17:23:30.457817 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_orders (compile): 17:23:30.448551 => 17:23:30.457617
[0m17:23:30.458155 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_orders
[0m17:23:30.479344 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_orders"
[0m17:23:30.480142 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_orders"
[0m17:23:30.480399 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_orders
  
   as (
    with source as (
    select * from raw.jaffle_shop.orders
),

transform as (
    select
        id as order_id,
        user_id as customer_id,
        order_date as order_placed_at,
        status as order_status
    source
)

select * from transform
  );
[0m17:23:30.480620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:30.832943 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adf437-0000-22b4-0000-58990001003a
[0m17:23:30.833164 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 4 unexpected 'source'.
[0m17:23:30.833430 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_orders (execute): 17:23:30.458363 => 17:23:30.833329
[0m17:23:30.833587 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_orders: Close
[0m17:23:30.950694 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/jaffle_shop/stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 4 unexpected 'source'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_orders.sql
[0m17:23:30.950943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f84a90>]}
[0m17:23:30.951204 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_orders ................... [[31mERROR[0m in 0.50s]
[0m17:23:30.951436 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_orders
[0m17:23:30.952153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:30.952266 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_orders' was properly closed.
[0m17:23:30.952383 [info ] [MainThread]: 
[0m17:23:30.952529 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m17:23:30.952763 [debug] [MainThread]: Command end result
[0m17:23:30.957188 [info ] [MainThread]: 
[0m17:23:30.957382 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:23:30.957518 [info ] [MainThread]: 
[0m17:23:30.957654 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/staging/jaffle_shop/stg_orders.sql)[0m
[0m17:23:30.957792 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m17:23:30.957923 [error] [MainThread]:   syntax error line 14 at position 4 unexpected 'source'.
[0m17:23:30.958049 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_orders.sql
[0m17:23:30.958180 [info ] [MainThread]: 
[0m17:23:30.958323 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:23:30.958549 [debug] [MainThread]: Command `cli build` failed at 17:23:30.958510 after 2.65 seconds
[0m17:23:30.958713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10288b210>]}
[0m17:23:30.958853 [debug] [MainThread]: Flushing usage events
[0m17:23:40.059970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e22850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1bf90>]}


============================== 17:23:40.061804 | b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa ==============================
[0m17:23:40.061804 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:23:40.062129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:23:40.164392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e33fd0>]}
[0m17:23:40.170489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448f010>]}
[0m17:23:40.170766 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:23:40.187940 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:23:40.193753 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:23:40.194012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104758a50>]}
[0m17:23:40.570866 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:23:40.576496 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:23:40.577983 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:23:40.579546 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:23:40.581167 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:23:40.628940 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:23:40.631145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd5f50>]}
[0m17:23:40.635019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d1190>]}
[0m17:23:40.635229 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:23:40.635837 [info ] [MainThread]: 
[0m17:23:40.636165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:40.636582 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:23:40.642025 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:23:40.642180 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:23:40.642316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:41.289519 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:23:41.292245 [debug] [ThreadPool]: On list_analytics: Close
[0m17:23:41.402748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:23:41.412704 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:23:41.413101 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:23:41.413387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:41.807785 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m17:23:41.809976 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:23:41.926473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046df850>]}
[0m17:23:41.927431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:41.927877 [info ] [MainThread]: 
[0m17:23:41.931957 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_orders
[0m17:23:41.932475 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_orders ............................ [RUN]
[0m17:23:41.933209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_orders)
[0m17:23:41.933540 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_orders
[0m17:23:41.940748 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_orders"
[0m17:23:41.941676 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_orders (compile): 17:23:41.933753 => 17:23:41.941469
[0m17:23:41.941968 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_orders
[0m17:23:41.961733 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_orders"
[0m17:23:41.962477 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_orders"
[0m17:23:41.962704 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_orders
  
   as (
    with source as (
    select * from raw.jaffle_shop.orders
),

transform as (
    select
        id as order_id,
        user_id as customer_id,
        order_date as order_placed_at,
        status as order_status
    from source
)

select * from transform
  );
[0m17:23:41.962911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:42.449224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:23:42.478853 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_orders (execute): 17:23:41.942142 => 17:23:42.478668
[0m17:23:42.479283 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_orders: Close
[0m17:23:42.611961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ca8d0>]}
[0m17:23:42.613049 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_orders ....................... [[32mSUCCESS 1[0m in 0.68s]
[0m17:23:42.613960 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_orders
[0m17:23:42.615783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:42.616129 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_orders' was properly closed.
[0m17:23:42.616455 [info ] [MainThread]: 
[0m17:23:42.616854 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m17:23:42.617622 [debug] [MainThread]: Command end result
[0m17:23:42.628084 [info ] [MainThread]: 
[0m17:23:42.628437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:42.628697 [info ] [MainThread]: 
[0m17:23:42.628969 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:23:42.629367 [debug] [MainThread]: Command `cli build` succeeded at 17:23:42.629297 after 2.58 seconds
[0m17:23:42.629642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100577b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1004e7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1004e7350>]}
[0m17:23:42.629909 [debug] [MainThread]: Flushing usage events
[0m17:23:57.901825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086eb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086eb890>]}


============================== 17:23:57.903665 | 7d7e3833-4dcc-4323-8ece-ff97329bae1c ==============================
[0m17:23:57.903665 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:23:57.904015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:23:58.005562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921a410>]}
[0m17:23:58.011919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f09d0>]}
[0m17:23:58.012232 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:23:58.029478 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:23:58.035408 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:23:58.035672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cb110>]}
[0m17:23:58.406455 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:23:58.411993 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:23:58.413448 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:23:58.414925 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:23:58.416504 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:23:58.462438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:23:58.464623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc7f10>]}
[0m17:23:58.468439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a645210>]}
[0m17:23:58.468623 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:23:58.469318 [info ] [MainThread]: 
[0m17:23:58.469656 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:58.470067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:23:58.475870 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:23:58.476033 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:23:58.476147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:59.102542 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:23:59.105716 [debug] [ThreadPool]: On list_analytics: Close
[0m17:23:59.218466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:23:59.223448 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:23:59.223700 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:23:59.223893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:59.570373 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m17:23:59.574588 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:23:59.696118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080086d0>]}
[0m17:23:59.697710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:59.698250 [info ] [MainThread]: 
[0m17:23:59.703698 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_payment
[0m17:23:59.704433 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_payment ........................... [RUN]
[0m17:23:59.705362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_payment)
[0m17:23:59.705771 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_payment
[0m17:23:59.713577 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_payment"
[0m17:23:59.714508 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (compile): 17:23:59.706038 => 17:23:59.714309
[0m17:23:59.714867 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_payment
[0m17:23:59.736271 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_payment"
[0m17:23:59.737015 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_payment"
[0m17:23:59.737238 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_payment"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_payment
  
   as (
    with source as (
    select * from raw.stripe.payment
),

transform as (
    select
        orderid as order_id,
        created,
        amount
    from source
)

select * from transform
  );
[0m17:23:59.737432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:00.188356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:24:00.197877 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (execute): 17:23:59.715071 => 17:24:00.197788
[0m17:24:00.198082 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: Close
[0m17:24:00.314113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a563710>]}
[0m17:24:00.314505 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_payment ...................... [[32mSUCCESS 1[0m in 0.61s]
[0m17:24:00.314799 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_payment
[0m17:24:00.315517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:00.315640 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_payment' was properly closed.
[0m17:24:00.315763 [info ] [MainThread]: 
[0m17:24:00.315909 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m17:24:00.316184 [debug] [MainThread]: Command end result
[0m17:24:00.320538 [info ] [MainThread]: 
[0m17:24:00.320744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:00.320893 [info ] [MainThread]: 
[0m17:24:00.321049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:24:00.321281 [debug] [MainThread]: Command `cli build` succeeded at 17:24:00.321242 after 2.43 seconds
[0m17:24:00.321426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3bb50>]}
[0m17:24:00.321564 [debug] [MainThread]: Flushing usage events
[0m10:11:09.013769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a665ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a677690>]}


============================== 10:11:09.015570 | 9d135a99-fe6f-4ffb-acdb-8e2beb82e780 ==============================
[0m10:11:09.015570 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:11:09.015873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:11:09.121138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af7dc50>]}
[0m10:11:09.127130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af7c610>]}
[0m10:11:09.127411 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:11:09.144633 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:11:09.162671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:09.162849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:09.163149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:11:09.165942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcd6f50>]}
[0m10:11:09.169934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb30d0>]}
[0m10:11:09.170129 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:11:09.170774 [info ] [MainThread]: 
[0m10:11:09.171119 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:09.171546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:11:09.177256 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:11:09.177422 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:11:09.177557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:09.919868 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:11:09.925045 [debug] [ThreadPool]: On list_analytics: Close
[0m10:11:10.045105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:11:10.056255 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:11:10.056736 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:11:10.057076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:10.589401 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:11:10.591393 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:11:10.707404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd2f510>]}
[0m10:11:10.708911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:10.709454 [info ] [MainThread]: 
[0m10:11:10.715718 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_payment
[0m10:11:10.716401 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_payment ........................... [RUN]
[0m10:11:10.717276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_payment)
[0m10:11:10.717684 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_payment
[0m10:11:10.725073 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_payment"
[0m10:11:10.725874 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (compile): 10:11:10.717935 => 10:11:10.725679
[0m10:11:10.726204 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_payment
[0m10:11:10.747487 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_payment"
[0m10:11:10.748238 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_payment"
[0m10:11:10.748487 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_payment"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_payment
  
   as (
    with source as (
    select * from raw.stripe.payment
),

transform as (
    select 
        orderid as order_id,
        status as payment_status
        created,
        amount
    from source
)

select * from transform
  );
[0m10:11:10.748695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:11.105134 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adf827-0000-22c6-0000-58990001102a
[0m10:11:11.105750 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 8 unexpected 'created'.
syntax error line 14 at position 4 unexpected 'from'.
syntax error line 17 at position 0 unexpected 'select'.
[0m10:11:11.106461 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (execute): 10:11:10.726390 => 10:11:11.106226
[0m10:11:11.106864 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: Close
[0m10:11:11.220857 [debug] [Thread-1 (]: Database Error in model stg_payment (models/staging/stripe/stg_payment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected 'created'.
  syntax error line 14 at position 4 unexpected 'from'.
  syntax error line 17 at position 0 unexpected 'select'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_payment.sql
[0m10:11:11.221433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce11e90>]}
[0m10:11:11.222049 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_payment .................. [[31mERROR[0m in 0.50s]
[0m10:11:11.222557 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_payment
[0m10:11:11.224065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:11.224349 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_payment' was properly closed.
[0m10:11:11.224623 [info ] [MainThread]: 
[0m10:11:11.224958 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m10:11:11.225511 [debug] [MainThread]: Command end result
[0m10:11:11.232827 [info ] [MainThread]: 
[0m10:11:11.233256 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:11:11.233547 [info ] [MainThread]: 
[0m10:11:11.233820 [error] [MainThread]: [33mDatabase Error in model stg_payment (models/staging/stripe/stg_payment.sql)[0m
[0m10:11:11.234071 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m10:11:11.234443 [error] [MainThread]:   syntax error line 12 at position 8 unexpected 'created'.
[0m10:11:11.234705 [error] [MainThread]:   syntax error line 14 at position 4 unexpected 'from'.
[0m10:11:11.234914 [error] [MainThread]:   syntax error line 17 at position 0 unexpected 'select'.
[0m10:11:11.235115 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_payment.sql
[0m10:11:11.235326 [info ] [MainThread]: 
[0m10:11:11.235561 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:11:11.235939 [debug] [MainThread]: Command `cli build` failed at 10:11:11.235866 after 2.23 seconds
[0m10:11:11.236203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6838d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a683510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e72d0>]}
[0m10:11:11.236445 [debug] [MainThread]: Flushing usage events
[0m10:11:32.643544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c62850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6bf90>]}


============================== 10:11:32.645364 | db2b8859-eebc-4a8c-8aae-a76e01ca52f4 ==============================
[0m10:11:32.645364 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:11:32.645684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:11:32.748861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d71d0>]}
[0m10:11:32.754867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d71d0>]}
[0m10:11:32.755167 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:11:32.772740 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:11:32.790676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:11:32.790968 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/staging/stripe/stg_payment.sql
[0m10:11:32.800441 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m10:11:32.808144 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:11:32.810453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655ed50>]}
[0m10:11:32.814386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652b510>]}
[0m10:11:32.814579 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:11:32.815267 [info ] [MainThread]: 
[0m10:11:32.815611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:32.816103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:11:32.821523 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:11:32.821686 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:11:32.821828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:33.473796 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:11:33.476817 [debug] [ThreadPool]: On list_analytics: Close
[0m10:11:33.594622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:11:33.604432 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:11:33.604840 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:11:33.605134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:34.154709 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:11:34.159133 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:11:34.270051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9e450>]}
[0m10:11:34.271102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:34.271547 [info ] [MainThread]: 
[0m10:11:34.275616 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_payment
[0m10:11:34.276131 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_payment ........................... [RUN]
[0m10:11:34.276816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_payment)
[0m10:11:34.277151 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_payment
[0m10:11:34.285401 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_payment"
[0m10:11:34.286243 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (compile): 10:11:34.277361 => 10:11:34.286049
[0m10:11:34.286567 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_payment
[0m10:11:34.306154 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_payment"
[0m10:11:34.306849 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_payment"
[0m10:11:34.307074 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_payment"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_payment
  
   as (
    with source as (
    select * from raw.stripe.payment
),

transform as (
    select 
        orderid as order_id,
        status as payment_status,
        created,
        amount
    from source
)

select * from transform
  );
[0m10:11:34.307271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:34.825386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:11:34.854356 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (execute): 10:11:34.286781 => 10:11:34.854163
[0m10:11:34.854764 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: Close
[0m10:11:34.971651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647de90>]}
[0m10:11:34.972819 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_payment ...................... [[32mSUCCESS 1[0m in 0.69s]
[0m10:11:34.973830 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_payment
[0m10:11:34.975805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:34.976192 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_payment' was properly closed.
[0m10:11:34.976539 [info ] [MainThread]: 
[0m10:11:34.976963 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m10:11:34.977730 [debug] [MainThread]: Command end result
[0m10:11:34.986944 [info ] [MainThread]: 
[0m10:11:34.987403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:34.987716 [info ] [MainThread]: 
[0m10:11:34.988043 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:11:34.988475 [debug] [MainThread]: Command `cli build` succeeded at 10:11:34.988406 after 2.35 seconds
[0m10:11:34.988756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023bfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10232f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10232f350>]}
[0m10:11:34.989034 [debug] [MainThread]: Flushing usage events
[0m10:45:15.783832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e96850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9b790>]}


============================== 10:45:15.785657 | f64c33be-9a83-4384-8028-4a989ac8e394 ==============================
[0m10:45:15.785657 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:45:15.785976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:45:15.888303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f64c33be-9a83-4384-8028-4a989ac8e394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104502b90>]}
[0m10:45:15.894355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f64c33be-9a83-4384-8028-4a989ac8e394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb0dd0>]}
[0m10:45:15.894614 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:45:15.911777 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:45:15.930666 [debug] [MainThread]: Partial parsing enabled: 8 files deleted, 12 files added, 0 files changed.
[0m10:45:15.930935 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/staging/stripe/sources.yml
[0m10:45:15.931078 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/stripe/sources.yml
[0m10:45:15.931223 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/staging/jaffle_shop/sources.yml
[0m10:45:15.931344 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/stripe/stg_payment.sql
[0m10:45:15.931453 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/stg_customers.sql
[0m10:45:15.931567 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/sources.yml
[0m10:45:15.931671 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/marts/fct_customer_orders.sql
[0m10:45:15.931777 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/stg_orders.sql
[0m10:45:15.931882 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:15.931986 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/marts/fct_customer_orders.sql
[0m10:45:15.932095 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/legacy/customer_orders.sql
[0m10:45:15.932242 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/process.md
[0m10:45:15.932388 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/stripe/stg_payment.sql
[0m10:45:15.932484 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/stg_orders.sql
[0m10:45:15.932575 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:15.932664 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/stg_customers.sql
[0m10:45:15.932781 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/legacy/customer_orders.sql
[0m10:45:15.932872 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m10:45:15.942389 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/stripe/stg_payment.sql
[0m10:45:15.948322 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/stg_customers.sql
[0m10:45:15.949790 [debug] [MainThread]: 1699: static parser successfully parsed exercise/marts/fct_customer_orders.sql
[0m10:45:15.951262 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/stg_orders.sql
[0m10:45:15.952728 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:15.954476 [debug] [MainThread]: 1699: static parser successfully parsed training/marts/fct_customer_orders.sql
[0m10:45:15.955486 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fct_customer_orders".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fct_customer_orders").
  
  To fix this, change the name of one of these resources:
  - model.refactoring_for_modularity.fct_customer_orders (models/training/marts/fct_customer_orders.sql)
  - model.refactoring_for_modularity.fct_customer_orders (models/exercise/marts/fct_customer_orders.sql)
[0m10:45:15.955803 [debug] [MainThread]: Command `cli run` failed at 10:45:15.955747 after 0.18 seconds
[0m10:45:15.955966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e86090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e846d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104681250>]}
[0m10:45:15.956156 [debug] [MainThread]: Flushing usage events
[0m10:45:48.665285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e72f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e73650>]}


============================== 10:45:48.667245 | 873a6406-e353-4727-80c8-8b69cad9e9bc ==============================
[0m10:45:48.667245 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:45:48.667622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:45:48.768239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '873a6406-e353-4727-80c8-8b69cad9e9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e61550>]}
[0m10:45:48.774558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '873a6406-e353-4727-80c8-8b69cad9e9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed09d0>]}
[0m10:45:48.774884 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:45:48.792480 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:45:48.811740 [debug] [MainThread]: Partial parsing enabled: 8 files deleted, 12 files added, 0 files changed.
[0m10:45:48.812052 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/stg_orders.sql
[0m10:45:48.812231 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/staging/stripe/sources.yml
[0m10:45:48.812379 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/staging/jaffle_shop/sources.yml
[0m10:45:48.812503 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/process.md
[0m10:45:48.812643 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/sources.yml
[0m10:45:48.812763 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/stg_customers.sql
[0m10:45:48.812903 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/marts/fct_customer_orders.sql
[0m10:45:48.813051 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/stripe/sources.yml
[0m10:45:48.813176 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/stripe/stg_payment.sql
[0m10:45:48.813282 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/legacy/customer_orders.sql
[0m10:45:48.813390 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:48.813531 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/marts/fct_customer_orders_training.sql
[0m10:45:48.813722 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m10:45:48.813824 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/legacy/customer_orders.sql
[0m10:45:48.813919 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/stg_orders.sql
[0m10:45:48.814010 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/stg_customers.sql
[0m10:45:48.814097 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/stripe/stg_payment.sql
[0m10:45:48.814182 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:48.823477 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/stg_orders.sql
[0m10:45:48.829878 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/stg_customers.sql
[0m10:45:48.831362 [debug] [MainThread]: 1699: static parser successfully parsed exercise/marts/fct_customer_orders.sql
[0m10:45:48.832739 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/stripe/stg_payment.sql
[0m10:45:48.834101 [debug] [MainThread]: 1699: static parser successfully parsed exercise/legacy/customer_orders.sql
[0m10:45:48.835521 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:48.837489 [debug] [MainThread]: 1699: static parser successfully parsed training/marts/fct_customer_orders_training.sql
[0m10:45:48.863894 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "jaffle_shop_customers".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("jaffle_shop", "customers").
  
  To fix this, change the name of one of these resources:
  - source.refactoring_for_modularity.jaffle_shop.customers (models/exercise/staging/jaffle_shop/sources.yml)
  - source.refactoring_for_modularity.jaffle_shop.customers (models/training/staging/jaffle_shop/sources.yml)
[0m10:45:48.864307 [debug] [MainThread]: Command `cli run` failed at 10:45:48.864243 after 0.21 seconds
[0m10:45:48.864528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e60610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e69f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e64890>]}
[0m10:45:48.864707 [debug] [MainThread]: Flushing usage events
[0m08:40:01.845955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046be850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c7a10>]}


============================== 08:40:01.847745 | 98966722-09d7-4eb3-b374-bcf33a008e26 ==============================
[0m08:40:01.847745 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:40:01.848040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:40:01.956613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98966722-09d7-4eb3-b374-bcf33a008e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bb990>]}
[0m08:40:01.962787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98966722-09d7-4eb3-b374-bcf33a008e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e5590>]}
[0m08:40:01.963100 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:40:01.979769 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:40:01.997622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:40:01.997802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:40:01.998036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:40:02.000697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98966722-09d7-4eb3-b374-bcf33a008e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9a010>]}
[0m08:40:02.004963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98966722-09d7-4eb3-b374-bcf33a008e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9ad90>]}
[0m08:40:02.005199 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:40:02.005886 [info ] [MainThread]: 
[0m08:40:02.006267 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:40:02.006723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:40:02.012778 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:40:02.012951 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:40:02.013081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:02.691062 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:40:02.693840 [debug] [ThreadPool]: On list_analytics: Close
[0m08:40:02.816323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:40:02.822755 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:40:02.823011 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:40:02.823226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:40:03.364845 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m08:40:03.368122 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:40:03.481153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98966722-09d7-4eb3-b374-bcf33a008e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddd190>]}
[0m08:40:03.482107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:40:03.482535 [info ] [MainThread]: 
[0m08:40:03.488219 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m08:40:03.488734 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.customer_orders ....................... [RUN]
[0m08:40:03.489457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m08:40:03.489782 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m08:40:03.495845 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m08:40:03.496512 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 08:40:03.490001 => 08:40:03.496348
[0m08:40:03.496778 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m08:40:03.517053 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.customer_orders"
[0m08:40:03.518789 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.customer_orders"
[0m08:40:03.519107 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.customer_orders
  
   as (
    with
    paid_orders as (
        select
            orders.id as order_id,
            orders.user_id as customer_id,
            orders.order_date as order_placed_at,
            orders.status as order_status,
            p.total_amount_paid,
            p.payment_finalized_date,
            c.first_name as customer_first_name,
            c.last_name as customer_last_name
        from raw.jaffle_shop.orders as orders
        left join
            (
                select
                    orderid as order_id,
                    max(created) as payment_finalized_date,
                    sum(amount) / 100.0 as total_amount_paid
                from raw.stripe.payment
                where status <> 'fail'
                group by 1
            ) p
            on orders.id = p.order_id
        left join raw.jaffle_shop.customers c on orders.user_id = c.id
    ),

    customer_orders as (
        select
            c.id as customer_id,
            min(order_date) as first_order_date,
            max(order_date) as most_recent_order_date,
            count(orders.id) as number_of_orders
        from raw.jaffle_shop.customers c
        left join raw.jaffle_shop.orders as orders on orders.user_id = c.id
        group by 1
    )

select
    p.*,
    row_number() over (order by p.order_id) as transaction_seq,
    row_number() over (
        partition by customer_id order by p.order_id
    ) as customer_sales_seq,
    case
        when c.first_order_date = p.order_placed_at then 'new' else 'return'
    end as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
from paid_orders p
left join customer_orders as c using (customer_id)
left outer join
    (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x
    on x.order_id = p.order_id
order by order_id
  );
[0m08:40:03.519405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:04.013653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:40:04.037419 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 08:40:03.496940 => 08:40:04.037256
[0m08:40:04.037767 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: Close
[0m08:40:04.144967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98966722-09d7-4eb3-b374-bcf33a008e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b3850>]}
[0m08:40:04.146165 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.customer_orders .................. [[32mSUCCESS 1[0m in 0.66s]
[0m08:40:04.147100 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m08:40:04.149358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:40:04.149658 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.customer_orders' was properly closed.
[0m08:40:04.149979 [info ] [MainThread]: 
[0m08:40:04.150369 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m08:40:04.151364 [debug] [MainThread]: Command end result
[0m08:40:04.161135 [info ] [MainThread]: 
[0m08:40:04.161619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:40:04.161942 [info ] [MainThread]: 
[0m08:40:04.162299 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:40:04.162814 [debug] [MainThread]: Command `cli build` succeeded at 08:40:04.162728 after 2.33 seconds
[0m08:40:04.163134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bf350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee8110>]}
[0m08:40:04.163471 [debug] [MainThread]: Flushing usage events
[0m08:40:08.674752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a66850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a70250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a6bf10>]}


============================== 08:40:08.676556 | de1f1deb-09b9-4d18-af2c-65e98bfdb38b ==============================
[0m08:40:08.676556 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:40:08.676882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:40:08.775239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de1f1deb-09b9-4d18-af2c-65e98bfdb38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a67a10>]}
[0m08:40:08.781591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de1f1deb-09b9-4d18-af2c-65e98bfdb38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052de6d0>]}
[0m08:40:08.781895 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:40:08.799643 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:40:08.817168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:40:08.817343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:40:08.817577 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:40:08.820256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1f1deb-09b9-4d18-af2c-65e98bfdb38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d8ed0>]}
[0m08:40:08.824129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de1f1deb-09b9-4d18-af2c-65e98bfdb38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105397dd0>]}
[0m08:40:08.824353 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:40:08.825028 [info ] [MainThread]: 
[0m08:40:08.825407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:40:08.825885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:40:08.831900 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:40:08.832095 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:40:08.832221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:09.243764 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m08:40:09.245949 [debug] [ThreadPool]: On list_analytics: Close
[0m08:40:09.364315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:40:09.372000 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:40:09.372343 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:40:09.372627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:40:09.795792 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m08:40:09.799791 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:40:09.910321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1f1deb-09b9-4d18-af2c-65e98bfdb38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069247d0>]}
[0m08:40:09.911377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:40:09.911813 [info ] [MainThread]: 
[0m08:40:09.915982 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:40:09.916657 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:40:09.917410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:40:09.917750 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:40:09.925489 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:40:09.926368 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:40:09.917963 => 08:40:09.926194
[0m08:40:09.926660 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:40:09.947429 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:40:09.949639 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:40:09.949991 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) over (partition by order_id) as payment_finalized_date,
            sum(amount / 100.0) over (partition by order_id) as total_amount_paid
        from base_payments
    ),


    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            c.first_name as customer_first_name,
            c.last_name as customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers c on orders.customer_id = c.id
    ),

    x as (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ),

    customer_orders as (
        select
            c.id as customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers c
        left join orders on orders.customer_id = c.id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            x.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)
        left outer join x on x.order_id = p.order_id
        order by order_id
    )

select *
from final
  );
[0m08:40:09.950317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:10.467575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:40:10.493480 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:40:09.926831 => 08:40:10.493286
[0m08:40:10.493869 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:40:10.598812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1f1deb-09b9-4d18-af2c-65e98bfdb38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8a990>]}
[0m08:40:10.600063 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.68s]
[0m08:40:10.600963 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:40:10.603255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:40:10.603596 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:40:10.604034 [info ] [MainThread]: 
[0m08:40:10.604732 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m08:40:10.605755 [debug] [MainThread]: Command end result
[0m08:40:10.616313 [info ] [MainThread]: 
[0m08:40:10.616813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:40:10.617139 [info ] [MainThread]: 
[0m08:40:10.617472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:40:10.617963 [debug] [MainThread]: Command `cli build` succeeded at 08:40:10.617879 after 1.95 seconds
[0m08:40:10.618297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a83ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a66b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10098bc90>]}
[0m08:40:10.618653 [debug] [MainThread]: Flushing usage events
[0m08:41:18.381176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bae850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba7d90>]}


============================== 08:41:18.383007 | a926e9ea-5857-4174-8123-4e8e58b6d459 ==============================
[0m08:41:18.383007 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:41:18.383335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:41:18.482996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a926e9ea-5857-4174-8123-4e8e58b6d459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d1a150>]}
[0m08:41:18.488929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a926e9ea-5857-4174-8123-4e8e58b6d459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e9590>]}
[0m08:41:18.489203 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:41:18.506173 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:41:18.524073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:41:18.524248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:41:18.524484 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:41:18.527172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a926e9ea-5857-4174-8123-4e8e58b6d459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054da010>]}
[0m08:41:18.530911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a926e9ea-5857-4174-8123-4e8e58b6d459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ca750>]}
[0m08:41:18.531124 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:41:18.531293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a926e9ea-5857-4174-8123-4e8e58b6d459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102921950>]}
[0m08:41:18.531879 [info ] [MainThread]: 
[0m08:41:18.532216 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:41:18.532614 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m08:41:18.538561 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:41:18.538736 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:41:18.538859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:19.202861 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m08:41:19.207515 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:41:19.318683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a926e9ea-5857-4174-8123-4e8e58b6d459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bae690>]}
[0m08:41:19.319901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:41:19.320399 [info ] [MainThread]: 
[0m08:41:19.325089 [debug] [Thread-1 (]: Began running node analysis.refactoring_for_modularity.compare_queries
[0m08:41:19.325957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now analysis.refactoring_for_modularity.compare_queries)
[0m08:41:19.326386 [debug] [Thread-1 (]: Began compiling node analysis.refactoring_for_modularity.compare_queries
[0m08:41:19.352159 [debug] [Thread-1 (]: Using snowflake connection "analysis.refactoring_for_modularity.compare_queries"
[0m08:41:19.352456 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "analysis.refactoring_for_modularity.compare_queries"} */
describe table analytics.DBT_AMOLEIRO.customer_orders
[0m08:41:19.352680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:19.684848 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m08:41:19.701270 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.refactoring_for_modularity.compare_queries"
[0m08:41:19.702320 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (compile): 08:41:19.326651 => 08:41:19.702109
[0m08:41:19.702697 [debug] [Thread-1 (]: Began executing node analysis.refactoring_for_modularity.compare_queries
[0m08:41:19.703072 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (execute): 08:41:19.702905 => 08:41:19.702923
[0m08:41:19.703398 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: Close
[0m08:41:19.825417 [debug] [Thread-1 (]: Finished running node analysis.refactoring_for_modularity.compare_queries
[0m08:41:19.826321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:19.826568 [debug] [MainThread]: Connection 'analysis.refactoring_for_modularity.compare_queries' was properly closed.
[0m08:41:19.827042 [debug] [MainThread]: Command end result
[0m08:41:19.833932 [info ] [MainThread]: Compiled node 'compare_queries' is:
 

  














with a as (

    
select

  

   
    "CUSTOMER_ID" 
    
      , 
     
   
    "ORDER_ID" 
    
      , 
     
   
    "ORDER_PLACED_AT" 
    
      , 
     
   
    "ORDER_STATUS" 
    
      , 
     
   
    "TOTAL_AMOUNT_PAID" 
    
      , 
     
   
    "PAYMENT_FINALIZED_DATE" 
    
      , 
     
   
    "CUSTOMER_FIRST_NAME" 
    
      , 
     
   
    "CUSTOMER_LAST_NAME" 
    
      , 
     
   
    "TRANSACTION_SEQ" 
    
      , 
     
   
    "CUSTOMER_SALES_SEQ" 
    
      , 
     
   
    "NVSR" 
    
      , 
     
   
    "CUSTOMER_LIFETIME_VALUE" 
    
      , 
     
   
    "FDOS" 
     
  



from analytics.DBT_AMOLEIRO.customer_orders


),

b as (

    
select

  

   
    "CUSTOMER_ID" 
    
      , 
     
   
    "ORDER_ID" 
    
      , 
     
   
    "ORDER_PLACED_AT" 
    
      , 
     
   
    "ORDER_STATUS" 
    
      , 
     
   
    "TOTAL_AMOUNT_PAID" 
    
      , 
     
   
    "PAYMENT_FINALIZED_DATE" 
    
      , 
     
   
    "CUSTOMER_FIRST_NAME" 
    
      , 
     
   
    "CUSTOMER_LAST_NAME" 
    
      , 
     
   
    "TRANSACTION_SEQ" 
    
      , 
     
   
    "CUSTOMER_SALES_SEQ" 
    
      , 
     
   
    "NVSR" 
    
      , 
     
   
    "CUSTOMER_LIFETIME_VALUE" 
    
      , 
     
   
    "FDOS" 
     
  



from analytics.DBT_AMOLEIRO.fct_customer_orders


),

a_intersect_b as (

    select * from a
    

    intersect


    select * from b

),

a_except_b as (

    select * from a
    

    except


    select * from b

),

b_except_a as (

    select * from b
    

    except


    select * from a

),

all_records as (

    select
        *,
        true as in_a,
        true as in_b
    from a_intersect_b

    union all

    select
        *,
        true as in_a,
        false as in_b
    from a_except_b

    union all

    select
        *,
        false as in_a,
        true as in_b
    from b_except_a

),

summary_stats as (

    select

        in_a,
        in_b,
        count(*) as count

    from all_records
    group by 1, 2

),

final as (

    select

        *,
        round(100.0 * count / sum(count) over (), 2) as percent_of_total

    from summary_stats
    order by in_a desc, in_b desc

)

select * from final




[0m08:41:19.834572 [debug] [MainThread]: Command `cli compile` succeeded at 08:41:19.834497 after 1.46 seconds
[0m08:41:19.834879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101303c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053962d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101273350>]}
[0m08:41:19.835178 [debug] [MainThread]: Flushing usage events
[0m08:41:59.442801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104783990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104783f90>]}


============================== 08:41:59.444661 | 3747dd69-e9ad-46af-9465-2af3e3e1816e ==============================
[0m08:41:59.444661 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:41:59.444981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:41:59.543546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3747dd69-e9ad-46af-9465-2af3e3e1816e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c5590>]}
[0m08:41:59.549693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3747dd69-e9ad-46af-9465-2af3e3e1816e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046419d0>]}
[0m08:41:59.549983 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:41:59.566987 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:41:59.584499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:41:59.584670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:41:59.584900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:41:59.587582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3747dd69-e9ad-46af-9465-2af3e3e1816e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505bfd0>]}
[0m08:41:59.591541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3747dd69-e9ad-46af-9465-2af3e3e1816e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f98f50>]}
[0m08:41:59.591734 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:41:59.592299 [info ] [MainThread]: 
[0m08:41:59.592471 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:41:59.592701 [debug] [MainThread]: Command end result
[0m08:41:59.595868 [debug] [MainThread]: Command `cli build` succeeded at 08:41:59.595822 after 0.16 seconds
[0m08:41:59.596034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104789f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100edfc50>]}
[0m08:41:59.596175 [debug] [MainThread]: Flushing usage events
[0m08:47:13.308158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f420d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f42910>]}


============================== 08:47:13.309898 | adbe341c-19c7-45a4-8b95-093985eab2dd ==============================
[0m08:47:13.309898 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:47:13.310215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:47:13.406800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adbe341c-19c7-45a4-8b95-093985eab2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2f150>]}
[0m08:47:13.412667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adbe341c-19c7-45a4-8b95-093985eab2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9cc50>]}
[0m08:47:13.412944 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:47:13.429557 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:47:13.446757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:47:13.446913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:47:13.447158 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:47:13.449806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adbe341c-19c7-45a4-8b95-093985eab2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886e010>]}
[0m08:47:13.453523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adbe341c-19c7-45a4-8b95-093985eab2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087117d0>]}
[0m08:47:13.453706 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:47:13.453870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adbe341c-19c7-45a4-8b95-093985eab2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cad4d0>]}
[0m08:47:13.454453 [info ] [MainThread]: 
[0m08:47:13.454787 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:47:13.455184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:47:13.460622 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:47:13.460755 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:47:13.460874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:14.128412 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:47:14.131426 [debug] [ThreadPool]: On list_analytics: Close
[0m08:47:14.247931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:47:14.256794 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:47:14.257224 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:47:14.257516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:14.846518 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m08:47:14.851417 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:47:14.963124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adbe341c-19c7-45a4-8b95-093985eab2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1f690>]}
[0m08:47:14.963989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:47:14.964353 [info ] [MainThread]: 
[0m08:47:14.968070 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:47:14.968512 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:47:14.969118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:47:14.969380 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:47:14.975774 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:47:14.976355 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:47:14.969554 => 08:47:14.976217
[0m08:47:14.976609 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:47:14.994737 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:47:14.996739 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:47:14.997041 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) over (partition by order_id) as payment_finalized_date,
            sum(amount / 100.0) over (partition by order_id) as total_amount_paid
        from base_payments
    ),


    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            c.first_name as customer_first_name,
            c.last_name as customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers c on orders.customer_id = c.id
    ),

    x as (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ),

    customer_orders as (
        select
            c.id as customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers c
        left join orders on orders.customer_id = c.id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            x.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)
        left outer join x on x.order_id = p.order_id
        order by order_id
    )

select *
from final
  );
[0m08:47:14.997329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:15.560827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:47:15.589736 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:47:14.976755 => 08:47:15.589567
[0m08:47:15.590111 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:47:15.699401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adbe341c-19c7-45a4-8b95-093985eab2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109773510>]}
[0m08:47:15.700506 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.73s]
[0m08:47:15.701317 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:47:15.703364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:15.703719 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:47:15.704077 [info ] [MainThread]: 
[0m08:47:15.704499 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m08:47:15.705261 [debug] [MainThread]: Command end result
[0m08:47:15.714519 [info ] [MainThread]: 
[0m08:47:15.714938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:47:15.715243 [info ] [MainThread]: 
[0m08:47:15.715586 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:47:15.716142 [debug] [MainThread]: Command `dbt run` succeeded at 08:47:15.716052 after 2.42 seconds
[0m08:47:15.716468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044af510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104687790>]}
[0m08:47:15.716760 [debug] [MainThread]: Flushing usage events
[0m08:48:16.650206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a46c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5f5d0>]}


============================== 08:48:16.651981 | 0ffa0612-111e-4b05-bf04-ade6634dc23c ==============================
[0m08:48:16.651981 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:48:16.652320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:48:16.748352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ffa0612-111e-4b05-bf04-ade6634dc23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa34d0>]}
[0m08:48:16.754256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ffa0612-111e-4b05-bf04-ade6634dc23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a67610>]}
[0m08:48:16.754531 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:48:16.771028 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:48:16.788361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:48:16.788516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:48:16.788750 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:48:16.791384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ffa0612-111e-4b05-bf04-ade6634dc23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107378d90>]}
[0m08:48:16.795137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ffa0612-111e-4b05-bf04-ade6634dc23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107248e10>]}
[0m08:48:16.795314 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:48:16.795487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ffa0612-111e-4b05-bf04-ade6634dc23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cd390>]}
[0m08:48:16.796052 [info ] [MainThread]: 
[0m08:48:16.796398 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:48:16.796802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:48:16.802341 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:48:16.802492 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:48:16.802608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:17.509676 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:48:17.514916 [debug] [ThreadPool]: On list_analytics: Close
[0m08:48:17.632125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:48:17.639856 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:48:17.640218 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:48:17.640487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:18.007763 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m08:48:18.010995 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:48:18.123264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ffa0612-111e-4b05-bf04-ade6634dc23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808e190>]}
[0m08:48:18.124500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:48:18.125073 [info ] [MainThread]: 
[0m08:48:18.129808 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:48:18.130658 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:48:18.131607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:48:18.131961 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:48:18.141783 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:48:18.142689 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:48:18.132192 => 08:48:18.142480
[0m08:48:18.143046 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:48:18.165070 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:48:18.167288 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:48:18.167637 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) over (partition by order_id) as payment_finalized_date,
            sum(amount / 100.0) over (partition by order_id) as total_amount_paid
        from base_payments
    ),


    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            c.first_name as customer_first_name,
            c.last_name as customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers c on orders.customer_id = c.id
    ),

    x as (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ),

    customer_orders as (
        select
            c.id as customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers c
        left join orders on orders.customer_id = c.id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            x.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)
        left outer join x on x.order_id = p.order_id
        order by order_id
    )

select *
from final
  );
[0m08:48:18.167993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:18.725129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:48:18.754639 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:48:18.143259 => 08:48:18.754462
[0m08:48:18.755029 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:48:18.860913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ffa0612-111e-4b05-bf04-ade6634dc23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4e810>]}
[0m08:48:18.862279 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.73s]
[0m08:48:18.863304 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:48:18.865816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:18.866196 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:48:18.866546 [info ] [MainThread]: 
[0m08:48:18.866961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m08:48:18.867958 [debug] [MainThread]: Command end result
[0m08:48:18.878555 [info ] [MainThread]: 
[0m08:48:18.878992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:48:18.879310 [info ] [MainThread]: 
[0m08:48:18.879648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:48:18.880194 [debug] [MainThread]: Command `dbt run` succeeded at 08:48:18.880102 after 2.24 seconds
[0m08:48:18.880563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031a3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fcb510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030ac510>]}
[0m08:48:18.880906 [debug] [MainThread]: Flushing usage events
[0m08:50:32.460071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f72850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6bcd0>]}


============================== 08:50:32.461925 | fae3b966-6cea-4b06-8ad8-59d6a03a4050 ==============================
[0m08:50:32.461925 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:50:32.462273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:50:32.562587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae3b966-6cea-4b06-8ad8-59d6a03a4050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f67590>]}
[0m08:50:32.568500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fae3b966-6cea-4b06-8ad8-59d6a03a4050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105978150>]}
[0m08:50:32.568774 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:50:32.586517 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:50:32.604395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:32.604575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:32.604823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:50:32.607530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fae3b966-6cea-4b06-8ad8-59d6a03a4050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6b150>]}
[0m08:50:32.611412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fae3b966-6cea-4b06-8ad8-59d6a03a4050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598c3d0>]}
[0m08:50:32.611628 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:50:32.611794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae3b966-6cea-4b06-8ad8-59d6a03a4050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1017e5a10>]}
[0m08:50:32.612384 [info ] [MainThread]: 
[0m08:50:32.612754 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:50:32.613163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m08:50:32.618626 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:50:32.618764 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:50:32.618884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:33.231055 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m08:50:33.235281 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:50:33.366047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae3b966-6cea-4b06-8ad8-59d6a03a4050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8dbd0>]}
[0m08:50:33.367544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:33.368113 [info ] [MainThread]: 
[0m08:50:33.373106 [debug] [Thread-1 (]: Began running node analysis.refactoring_for_modularity.compare_queries
[0m08:50:33.374025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now analysis.refactoring_for_modularity.compare_queries)
[0m08:50:33.374452 [debug] [Thread-1 (]: Began compiling node analysis.refactoring_for_modularity.compare_queries
[0m08:50:33.401283 [debug] [Thread-1 (]: Using snowflake connection "analysis.refactoring_for_modularity.compare_queries"
[0m08:50:33.401581 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "analysis.refactoring_for_modularity.compare_queries"} */
describe table analytics.DBT_AMOLEIRO.customer_orders
[0m08:50:33.401805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:33.888629 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m08:50:33.897392 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.refactoring_for_modularity.compare_queries"
[0m08:50:33.898091 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (compile): 08:50:33.374716 => 08:50:33.897928
[0m08:50:33.898395 [debug] [Thread-1 (]: Began executing node analysis.refactoring_for_modularity.compare_queries
[0m08:50:33.898678 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (execute): 08:50:33.898551 => 08:50:33.898565
[0m08:50:33.898919 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: Close
[0m08:50:34.004042 [debug] [Thread-1 (]: Finished running node analysis.refactoring_for_modularity.compare_queries
[0m08:50:34.004942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:34.005239 [debug] [MainThread]: Connection 'analysis.refactoring_for_modularity.compare_queries' was properly closed.
[0m08:50:34.005730 [debug] [MainThread]: Command end result
[0m08:50:34.012521 [info ] [MainThread]: Compiled node 'compare_queries' is:
 

  














with a as (

    
select

  

   
    "CUSTOMER_ID" 
    
      , 
     
   
    "ORDER_ID" 
    
      , 
     
   
    "ORDER_PLACED_AT" 
    
      , 
     
   
    "ORDER_STATUS" 
    
      , 
     
   
    "TOTAL_AMOUNT_PAID" 
    
      , 
     
   
    "PAYMENT_FINALIZED_DATE" 
    
      , 
     
   
    "CUSTOMER_FIRST_NAME" 
    
      , 
     
   
    "CUSTOMER_LAST_NAME" 
    
      , 
     
   
    "TRANSACTION_SEQ" 
    
      , 
     
   
    "CUSTOMER_SALES_SEQ" 
    
      , 
     
   
    "NVSR" 
    
      , 
     
   
    "CUSTOMER_LIFETIME_VALUE" 
    
      , 
     
   
    "FDOS" 
     
  



from analytics.DBT_AMOLEIRO.customer_orders


),

b as (

    
select

  

   
    "CUSTOMER_ID" 
    
      , 
     
   
    "ORDER_ID" 
    
      , 
     
   
    "ORDER_PLACED_AT" 
    
      , 
     
   
    "ORDER_STATUS" 
    
      , 
     
   
    "TOTAL_AMOUNT_PAID" 
    
      , 
     
   
    "PAYMENT_FINALIZED_DATE" 
    
      , 
     
   
    "CUSTOMER_FIRST_NAME" 
    
      , 
     
   
    "CUSTOMER_LAST_NAME" 
    
      , 
     
   
    "TRANSACTION_SEQ" 
    
      , 
     
   
    "CUSTOMER_SALES_SEQ" 
    
      , 
     
   
    "NVSR" 
    
      , 
     
   
    "CUSTOMER_LIFETIME_VALUE" 
    
      , 
     
   
    "FDOS" 
     
  



from analytics.DBT_AMOLEIRO.fct_customer_orders


),

a_intersect_b as (

    select * from a
    

    intersect


    select * from b

),

a_except_b as (

    select * from a
    

    except


    select * from b

),

b_except_a as (

    select * from b
    

    except


    select * from a

),

all_records as (

    select
        *,
        true as in_a,
        true as in_b
    from a_intersect_b

    union all

    select
        *,
        true as in_a,
        false as in_b
    from a_except_b

    union all

    select
        *,
        false as in_a,
        true as in_b
    from b_except_a

),

summary_stats as (

    select

        in_a,
        in_b,
        count(*) as count

    from all_records
    group by 1, 2

),

final as (

    select

        *,
        round(100.0 * count / sum(count) over (), 2) as percent_of_total

    from summary_stats
    order by in_a desc, in_b desc

)

select * from final




[0m08:50:34.013159 [debug] [MainThread]: Command `cli compile` succeeded at 08:50:34.013090 after 1.56 seconds
[0m08:50:34.013415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f837d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100557d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f28a10>]}
[0m08:50:34.013692 [debug] [MainThread]: Flushing usage events
[0m08:58:41.578919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104063490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104063b50>]}


============================== 08:58:41.580760 | 7a68bc6e-8fdb-4105-bfed-20479bd0c42f ==============================
[0m08:58:41.580760 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:58:41.581066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:58:41.680669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a68bc6e-8fdb-4105-bfed-20479bd0c42f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407bad0>]}
[0m08:58:41.686676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a68bc6e-8fdb-4105-bfed-20479bd0c42f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104438550>]}
[0m08:58:41.686996 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:58:41.704773 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:58:41.721963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:58:41.722238 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m08:58:41.731450 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m08:58:41.739076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:58:41.741204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a68bc6e-8fdb-4105-bfed-20479bd0c42f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104879f90>]}
[0m08:58:41.745028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a68bc6e-8fdb-4105-bfed-20479bd0c42f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049236d0>]}
[0m08:58:41.745222 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:58:41.745885 [info ] [MainThread]: 
[0m08:58:41.746251 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:58:41.746781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:58:41.752518 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:58:41.752670 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:58:41.752782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:42.396556 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:58:42.399413 [debug] [ThreadPool]: On list_analytics: Close
[0m08:58:42.511128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:58:42.517267 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:58:42.517532 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:58:42.517744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:42.871663 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m08:58:42.877442 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:58:42.985471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a68bc6e-8fdb-4105-bfed-20479bd0c42f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a0950>]}
[0m08:58:42.986659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:58:42.987206 [info ] [MainThread]: 
[0m08:58:42.991357 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:58:42.992021 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:58:42.992888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:58:42.993302 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:58:43.001379 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:58:43.002157 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:58:42.993565 => 08:58:43.001979
[0m08:58:43.002440 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:58:43.023604 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:58:43.025599 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:58:43.025924 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),


    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            c.first_name as customer_first_name,
            c.last_name as customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers c on orders.customer_id = c.id
    ),

    x as (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ),

    customer_orders as (
        select
            c.id as customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers c
        left join orders on orders.customer_id = c.id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            x.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)
        left outer join x on x.order_id = p.order_id
        order by order_id
    )

select *
from final
  );
[0m08:58:43.026240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:43.720837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:58:43.747336 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:58:43.002614 => 08:58:43.747145
[0m08:58:43.747775 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:58:43.857458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a68bc6e-8fdb-4105-bfed-20479bd0c42f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d24d0>]}
[0m08:58:43.858423 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.86s]
[0m08:58:43.859231 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:58:43.861179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:58:43.861576 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:58:43.861961 [info ] [MainThread]: 
[0m08:58:43.862386 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m08:58:43.863176 [debug] [MainThread]: Command end result
[0m08:58:43.871817 [info ] [MainThread]: 
[0m08:58:43.872180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:58:43.872440 [info ] [MainThread]: 
[0m08:58:43.872727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:58:43.873190 [debug] [MainThread]: Command `cli build` succeeded at 08:58:43.873116 after 2.30 seconds
[0m08:58:43.873484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100909690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007bfc90>]}
[0m08:58:43.873776 [debug] [MainThread]: Flushing usage events
[0m08:59:03.315766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104152850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415bd90>]}


============================== 08:59:03.317632 | f90e1f65-7ffb-4427-a1b3-6b188e7e7fd4 ==============================
[0m08:59:03.317632 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:59:03.317953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:59:03.417356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f90e1f65-7ffb-4427-a1b3-6b188e7e7fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414f910>]}
[0m08:59:03.423673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f90e1f65-7ffb-4427-a1b3-6b188e7e7fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104151d50>]}
[0m08:59:03.423981 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:59:03.441192 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:59:03.458637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:59:03.458817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:59:03.459057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:59:03.461901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f90e1f65-7ffb-4427-a1b3-6b188e7e7fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a30050>]}
[0m08:59:03.465814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f90e1f65-7ffb-4427-a1b3-6b188e7e7fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104943d50>]}
[0m08:59:03.466024 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:59:03.466636 [info ] [MainThread]: 
[0m08:59:03.466982 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:59:03.467393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:59:03.473055 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:59:03.473208 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:59:03.473322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:04.077660 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:59:04.079382 [debug] [ThreadPool]: On list_analytics: Close
[0m08:59:04.187855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:59:04.195239 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:59:04.195582 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:59:04.195826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:04.576635 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m08:59:04.578778 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:59:04.696867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90e1f65-7ffb-4427-a1b3-6b188e7e7fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a7c810>]}
[0m08:59:04.697524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:04.697832 [info ] [MainThread]: 
[0m08:59:04.700530 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:04.700929 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:59:04.701492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:59:04.701751 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:04.707882 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:59:04.708454 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:59:04.701920 => 08:59:04.708316
[0m08:59:04.708704 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:04.726368 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:59:04.728473 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:59:04.728848 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),


    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            c.first_name as customer_first_name,
            c.last_name as customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers c on orders.customer_id = c.id
    ),

    x as (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ),

    customer_orders as (
        select
            c.id as customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers c
        left join orders on orders.customer_id = c.id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            x.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)
        left outer join x on x.order_id = p.order_id
        order by order_id
    )

select *
from final
  );
[0m08:59:04.729143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:05.439078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:59:05.457365 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:59:04.708851 => 08:59:05.457236
[0m08:59:05.457651 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:59:05.557597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90e1f65-7ffb-4427-a1b3-6b188e7e7fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a1bd0>]}
[0m08:59:05.558385 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.86s]
[0m08:59:05.559115 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:05.560807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:05.561128 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:59:05.561416 [info ] [MainThread]: 
[0m08:59:05.561762 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m08:59:05.562413 [debug] [MainThread]: Command end result
[0m08:59:05.570686 [info ] [MainThread]: 
[0m08:59:05.571029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:05.571293 [info ] [MainThread]: 
[0m08:59:05.571568 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:59:05.572002 [debug] [MainThread]: Command `cli build` succeeded at 08:59:05.571932 after 2.27 seconds
[0m08:59:05.572283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008afb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10081f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10081f310>]}
[0m08:59:05.572568 [debug] [MainThread]: Flushing usage events
[0m08:59:51.255790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043da510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e2f10>]}


============================== 08:59:51.257567 | c8619cd1-b24c-4a88-a553-207af4188aea ==============================
[0m08:59:51.257567 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:59:51.257902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:59:51.354009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8619cd1-b24c-4a88-a553-207af4188aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c9650>]}
[0m08:59:51.359905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8619cd1-b24c-4a88-a553-207af4188aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ef290>]}
[0m08:59:51.360179 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:59:51.376801 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:59:51.394624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:59:51.394838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:59:51.395082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:59:51.397762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8619cd1-b24c-4a88-a553-207af4188aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0ce90>]}
[0m08:59:51.401487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8619cd1-b24c-4a88-a553-207af4188aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10332de50>]}
[0m08:59:51.401673 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:59:51.401844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8619cd1-b24c-4a88-a553-207af4188aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102151390>]}
[0m08:59:51.402448 [info ] [MainThread]: 
[0m08:59:51.402801 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:59:51.403303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:59:51.408925 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:59:51.409087 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:59:51.409250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:52.029987 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:59:52.033426 [debug] [ThreadPool]: On list_analytics: Close
[0m08:59:52.150255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:59:52.161315 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:59:52.161798 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:59:52.162139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:52.527459 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m08:59:52.531796 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:59:52.651301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8619cd1-b24c-4a88-a553-207af4188aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb2810>]}
[0m08:59:52.652352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:52.652809 [info ] [MainThread]: 
[0m08:59:52.657451 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:52.658059 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:59:52.658795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:59:52.659135 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:52.667089 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:59:52.667863 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:59:52.659350 => 08:59:52.667685
[0m08:59:52.668166 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:52.688029 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:59:52.690065 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:59:52.690407 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),


    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            c.first_name as customer_first_name,
            c.last_name as customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers c on orders.customer_id = c.id
    ),

    x as (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ),

    customer_orders as (
        select
            c.id as customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers c
        left join orders on orders.customer_id = c.id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            x.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)
        left outer join x on x.order_id = p.order_id
        order by order_id
    )

select *
from final
  );
[0m08:59:52.690717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:53.163880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:59:53.190393 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:59:52.668347 => 08:59:53.190215
[0m08:59:53.190781 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:59:53.300912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8619cd1-b24c-4a88-a553-207af4188aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d01790>]}
[0m08:59:53.301698 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.64s]
[0m08:59:53.302420 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:53.304187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:53.304596 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:59:53.304939 [info ] [MainThread]: 
[0m08:59:53.305382 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m08:59:53.306031 [debug] [MainThread]: Command end result
[0m08:59:53.314560 [info ] [MainThread]: 
[0m08:59:53.314918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:53.315187 [info ] [MainThread]: 
[0m08:59:53.315460 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:59:53.316033 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:53.315920 after 2.07 seconds
[0m08:59:53.316400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ee7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043efa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf3e50>]}
[0m08:59:53.316706 [debug] [MainThread]: Flushing usage events
[0m09:05:01.833552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107262850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107276f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072775d0>]}


============================== 09:05:01.835440 | 77e557ee-bce8-4fd9-99c2-f2b5a559b39a ==============================
[0m09:05:01.835440 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:05:01.835765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:05:01.937092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77e557ee-bce8-4fd9-99c2-f2b5a559b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107291b50>]}
[0m09:05:01.943075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77e557ee-bce8-4fd9-99c2-f2b5a559b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107262910>]}
[0m09:05:01.943352 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:05:01.960373 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:05:01.977991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:05:01.978187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:05:01.978440 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:05:01.981144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77e557ee-bce8-4fd9-99c2-f2b5a559b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b7910>]}
[0m09:05:01.984994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77e557ee-bce8-4fd9-99c2-f2b5a559b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103a9fd0>]}
[0m09:05:01.985230 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:05:01.985835 [info ] [MainThread]: 
[0m09:05:01.986190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:05:01.986597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:05:01.992549 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:05:01.992718 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:05:01.992839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:02.829309 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:05:02.832721 [debug] [ThreadPool]: On list_analytics: Close
[0m09:05:02.958973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:05:02.966614 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:05:02.967016 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:05:02.967293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:05:03.341789 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:05:03.344381 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:05:03.465159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77e557ee-bce8-4fd9-99c2-f2b5a559b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110880590>]}
[0m09:05:03.466062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:05:03.466438 [info ] [MainThread]: 
[0m09:05:03.470125 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:05:03.470624 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:05:03.471307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:05:03.471630 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:05:03.479090 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:05:03.479877 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:05:03.471838 => 09:05:03.479680
[0m09:05:03.480177 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:05:03.499224 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:05:03.501448 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:05:03.501807 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),


    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    x as (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ),

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            x.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)
        left outer join x on x.order_id = p.order_id
        order by order_id
    )

select *
from final
  );
[0m09:05:03.502135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:05:04.179652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:05:04.214759 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:05:03.480342 => 09:05:04.214600
[0m09:05:04.215139 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:05:04.319925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77e557ee-bce8-4fd9-99c2-f2b5a559b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111475d0>]}
[0m09:05:04.320774 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.85s]
[0m09:05:04.321578 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:05:04.323379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:04.323636 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:05:04.323863 [info ] [MainThread]: 
[0m09:05:04.324137 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m09:05:04.324709 [debug] [MainThread]: Command end result
[0m09:05:04.333841 [info ] [MainThread]: 
[0m09:05:04.334160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:05:04.334396 [info ] [MainThread]: 
[0m09:05:04.334631 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:05:04.334997 [debug] [MainThread]: Command `cli build` succeeded at 09:05:04.334936 after 2.51 seconds
[0m09:05:04.335238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032dfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10324f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10324f310>]}
[0m09:05:04.335488 [debug] [MainThread]: Flushing usage events
[0m09:05:10.075266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108572c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857be10>]}


============================== 09:05:10.077022 | b119d1ff-7e08-41e8-af8c-4f8394e35a19 ==============================
[0m09:05:10.077022 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:05:10.077349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:05:10.174199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b119d1ff-7e08-41e8-af8c-4f8394e35a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857b890>]}
[0m09:05:10.180091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b119d1ff-7e08-41e8-af8c-4f8394e35a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d620d0>]}
[0m09:05:10.180367 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:05:10.197264 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:05:10.214593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:05:10.214756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:05:10.214978 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:05:10.217571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b119d1ff-7e08-41e8-af8c-4f8394e35a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e57d50>]}
[0m09:05:10.221403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b119d1ff-7e08-41e8-af8c-4f8394e35a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d86c50>]}
[0m09:05:10.221587 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:05:10.221808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b119d1ff-7e08-41e8-af8c-4f8394e35a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f9310>]}
[0m09:05:10.222459 [info ] [MainThread]: 
[0m09:05:10.222832 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:05:10.223232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:05:10.228792 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:05:10.228966 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:05:10.229096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:10.613379 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m09:05:10.616161 [debug] [ThreadPool]: On list_analytics: Close
[0m09:05:10.728982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:05:10.740254 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:05:10.740711 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:05:10.741047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:05:11.106753 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:05:11.110823 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:05:11.238201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b119d1ff-7e08-41e8-af8c-4f8394e35a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d79c90>]}
[0m09:05:11.239483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:05:11.239989 [info ] [MainThread]: 
[0m09:05:11.244599 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:05:11.245239 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:05:11.246094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:05:11.246495 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:05:11.255173 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:05:11.255981 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:05:11.246876 => 09:05:11.255809
[0m09:05:11.256290 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:05:11.276784 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:05:11.279015 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:05:11.279355 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),


    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    x as (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ),

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            x.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)
        left outer join x on x.order_id = p.order_id
        order by order_id
    )

select *
from final
  );
[0m09:05:11.279663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:05:11.841313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:05:11.868082 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:05:11.256469 => 09:05:11.867890
[0m09:05:11.868484 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:05:11.971770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b119d1ff-7e08-41e8-af8c-4f8394e35a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e61190>]}
[0m09:05:11.973075 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.73s]
[0m09:05:11.974091 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:05:11.976755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:11.977182 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:05:11.977565 [info ] [MainThread]: 
[0m09:05:11.978047 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m09:05:11.978954 [debug] [MainThread]: Command end result
[0m09:05:11.989969 [info ] [MainThread]: 
[0m09:05:11.990467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:05:11.990803 [info ] [MainThread]: 
[0m09:05:11.991145 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:05:11.991823 [debug] [MainThread]: Command `dbt run` succeeded at 09:05:11.991696 after 1.92 seconds
[0m09:05:11.992232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af7510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccf950>]}
[0m09:05:11.992589 [debug] [MainThread]: Flushing usage events
[0m09:08:52.395539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f7ad0>]}


============================== 09:08:52.397343 | 247a9e27-fdfc-49de-8c3e-d225188ffade ==============================
[0m09:08:52.397343 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:08:52.397643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:08:52.498532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '247a9e27-fdfc-49de-8c3e-d225188ffade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106503bd0>]}
[0m09:08:52.504560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '247a9e27-fdfc-49de-8c3e-d225188ffade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106503bd0>]}
[0m09:08:52.504828 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:08:52.523551 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:08:52.542366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:08:52.542609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:08:52.542877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:08:52.545697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '247a9e27-fdfc-49de-8c3e-d225188ffade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106551f10>]}
[0m09:08:52.550215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '247a9e27-fdfc-49de-8c3e-d225188ffade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ceee50>]}
[0m09:08:52.550469 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:08:52.551204 [info ] [MainThread]: 
[0m09:08:52.551603 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:08:52.552144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:08:52.558276 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:08:52.558424 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:08:52.558538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:52.966934 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m09:08:52.968439 [debug] [ThreadPool]: On list_analytics: Close
[0m09:08:53.083658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:08:53.092686 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:08:53.093095 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:08:53.093418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:53.694527 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m09:08:53.698321 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:08:53.816751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247a9e27-fdfc-49de-8c3e-d225188ffade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b56610>]}
[0m09:08:53.817624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:53.817988 [info ] [MainThread]: 
[0m09:08:53.823686 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:08:53.824146 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:08:53.824750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:08:53.825003 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:08:53.831164 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:08:53.831783 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:08:53.825157 => 09:08:53.831638
[0m09:08:53.832031 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:08:53.849583 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:08:53.851640 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:08:53.851978 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            row_number() over (order by order_id) as transaction_seq,
            min(order_placed_at) over (partition by order_id) as first_order_date,
            max(order_placed_at) over (partition by order_id) as most_recent_order_date,
            count(order_id) over (partition by order_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.payment_finalized_date,
            payments.total_amount_paid,
            sum(payments.total_amount_paid) over (
                partition by orders.customer_id 
                order by payments.total_amount_paid 
                rows between unbounded preceding and current row
                ) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.order_id,
            paid_orders.customer_id,
            paid_orders.order_placed_at,
            paid_orders.order_status,
            paid_orders.total_amount_paid,
            paid_orders.payment_finalized_date,
            paid_orders.customer_first_name,
            paid_orders.customer_last_name,
            paid_orders.transaction_seq,
            row_number() over (
                partition by paid_orders.customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when paid_orders.first_order_date = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr,
            paid_orders.customer_lifetime_value,
            paid_orders.first_order_date as fdos
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m09:08:53.852296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:54.323165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:08:54.350173 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:08:53.832177 => 09:08:54.349984
[0m09:08:54.350570 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:08:54.458030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247a9e27-fdfc-49de-8c3e-d225188ffade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d23590>]}
[0m09:08:54.459287 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.63s]
[0m09:08:54.460278 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:08:54.462734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:54.463097 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:08:54.463496 [info ] [MainThread]: 
[0m09:08:54.463948 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m09:08:54.464881 [debug] [MainThread]: Command end result
[0m09:08:54.475194 [info ] [MainThread]: 
[0m09:08:54.475675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:08:54.475984 [info ] [MainThread]: 
[0m09:08:54.476298 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:08:54.476821 [debug] [MainThread]: Command `cli build` succeeded at 09:08:54.476730 after 2.09 seconds
[0m09:08:54.477167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c47c90>]}
[0m09:08:54.477523 [debug] [MainThread]: Flushing usage events
[0m09:10:07.314881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104743f90>]}


============================== 09:10:07.316739 | 148199d0-17cb-4df5-9bdc-2a691fd8db6b ==============================
[0m09:10:07.316739 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:10:07.317048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:10:07.416585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '148199d0-17cb-4df5-9bdc-2a691fd8db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f38050>]}
[0m09:10:07.422815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '148199d0-17cb-4df5-9bdc-2a691fd8db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db6910>]}
[0m09:10:07.423148 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:10:07.440701 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:10:07.458351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:10:07.458618 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m09:10:07.468065 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m09:10:07.475647 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:10:07.477806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '148199d0-17cb-4df5-9bdc-2a691fd8db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f63dd0>]}
[0m09:10:07.481627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '148199d0-17cb-4df5-9bdc-2a691fd8db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105026c90>]}
[0m09:10:07.481834 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:10:07.482516 [info ] [MainThread]: 
[0m09:10:07.482879 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:10:07.483305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:10:07.489300 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:10:07.489498 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:10:07.489642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:08.113737 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:10:08.117448 [debug] [ThreadPool]: On list_analytics: Close
[0m09:10:08.235462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:10:08.244182 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:10:08.244584 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:10:08.244863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:08.767724 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m09:10:08.773752 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:10:08.891868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '148199d0-17cb-4df5-9bdc-2a691fd8db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10473ebd0>]}
[0m09:10:08.893268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:10:08.894022 [info ] [MainThread]: 
[0m09:10:08.898603 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:10:08.899240 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:10:08.900144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:10:08.900564 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:10:08.908721 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:10:08.909481 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:10:08.900823 => 09:10:08.909321
[0m09:10:08.909777 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:10:08.930413 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:10:08.934034 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:10:08.934457 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over (partition by order_id) as first_order_date,
            max(order_placed_at) over (partition by order_id) as most_recent_order_date,
            count(order_id) over (partition by order_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.first_order_date,
            orders.most_recent_order_date,
            orders.number_of_orders,
            orders.order_status,
            payments.payment_finalized_date,
            payments.total_amount_paid,
            sum(payments.total_amount_paid) over (
                partition by orders.customer_id 
                order by payments.total_amount_paid 
                rows between unbounded preceding and current row
                ) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            paid_orders.order_id,
            paid_orders.customer_id,
            paid_orders.order_placed_at,
            paid_orders.order_status,
            paid_orders.total_amount_paid,
            paid_orders.payment_finalized_date,
            paid_orders.customer_first_name,
            paid_orders.customer_last_name,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by paid_orders.customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when paid_orders.first_order_date = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr,
            paid_orders.customer_lifetime_value,
            customer_orders.first_order_date as fdos
        from paid_orders
        left join customer_orders
            on paid_orders.customer_id = customer_orders.customer_id

        order by order_id
    )

select *
from final
  );
[0m09:10:08.934812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:09.454080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:10:09.478868 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:10:08.909951 => 09:10:09.478710
[0m09:10:09.479228 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:10:09.594408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '148199d0-17cb-4df5-9bdc-2a691fd8db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504f6d0>]}
[0m09:10:09.595594 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.69s]
[0m09:10:09.596569 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:10:09.599038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:09.599417 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:10:09.599777 [info ] [MainThread]: 
[0m09:10:09.600237 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m09:10:09.601062 [debug] [MainThread]: Command end result
[0m09:10:09.612033 [info ] [MainThread]: 
[0m09:10:09.612566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:10:09.612883 [info ] [MainThread]: 
[0m09:10:09.613217 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:10:09.613744 [debug] [MainThread]: Command `cli build` succeeded at 09:10:09.613641 after 2.31 seconds
[0m09:10:09.614075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104749f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e9fc90>]}
[0m09:10:09.614422 [debug] [MainThread]: Flushing usage events
[0m09:12:36.472232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108606850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ff850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fff10>]}


============================== 09:12:36.474323 | 0c2a8b7c-7d95-4fb4-869b-860ab6f5465f ==============================
[0m09:12:36.474323 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:12:36.474638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:12:36.576159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c2a8b7c-7d95-4fb4-869b-860ab6f5465f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c73090>]}
[0m09:12:36.582223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c2a8b7c-7d95-4fb4-869b-860ab6f5465f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108625b90>]}
[0m09:12:36.582538 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:12:36.599662 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:12:36.617401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:12:36.617794 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m09:12:36.627174 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m09:12:36.635141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:12:36.637281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c2a8b7c-7d95-4fb4-869b-860ab6f5465f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d7cd0>]}
[0m09:12:36.641006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c2a8b7c-7d95-4fb4-869b-860ab6f5465f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed5b90>]}
[0m09:12:36.641186 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:12:36.641885 [info ] [MainThread]: 
[0m09:12:36.642240 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:12:36.642717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:12:36.648266 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:12:36.648415 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:12:36.648530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:37.047094 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m09:12:37.048273 [debug] [ThreadPool]: On list_analytics: Close
[0m09:12:37.167052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:12:37.172645 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:12:37.172904 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:12:37.173105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:37.549367 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:12:37.554349 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:12:37.675921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c2a8b7c-7d95-4fb4-869b-860ab6f5465f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e1bcd0>]}
[0m09:12:37.677132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:12:37.677615 [info ] [MainThread]: 
[0m09:12:37.682561 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:12:37.683316 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:12:37.684244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:12:37.684690 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:12:37.693705 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:12:37.694473 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:12:37.684957 => 09:12:37.694275
[0m09:12:37.694772 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:12:37.715545 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:12:37.718813 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:12:37.719169 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by payments.total_amount_paid 
                rows between unbounded preceding and current row
                ) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            paid_orders.order_id,
            paid_orders.customer_id,
            paid_orders.order_placed_at,
            paid_orders.order_status,
            paid_orders.total_amount_paid,
            paid_orders.payment_finalized_date,
            paid_orders.customer_first_name,
            paid_orders.customer_last_name,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr,
            paid_orders.customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m09:12:37.719504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:38.237934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:12:38.266612 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:12:37.694953 => 09:12:38.266410
[0m09:12:38.267024 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:12:38.386302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c2a8b7c-7d95-4fb4-869b-860ab6f5465f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec1ad0>]}
[0m09:12:38.387752 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.70s]
[0m09:12:38.388734 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:12:38.391098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:38.391440 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:12:38.391789 [info ] [MainThread]: 
[0m09:12:38.392201 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m09:12:38.393209 [debug] [MainThread]: Command end result
[0m09:12:38.402778 [info ] [MainThread]: 
[0m09:12:38.403228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:38.403548 [info ] [MainThread]: 
[0m09:12:38.403887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:12:38.404450 [debug] [MainThread]: Command `cli build` succeeded at 09:12:38.404358 after 1.94 seconds
[0m09:12:38.404817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108605f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108607f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5bc90>]}
[0m09:12:38.405174 [debug] [MainThread]: Flushing usage events
[0m09:13:01.781627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104223b50>]}


============================== 09:13:01.783521 | 736e74f5-8f45-4843-83ab-57a22863f16f ==============================
[0m09:13:01.783521 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:13:01.783857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:13:01.884332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '736e74f5-8f45-4843-83ab-57a22863f16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488b090>]}
[0m09:13:01.890456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '736e74f5-8f45-4843-83ab-57a22863f16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488b090>]}
[0m09:13:01.890743 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:13:01.908261 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:13:01.925856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:13:01.926162 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m09:13:01.935572 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m09:13:01.943187 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:13:01.945321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '736e74f5-8f45-4843-83ab-57a22863f16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f7f50>]}
[0m09:13:01.949095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '736e74f5-8f45-4843-83ab-57a22863f16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aed450>]}
[0m09:13:01.949290 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:13:01.949955 [info ] [MainThread]: 
[0m09:13:01.950302 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:13:01.950789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:13:01.956335 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:13:01.956487 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:13:01.956604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:03.014993 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:13:03.018340 [debug] [ThreadPool]: On list_analytics: Close
[0m09:13:03.134537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:13:03.140306 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:13:03.140572 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:13:03.140771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:03.513347 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:13:03.517371 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:13:03.633441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736e74f5-8f45-4843-83ab-57a22863f16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b31e10>]}
[0m09:13:03.634280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:13:03.634660 [info ] [MainThread]: 
[0m09:13:03.638105 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:13:03.638549 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:13:03.639140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:13:03.639424 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:13:03.646296 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:13:03.646872 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:13:03.639598 => 09:13:03.646730
[0m09:13:03.647118 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:13:03.665694 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:13:03.668569 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:13:03.668882 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),


    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    x as (
        select p.order_id, sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join
            paid_orders t2
            on p.customer_id = t2.customer_id
            and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ),

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            x.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)
        left outer join x on x.order_id = p.order_id
        order by order_id
    )

select *
from final
  );
[0m09:13:03.669200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:04.164814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:13:04.189482 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:13:03.647268 => 09:13:04.189283
[0m09:13:04.189831 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:13:04.295183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736e74f5-8f45-4843-83ab-57a22863f16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a6a110>]}
[0m09:13:04.296391 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.66s]
[0m09:13:04.297289 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:13:04.299591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:04.299950 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:13:04.300318 [info ] [MainThread]: 
[0m09:13:04.300998 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m09:13:04.302143 [debug] [MainThread]: Command end result
[0m09:13:04.311658 [info ] [MainThread]: 
[0m09:13:04.312087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:13:04.312395 [info ] [MainThread]: 
[0m09:13:04.312714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:13:04.313245 [debug] [MainThread]: Command `cli build` succeeded at 09:13:04.313158 after 2.54 seconds
[0m09:13:04.313593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100973c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008e3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008e3310>]}
[0m09:13:04.313940 [debug] [MainThread]: Flushing usage events
[0m09:13:37.630738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aef690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aefd50>]}


============================== 09:13:37.633072 | 66605a48-8013-43cd-99a0-35dc616c39ac ==============================
[0m09:13:37.633072 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:13:37.633421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:13:37.747170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66605a48-8013-43cd-99a0-35dc616c39ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b15b50>]}
[0m09:13:37.753786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66605a48-8013-43cd-99a0-35dc616c39ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d8d90>]}
[0m09:13:37.754154 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:13:37.772096 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:13:37.790829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:13:37.791229 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m09:13:37.801222 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m09:13:37.809127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:13:37.811236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66605a48-8013-43cd-99a0-35dc616c39ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ec710>]}
[0m09:13:37.815367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66605a48-8013-43cd-99a0-35dc616c39ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c4810>]}
[0m09:13:37.815583 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:13:37.816270 [info ] [MainThread]: 
[0m09:13:37.816627 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:13:37.817080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:13:37.822873 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:13:37.823037 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:13:37.823165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:38.426651 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:13:38.430172 [debug] [ThreadPool]: On list_analytics: Close
[0m09:13:38.541736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:13:38.553416 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:13:38.553948 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:13:38.554307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:38.940792 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:13:38.944769 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:13:39.059286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66605a48-8013-43cd-99a0-35dc616c39ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108236190>]}
[0m09:13:39.060768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:13:39.061399 [info ] [MainThread]: 
[0m09:13:39.066426 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:13:39.067166 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:13:39.068099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:13:39.068516 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:13:39.076929 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:13:39.077719 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:13:39.068774 => 09:13:39.077527
[0m09:13:39.078011 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:13:39.098469 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:13:39.101924 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:13:39.102328 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by payments.total_amount_paid 
                rows between unbounded preceding and current row
                ) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by payments.total_amount_paid 
                rows between unbounded preceding and current row
                ) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name

            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            p.clv_bad as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m09:13:39.102668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:39.442074 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae08cd-0000-22f6-0000-589900013366
[0m09:13:39.442796 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 93 at position 13 unexpected '.'.
syntax error line 94 at position 23 unexpected ')'.
syntax error line 94 at position 25 unexpected 'over'.
syntax error line 94 at position 31 unexpected 'order'.
syntax error line 94 at position 52 unexpected 'as'.
[0m09:13:39.443632 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:13:39.078191 => 09:13:39.443365
[0m09:13:39.444091 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:13:39.561892 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 93 at position 13 unexpected '.'.
  syntax error line 94 at position 23 unexpected ')'.
  syntax error line 94 at position 25 unexpected 'over'.
  syntax error line 94 at position 31 unexpected 'order'.
  syntax error line 94 at position 52 unexpected 'as'.
  compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m09:13:39.562619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66605a48-8013-43cd-99a0-35dc616c39ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108330110>]}
[0m09:13:39.563360 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.fct_customer_orders .......... [[31mERROR[0m in 0.49s]
[0m09:13:39.563991 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:13:39.565610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:39.565883 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:13:39.566146 [info ] [MainThread]: 
[0m09:13:39.566481 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m09:13:39.567041 [debug] [MainThread]: Command end result
[0m09:13:39.575060 [info ] [MainThread]: 
[0m09:13:39.575411 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:13:39.575680 [info ] [MainThread]: 
[0m09:13:39.575933 [error] [MainThread]: [33mDatabase Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)[0m
[0m09:13:39.576180 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m09:13:39.576447 [error] [MainThread]:   syntax error line 93 at position 13 unexpected '.'.
[0m09:13:39.576708 [error] [MainThread]:   syntax error line 94 at position 23 unexpected ')'.
[0m09:13:39.576955 [error] [MainThread]:   syntax error line 94 at position 25 unexpected 'over'.
[0m09:13:39.577191 [error] [MainThread]:   syntax error line 94 at position 31 unexpected 'order'.
[0m09:13:39.577423 [error] [MainThread]:   syntax error line 94 at position 52 unexpected 'as'.
[0m09:13:39.577682 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m09:13:39.577907 [info ] [MainThread]: 
[0m09:13:39.578222 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:13:39.578653 [debug] [MainThread]: Command `cli build` failed at 09:13:39.578578 after 1.96 seconds
[0m09:13:39.578957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af7850>]}
[0m09:13:39.579243 [debug] [MainThread]: Flushing usage events
[0m09:14:21.891414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c68710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c72dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c73490>]}


============================== 09:14:21.893363 | a0cd615f-bb24-4125-a808-65c20eb0f56c ==============================
[0m09:14:21.893363 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:14:21.893707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:14:21.995737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0cd615f-bb24-4125-a808-65c20eb0f56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c67ad0>]}
[0m09:14:22.001858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0cd615f-bb24-4125-a808-65c20eb0f56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108654610>]}
[0m09:14:22.002160 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:14:22.019819 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:14:22.037142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:14:22.037314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:14:22.037564 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:14:22.040417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0cd615f-bb24-4125-a808-65c20eb0f56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774050>]}
[0m09:14:22.044553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0cd615f-bb24-4125-a808-65c20eb0f56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10869a190>]}
[0m09:14:22.044761 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:14:22.045367 [info ] [MainThread]: 
[0m09:14:22.045722 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:14:22.046130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:14:22.051819 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:14:22.051968 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:14:22.052080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:22.489319 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m09:14:22.491616 [debug] [ThreadPool]: On list_analytics: Close
[0m09:14:22.610465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:14:22.620022 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:14:22.620431 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:14:22.620706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:14:23.231694 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m09:14:23.235939 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:14:23.354705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0cd615f-bb24-4125-a808-65c20eb0f56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774210>]}
[0m09:14:23.356439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:14:23.357037 [info ] [MainThread]: 
[0m09:14:23.364840 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:14:23.365927 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:14:23.367015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:14:23.367471 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:14:23.376970 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:14:23.377892 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:14:23.367744 => 09:14:23.377694
[0m09:14:23.378236 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:14:23.401192 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:14:23.403486 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:14:23.403850 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by payments.total_amount_paid 
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            p.customer_lifetime_value as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m09:14:23.404221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:23.803537 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae08ce-0000-22f6-0000-589900013376
[0m09:14:23.804538 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_LIFETIME_VALUE'
[0m09:14:23.805849 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:14:23.378441 => 09:14:23.805470
[0m09:14:23.806495 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:14:23.927545 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_LIFETIME_VALUE'
  compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m09:14:23.929143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cd615f-bb24-4125-a808-65c20eb0f56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e81ad0>]}
[0m09:14:23.930200 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.fct_customer_orders .......... [[31mERROR[0m in 0.56s]
[0m09:14:23.930925 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:14:23.933513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:14:23.933829 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:14:23.934167 [info ] [MainThread]: 
[0m09:14:23.934574 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m09:14:23.935249 [debug] [MainThread]: Command end result
[0m09:14:23.945789 [info ] [MainThread]: 
[0m09:14:23.946355 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:14:23.946747 [info ] [MainThread]: 
[0m09:14:23.947105 [error] [MainThread]: [33mDatabase Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)[0m
[0m09:14:23.947460 [error] [MainThread]:   002025 (42S21): SQL compilation error:
[0m09:14:23.947786 [error] [MainThread]:   duplicate column name 'CUSTOMER_LIFETIME_VALUE'
[0m09:14:23.948118 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m09:14:23.948434 [info ] [MainThread]: 
[0m09:14:23.948734 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:14:23.949214 [debug] [MainThread]: Command `cli build` failed at 09:14:23.949125 after 2.07 seconds
[0m09:14:23.949550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c601d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c83150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c832d0>]}
[0m09:14:23.949873 [debug] [MainThread]: Flushing usage events
[0m09:14:35.224106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113568710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113568250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11357b6d0>]}


============================== 09:14:35.226133 | 3c44d11c-9417-42d8-bf0c-7a0fb935c6b8 ==============================
[0m09:14:35.226133 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:14:35.226459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:14:35.327507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c44d11c-9417-42d8-bf0c-7a0fb935c6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11357b190>]}
[0m09:14:35.333525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c44d11c-9417-42d8-bf0c-7a0fb935c6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113587310>]}
[0m09:14:35.333820 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:14:35.351178 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:14:35.368896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:14:35.369091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:14:35.369323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:14:35.372035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c44d11c-9417-42d8-bf0c-7a0fb935c6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fc55d0>]}
[0m09:14:35.376337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c44d11c-9417-42d8-bf0c-7a0fb935c6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e7d650>]}
[0m09:14:35.376541 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:14:35.377163 [info ] [MainThread]: 
[0m09:14:35.377506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:14:35.377924 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:14:35.383644 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:14:35.383795 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:14:35.383907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:36.031657 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:14:36.036875 [debug] [ThreadPool]: On list_analytics: Close
[0m09:14:36.153689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:14:36.164839 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:14:36.165314 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:14:36.165660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:14:36.695444 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m09:14:36.698969 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:14:36.819668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c44d11c-9417-42d8-bf0c-7a0fb935c6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11574a590>]}
[0m09:14:36.820453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:14:36.820813 [info ] [MainThread]: 
[0m09:14:36.825330 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:14:36.825778 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:14:36.826404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:14:36.826684 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:14:36.833644 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:14:36.834263 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:14:36.826859 => 09:14:36.834121
[0m09:14:36.834521 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:14:36.853079 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:14:36.855136 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:14:36.855444 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by payments.total_amount_paid 
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            p.customer_lifetime_value as customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m09:14:36.855732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:37.268372 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae08ce-0000-22f6-0000-58990001337e
[0m09:14:37.269118 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_LIFETIME_VALUE'
[0m09:14:37.269899 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:14:36.834671 => 09:14:37.269639
[0m09:14:37.270395 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:14:37.390999 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_LIFETIME_VALUE'
  compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m09:14:37.391712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c44d11c-9417-42d8-bf0c-7a0fb935c6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eba2d0>]}
[0m09:14:37.392462 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.fct_customer_orders .......... [[31mERROR[0m in 0.57s]
[0m09:14:37.393078 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:14:37.394879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:14:37.395135 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:14:37.395395 [info ] [MainThread]: 
[0m09:14:37.395716 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m09:14:37.396241 [debug] [MainThread]: Command end result
[0m09:14:37.404191 [info ] [MainThread]: 
[0m09:14:37.404536 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:14:37.404812 [info ] [MainThread]: 
[0m09:14:37.405066 [error] [MainThread]: [33mDatabase Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)[0m
[0m09:14:37.405375 [error] [MainThread]:   002025 (42S21): SQL compilation error:
[0m09:14:37.405655 [error] [MainThread]:   duplicate column name 'CUSTOMER_LIFETIME_VALUE'
[0m09:14:37.405889 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m09:14:37.406115 [info ] [MainThread]: 
[0m09:14:37.406374 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:14:37.406795 [debug] [MainThread]: Command `cli build` failed at 09:14:37.406725 after 2.19 seconds
[0m09:14:37.407079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113586ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113586fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7b190>]}
[0m09:14:37.407357 [debug] [MainThread]: Flushing usage events
[0m09:15:01.889732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b47410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b47b10>]}


============================== 09:15:01.891583 | 6926212f-9de6-4f75-8114-30995ac558f0 ==============================
[0m09:15:01.891583 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:15:01.891913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:15:01.992358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6926212f-9de6-4f75-8114-30995ac558f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511c7d0>]}
[0m09:15:01.998294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6926212f-9de6-4f75-8114-30995ac558f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109333c90>]}
[0m09:15:01.998584 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:15:02.016284 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:15:02.033429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:15:02.033603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:15:02.033835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:15:02.036510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6926212f-9de6-4f75-8114-30995ac558f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b43190>]}
[0m09:15:02.040702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6926212f-9de6-4f75-8114-30995ac558f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109352e90>]}
[0m09:15:02.040934 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:15:02.041639 [info ] [MainThread]: 
[0m09:15:02.042032 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:15:02.042511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:15:02.048133 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:15:02.048303 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:15:02.048419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:02.619186 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:15:02.624052 [debug] [ThreadPool]: On list_analytics: Close
[0m09:15:02.733057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:15:02.744595 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:15:02.745053 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:15:02.745408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:03.306199 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m09:15:03.308388 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:15:03.431351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6926212f-9de6-4f75-8114-30995ac558f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a951850>]}
[0m09:15:03.432442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:15:03.432893 [info ] [MainThread]: 
[0m09:15:03.438418 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:15:03.438961 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:15:03.439718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:15:03.440053 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:15:03.447757 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:15:03.448601 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:15:03.440268 => 09:15:03.448391
[0m09:15:03.448929 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:15:03.468631 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:15:03.470779 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:15:03.471124 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by payments.total_amount_paid 
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            p.customer_lifetime_value,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m09:15:03.471427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:03.866468 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae08cf-0000-2300-0000-589900012322
[0m09:15:03.867120 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_LIFETIME_VALUE'
[0m09:15:03.867851 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:15:03.449118 => 09:15:03.867617
[0m09:15:03.868306 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:15:03.982305 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_LIFETIME_VALUE'
  compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m09:15:03.983236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6926212f-9de6-4f75-8114-30995ac558f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ba8d0>]}
[0m09:15:03.984123 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.fct_customer_orders .......... [[31mERROR[0m in 0.54s]
[0m09:15:03.984757 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:15:03.986883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:03.987347 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:15:03.987711 [info ] [MainThread]: 
[0m09:15:03.988153 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m09:15:03.988835 [debug] [MainThread]: Command end result
[0m09:15:03.997602 [info ] [MainThread]: 
[0m09:15:03.998082 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:15:03.998408 [info ] [MainThread]: 
[0m09:15:03.998718 [error] [MainThread]: [33mDatabase Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)[0m
[0m09:15:03.999028 [error] [MainThread]:   002025 (42S21): SQL compilation error:
[0m09:15:03.999287 [error] [MainThread]:   duplicate column name 'CUSTOMER_LIFETIME_VALUE'
[0m09:15:03.999529 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m09:15:03.999766 [info ] [MainThread]: 
[0m09:15:04.000028 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:15:04.000454 [debug] [MainThread]: Command `cli build` failed at 09:15:04.000372 after 2.12 seconds
[0m09:15:04.000759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5f7d0>]}
[0m09:15:04.001057 [debug] [MainThread]: Flushing usage events
[0m09:15:23.446033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110772850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11076b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11076bf90>]}


============================== 09:15:23.447887 | b8a03c8f-27ff-4edd-a830-4e7846f916e9 ==============================
[0m09:15:23.447887 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:15:23.448209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:15:23.548061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8a03c8f-27ff-4edd-a830-4e7846f916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110783f50>]}
[0m09:15:23.554167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8a03c8f-27ff-4edd-a830-4e7846f916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110792110>]}
[0m09:15:23.554450 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:15:23.571501 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:15:23.589571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:15:23.589884 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m09:15:23.599629 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m09:15:23.607336 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:15:23.609455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8a03c8f-27ff-4edd-a830-4e7846f916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111331f90>]}
[0m09:15:23.613283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8a03c8f-27ff-4edd-a830-4e7846f916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112dea90>]}
[0m09:15:23.613465 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:15:23.614188 [info ] [MainThread]: 
[0m09:15:23.614535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:15:23.614995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:15:23.620769 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:15:23.620931 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:15:23.621049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:24.048401 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m09:15:24.051142 [debug] [ThreadPool]: On list_analytics: Close
[0m09:15:24.173203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:15:24.183553 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:15:24.184041 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:15:24.184389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:24.554589 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:15:24.558153 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:15:24.680486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8a03c8f-27ff-4edd-a830-4e7846f916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126ee50>]}
[0m09:15:24.681305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:15:24.681663 [info ] [MainThread]: 
[0m09:15:24.685243 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:15:24.685711 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:15:24.686323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:15:24.686607 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:15:24.693562 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:15:24.694152 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:15:24.686784 => 09:15:24.694009
[0m09:15:24.694402 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:15:24.713231 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:15:24.716123 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:15:24.716442 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by payments.total_amount_paid 
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m09:15:24.716743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:25.211966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:15:25.238920 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:15:24.694546 => 09:15:25.238731
[0m09:15:25.239326 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:15:25.352738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a03c8f-27ff-4edd-a830-4e7846f916e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11273a350>]}
[0m09:15:25.353898 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.67s]
[0m09:15:25.354793 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:15:25.357064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:25.357485 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:15:25.357830 [info ] [MainThread]: 
[0m09:15:25.358237 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m09:15:25.359000 [debug] [MainThread]: Command end result
[0m09:15:25.368037 [info ] [MainThread]: 
[0m09:15:25.368500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:15:25.368812 [info ] [MainThread]: 
[0m09:15:25.369128 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:15:25.369628 [debug] [MainThread]: Command `cli build` succeeded at 09:15:25.369539 after 1.93 seconds
[0m09:15:25.369974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bf190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bf2d0>]}
[0m09:15:25.370324 [debug] [MainThread]: Flushing usage events
[0m09:22:10.746570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111768710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11177aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11177b190>]}


============================== 09:22:10.748417 | 2603649e-20bf-4d62-96c2-ed5587c5f2b7 ==============================
[0m09:22:10.748417 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:22:10.748734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:22:10.848151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2603649e-20bf-4d62-96c2-ed5587c5f2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111760f90>]}
[0m09:22:10.854424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2603649e-20bf-4d62-96c2-ed5587c5f2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ff9350>]}
[0m09:22:10.854739 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:22:10.871803 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:22:10.889013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:22:10.889227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:22:10.889535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:22:10.892394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2603649e-20bf-4d62-96c2-ed5587c5f2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111021610>]}
[0m09:22:10.896352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2603649e-20bf-4d62-96c2-ed5587c5f2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ac490>]}
[0m09:22:10.896555 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:22:10.897179 [info ] [MainThread]: 
[0m09:22:10.897571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:22:10.898030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:22:10.903735 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:22:10.903906 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:22:10.904043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:11.506953 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:22:11.508511 [debug] [ThreadPool]: On list_analytics: Close
[0m09:22:11.621176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:22:11.631768 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:22:11.632369 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:22:11.632720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:12.161156 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m09:22:12.164101 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:22:12.282533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2603649e-20bf-4d62-96c2-ed5587c5f2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111792e90>]}
[0m09:22:12.284157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:22:12.284727 [info ] [MainThread]: 
[0m09:22:12.290497 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:22:12.291244 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:22:12.292186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:22:12.292611 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:22:12.302500 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:22:12.303451 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:22:12.292878 => 09:22:12.303242
[0m09:22:12.303807 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:22:12.328388 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:22:12.330713 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:22:12.331081 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.order_id,
            orders.customer_id,
            orders.order_placed_at,
            orders.order_status,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            c.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m09:22:12.331437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:12.856737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:22:12.885877 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:22:12.304015 => 09:22:12.885637
[0m09:22:12.886403 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:22:12.994170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2603649e-20bf-4d62-96c2-ed5587c5f2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a13450>]}
[0m09:22:12.996195 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.70s]
[0m09:22:12.998214 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:22:13.002160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:13.002912 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:22:13.003661 [info ] [MainThread]: 
[0m09:22:13.004376 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m09:22:13.005597 [debug] [MainThread]: Command end result
[0m09:22:13.018207 [info ] [MainThread]: 
[0m09:22:13.018938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:22:13.019354 [info ] [MainThread]: 
[0m09:22:13.019877 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:22:13.020710 [debug] [MainThread]: Command `cli build` succeeded at 09:22:13.020584 after 2.28 seconds
[0m09:22:13.021166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111629c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104473b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e32d0>]}
[0m09:22:13.021615 [debug] [MainThread]: Flushing usage events
[0m09:30:42.285528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ade850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad5ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae7e10>]}


============================== 09:30:42.287484 | 9d24ccb6-1ab1-40f6-aeb7-99df2c0d9934 ==============================
[0m09:30:42.287484 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:30:42.287805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:30:42.389916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d24ccb6-1ab1-40f6-aeb7-99df2c0d9934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b05b50>]}
[0m09:30:42.395913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d24ccb6-1ab1-40f6-aeb7-99df2c0d9934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109402250>]}
[0m09:30:42.396181 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:30:42.412964 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:30:42.430437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:30:42.430607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:30:42.430856 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:30:42.433549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d24ccb6-1ab1-40f6-aeb7-99df2c0d9934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092dea50>]}
[0m09:30:42.437440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d24ccb6-1ab1-40f6-aeb7-99df2c0d9934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109496d10>]}
[0m09:30:42.437655 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:30:42.438265 [info ] [MainThread]: 
[0m09:30:42.438620 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:30:42.439151 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:30:42.445255 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:30:42.445418 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:30:42.445537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:42.831668 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m09:30:42.833523 [debug] [ThreadPool]: On list_analytics: Close
[0m09:30:42.942145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:30:42.952890 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:30:42.953374 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:30:42.953656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:43.332782 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:30:43.336433 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:30:43.455016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d24ccb6-1ab1-40f6-aeb7-99df2c0d9934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f7e10>]}
[0m09:30:43.456356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:30:43.456871 [info ] [MainThread]: 
[0m09:30:43.463323 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:30:43.464028 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:30:43.464966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:30:43.465395 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:30:43.473886 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:30:43.474627 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:30:43.465670 => 09:30:43.474443
[0m09:30:43.474913 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:30:43.495253 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:30:43.497424 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:30:43.497762 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by order_id) as first_order_date,
            max(order_placed_at) over(partition by order_id) as most_recent_order_date,
            count(order_id) over(partition by order_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            p.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m09:30:43.498069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:43.985818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:30:44.010941 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:30:43.475082 => 09:30:44.010736
[0m09:30:44.011345 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:30:44.118706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d24ccb6-1ab1-40f6-aeb7-99df2c0d9934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109534ad0>]}
[0m09:30:44.119606 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.65s]
[0m09:30:44.120376 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:30:44.122272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:44.122601 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:30:44.122927 [info ] [MainThread]: 
[0m09:30:44.123330 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m09:30:44.124069 [debug] [MainThread]: Command end result
[0m09:30:44.132301 [info ] [MainThread]: 
[0m09:30:44.132651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:30:44.132906 [info ] [MainThread]: 
[0m09:30:44.133181 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:30:44.133646 [debug] [MainThread]: Command `cli build` succeeded at 09:30:44.133571 after 1.86 seconds
[0m09:30:44.133954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fb2d0>]}
[0m09:30:44.134250 [debug] [MainThread]: Flushing usage events
[0m09:32:09.609933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c6a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c73450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c73b50>]}


============================== 09:32:09.611994 | 4825979e-9543-4971-8afe-af19c78b20db ==============================
[0m09:32:09.611994 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:32:09.612311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:32:09.713669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4825979e-9543-4971-8afe-af19c78b20db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c673d0>]}
[0m09:32:09.719868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4825979e-9543-4971-8afe-af19c78b20db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c91710>]}
[0m09:32:09.720186 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:32:09.737965 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:32:09.755512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:32:09.755800 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m09:32:09.765460 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m09:32:09.773394 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:32:09.775517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4825979e-9543-4971-8afe-af19c78b20db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c92050>]}
[0m09:32:09.779362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4825979e-9543-4971-8afe-af19c78b20db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112568810>]}
[0m09:32:09.779551 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:32:09.780180 [info ] [MainThread]: 
[0m09:32:09.780531 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:32:09.780973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:32:09.786729 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:32:09.786903 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:32:09.787022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:10.182267 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m09:32:10.183264 [debug] [ThreadPool]: On list_analytics: Close
[0m09:32:10.288027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:32:10.293548 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:32:10.293837 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:32:10.294038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:10.656219 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:32:10.659645 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:32:10.784792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4825979e-9543-4971-8afe-af19c78b20db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135ccad0>]}
[0m09:32:10.786284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:32:10.786941 [info ] [MainThread]: 
[0m09:32:10.792093 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:32:10.792811 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:32:10.793777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:32:10.794199 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:32:10.802928 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:32:10.803744 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:32:10.794458 => 09:32:10.803570
[0m09:32:10.804063 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:32:10.824985 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:32:10.828038 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:32:10.828390 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as first_order_date,
            max(order_placed_at) over(partition by customer_id) as most_recent_order_date,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) as payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    

    customer_orders as (
        select
            customers.customer_id,
            min(orders.order_placed_at) as first_order_date,
            max(orders.order_placed_at) as most_recent_order_date,
            count(orders.order_id) as number_of_orders
        from customers
        left join orders on orders.customer_id = customers.customer_id
        group by 1
    ),

    final as (
        select
            p.*,
            row_number() over (order by p.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by p.order_id
            ) as customer_sales_seq,
            case
                when c.first_order_date = p.order_placed_at then 'new' else 'return'
            end as nvsr,
            p.first_order_date as fdos
        from paid_orders p
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m09:32:10.828736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:11.519157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:32:11.546184 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:32:10.804256 => 09:32:11.545994
[0m09:32:11.546609 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:32:11.659237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4825979e-9543-4971-8afe-af19c78b20db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125c4110>]}
[0m09:32:11.659774 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.87s]
[0m09:32:11.660199 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:32:11.661198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:11.661417 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:32:11.661604 [info ] [MainThread]: 
[0m09:32:11.661831 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m09:32:11.662229 [debug] [MainThread]: Command end result
[0m09:32:11.667205 [info ] [MainThread]: 
[0m09:32:11.667469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:32:11.667649 [info ] [MainThread]: 
[0m09:32:11.667833 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:32:11.668128 [debug] [MainThread]: Command `cli build` succeeded at 09:32:11.668079 after 2.07 seconds
[0m09:32:11.668325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11199dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fef310>]}
[0m09:32:11.668524 [debug] [MainThread]: Flushing usage events
[0m14:45:02.117497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbf810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbfed0>]}


============================== 14:45:02.119313 | a297bc95-69a5-4869-8a16-8f359162c54b ==============================
[0m14:45:02.119313 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:45:02.119616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:45:02.225314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a297bc95-69a5-4869-8a16-8f359162c54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862b050>]}
[0m14:45:02.231638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a297bc95-69a5-4869-8a16-8f359162c54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108775090>]}
[0m14:45:02.231936 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:45:02.248581 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:45:02.266133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:02.266309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:02.266539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:45:02.269277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a297bc95-69a5-4869-8a16-8f359162c54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b0c10>]}
[0m14:45:02.273199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a297bc95-69a5-4869-8a16-8f359162c54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108761b10>]}
[0m14:45:02.273411 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:45:02.274054 [info ] [MainThread]: 
[0m14:45:02.274401 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:02.274863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:45:02.280500 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:45:02.280638 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:45:02.280749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:02.953643 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:45:02.958943 [debug] [ThreadPool]: On list_analytics: Close
[0m14:45:03.073915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:45:03.082692 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:45:03.083135 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:45:03.083475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:03.629404 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m14:45:03.633534 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:45:03.757290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a297bc95-69a5-4869-8a16-8f359162c54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108878810>]}
[0m14:45:03.758316 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:03.758679 [info ] [MainThread]: 
[0m14:45:03.764368 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:45:03.764908 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:45:03.765645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:45:03.765972 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:45:03.772803 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:45:03.773420 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:45:03.766174 => 14:45:03.773278
[0m14:45:03.773670 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:45:03.792737 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:45:03.794776 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:45:03.795124 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as first_order_date,
            max(order_placed_at) over(partition by customer_id) as most_recent_order_date,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when paid_orders.first_order_date = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr,
            paid_orders.first_order_date as fdos
        from paid_orders
        left join customer_orders as c using (customer_id)

        order by order_id
    )

select *
from final
  );
[0m14:45:03.795447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:04.369484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:45:04.398816 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:45:03.773816 => 14:45:04.398632
[0m14:45:04.399206 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:45:04.511251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a297bc95-69a5-4869-8a16-8f359162c54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884d550>]}
[0m14:45:04.512424 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.75s]
[0m14:45:04.513415 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:45:04.515354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:04.515671 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:45:04.515989 [info ] [MainThread]: 
[0m14:45:04.516403 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m14:45:04.517155 [debug] [MainThread]: Command end result
[0m14:45:04.526474 [info ] [MainThread]: 
[0m14:45:04.526896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:04.527190 [info ] [MainThread]: 
[0m14:45:04.527492 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:45:04.527923 [debug] [MainThread]: Command `cli build` succeeded at 14:45:04.527855 after 2.42 seconds
[0m14:45:04.528210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104713b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104683250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104683310>]}
[0m14:45:04.528489 [debug] [MainThread]: Flushing usage events
[0m14:48:06.194584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfe850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e07790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e07e50>]}


============================== 14:48:06.196429 | b44e2a9c-5b37-4c39-b764-d37f854af5ed ==============================
[0m14:48:06.196429 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:48:06.196743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:48:06.295772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b44e2a9c-5b37-4c39-b764-d37f854af5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f4050>]}
[0m14:48:06.301856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b44e2a9c-5b37-4c39-b764-d37f854af5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfb910>]}
[0m14:48:06.302137 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:48:06.319153 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:48:06.336798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:48:06.336971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:48:06.337211 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:48:06.339913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b44e2a9c-5b37-4c39-b764-d37f854af5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfd290>]}
[0m14:48:06.343796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b44e2a9c-5b37-4c39-b764-d37f854af5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106614a50>]}
[0m14:48:06.344002 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:48:06.344679 [info ] [MainThread]: 
[0m14:48:06.345038 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:48:06.345578 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:48:06.351498 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:48:06.351662 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:48:06.351787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:07.069998 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:48:07.073624 [debug] [ThreadPool]: On list_analytics: Close
[0m14:48:07.192736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:48:07.204203 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:48:07.204745 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:48:07.205085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:07.597798 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m14:48:07.602182 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:48:07.725784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44e2a9c-5b37-4c39-b764-d37f854af5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2a9d0>]}
[0m14:48:07.727497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:48:07.728155 [info ] [MainThread]: 
[0m14:48:07.734617 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:48:07.735375 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:48:07.736212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:48:07.736547 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:48:07.744813 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:48:07.745655 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:48:07.736750 => 14:48:07.745472
[0m14:48:07.745960 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:48:07.766881 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:48:07.768946 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:48:07.769274 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as first_order_date,
            max(order_placed_at) over(partition by customer_id) as most_recent_order_date,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when paid_orders.first_order_date = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr,
            paid_orders.first_order_date as fdos
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m14:48:07.769561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:08.352713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:48:08.376589 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:48:07.746131 => 14:48:08.376412
[0m14:48:08.376970 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:48:08.494299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44e2a9c-5b37-4c39-b764-d37f854af5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660bed0>]}
[0m14:48:08.495522 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.76s]
[0m14:48:08.496477 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:48:08.498810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:08.499131 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:48:08.499470 [info ] [MainThread]: 
[0m14:48:08.499876 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m14:48:08.500893 [debug] [MainThread]: Command end result
[0m14:48:08.510671 [info ] [MainThread]: 
[0m14:48:08.511111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:08.511421 [info ] [MainThread]: 
[0m14:48:08.511748 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:48:08.512273 [debug] [MainThread]: Command `cli build` succeeded at 14:48:08.512179 after 2.33 seconds
[0m14:48:08.512621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfe4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024cb1d0>]}
[0m14:48:08.512985 [debug] [MainThread]: Flushing usage events
[0m14:51:03.644239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106363ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106363f90>]}


============================== 14:51:03.646128 | a6b7bdb7-db31-4c8a-8d15-c2a594f2ff05 ==============================
[0m14:51:03.646128 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:51:03.646432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:51:03.748475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6b7bdb7-db31-4c8a-8d15-c2a594f2ff05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b58050>]}
[0m14:51:03.754609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6b7bdb7-db31-4c8a-8d15-c2a594f2ff05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637ad50>]}
[0m14:51:03.754893 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:51:03.771570 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:51:03.789348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:03.789578 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:03.789855 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:51:03.792679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6b7bdb7-db31-4c8a-8d15-c2a594f2ff05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635ebd0>]}
[0m14:51:03.796685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6b7bdb7-db31-4c8a-8d15-c2a594f2ff05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b83110>]}
[0m14:51:03.796896 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:51:03.797507 [info ] [MainThread]: 
[0m14:51:03.797855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:51:03.798379 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:51:03.804463 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:51:03.804625 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:51:03.804743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:04.199097 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:51:04.202555 [debug] [ThreadPool]: On list_analytics: Close
[0m14:51:04.318480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:51:04.326995 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:51:04.327354 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:51:04.327624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:04.695373 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m14:51:04.700393 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:51:04.818460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6b7bdb7-db31-4c8a-8d15-c2a594f2ff05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a80cd0>]}
[0m14:51:04.820035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:04.820723 [info ] [MainThread]: 
[0m14:51:04.826386 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:51:04.826981 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:51:04.827706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:51:04.828031 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:51:04.836155 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:51:04.836931 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:51:04.828251 => 14:51:04.836765
[0m14:51:04.837232 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:51:04.857254 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:51:04.859195 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:51:04.859520 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as first_order_date,
            max(order_placed_at) over(partition by customer_id) as fdos,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when paid_orders.first_order_date = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m14:51:04.859804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:05.352277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:51:05.366554 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:51:04.837410 => 14:51:05.366436
[0m14:51:05.366796 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:51:05.469711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6b7bdb7-db31-4c8a-8d15-c2a594f2ff05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4f190>]}
[0m14:51:05.470385 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.64s]
[0m14:51:05.471002 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:51:05.472497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:05.472826 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:51:05.473111 [info ] [MainThread]: 
[0m14:51:05.473453 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m14:51:05.473988 [debug] [MainThread]: Command end result
[0m14:51:05.480795 [info ] [MainThread]: 
[0m14:51:05.481138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:05.481404 [info ] [MainThread]: 
[0m14:51:05.481644 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:05.482023 [debug] [MainThread]: Command `cli build` succeeded at 14:51:05.481956 after 1.85 seconds
[0m14:51:05.482267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102abfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a2f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a2f2d0>]}
[0m14:51:05.482512 [debug] [MainThread]: Flushing usage events
[0m14:51:45.167936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c17590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c23550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c23c10>]}


============================== 14:51:45.169806 | 260aa162-97b1-4024-824d-dae877397554 ==============================
[0m14:51:45.169806 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:51:45.170144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:51:45.271152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '260aa162-97b1-4024-824d-dae877397554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106410050>]}
[0m14:51:45.277348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '260aa162-97b1-4024-824d-dae877397554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628f390>]}
[0m14:51:45.277631 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:51:45.294836 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:51:45.312293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:45.312459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:45.312706 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:51:45.315704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '260aa162-97b1-4024-824d-dae877397554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fc850>]}
[0m14:51:45.320795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '260aa162-97b1-4024-824d-dae877397554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641fd90>]}
[0m14:51:45.320987 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:51:45.321611 [info ] [MainThread]: 
[0m14:51:45.321959 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:51:45.322439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:51:45.328044 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:51:45.328208 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:51:45.328328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:46.000298 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:51:46.002544 [debug] [ThreadPool]: On list_analytics: Close
[0m14:51:46.117226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:51:46.123836 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:51:46.124139 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:51:46.124384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:46.488643 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m14:51:46.490057 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:51:46.602227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '260aa162-97b1-4024-824d-dae877397554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cf390>]}
[0m14:51:46.602991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:46.603341 [info ] [MainThread]: 
[0m14:51:46.606779 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:51:46.607176 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:51:46.607749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:51:46.608019 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:51:46.614490 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:51:46.615151 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:51:46.608189 => 14:51:46.614998
[0m14:51:46.615418 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:51:46.633409 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:51:46.635223 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:51:46.635520 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as first_order_date,
            max(order_placed_at) over(partition by customer_id) as fdos,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when paid_orders.fdos = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m14:51:46.635799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:47.127855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:51:47.156344 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:51:46.615569 => 14:51:47.156145
[0m14:51:47.156782 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:51:47.273517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '260aa162-97b1-4024-824d-dae877397554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f7550>]}
[0m14:51:47.274604 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.67s]
[0m14:51:47.275438 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:51:47.277285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:47.277666 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:51:47.278021 [info ] [MainThread]: 
[0m14:51:47.278448 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m14:51:47.279245 [debug] [MainThread]: Command end result
[0m14:51:47.287682 [info ] [MainThread]: 
[0m14:51:47.288099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:47.288371 [info ] [MainThread]: 
[0m14:51:47.288652 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:47.289077 [debug] [MainThread]: Command `cli build` succeeded at 14:51:47.289008 after 2.13 seconds
[0m14:51:47.289372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c337d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102377b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022e7310>]}
[0m14:51:47.289669 [debug] [MainThread]: Flushing usage events
[0m14:52:39.655840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10425a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104263810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104263ed0>]}


============================== 14:52:39.658087 | a735230d-7761-4997-8900-330468e8a18d ==============================
[0m14:52:39.658087 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:52:39.658410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:39.768720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a735230d-7761-4997-8900-330468e8a18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031a5210>]}
[0m14:52:39.775088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a735230d-7761-4997-8900-330468e8a18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104283490>]}
[0m14:52:39.775427 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:52:39.792755 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:52:39.809906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:39.810097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:39.810333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:52:39.813383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a735230d-7761-4997-8900-330468e8a18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b33b90>]}
[0m14:52:39.817339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a735230d-7761-4997-8900-330468e8a18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a59450>]}
[0m14:52:39.817533 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:39.818142 [info ] [MainThread]: 
[0m14:52:39.818495 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:39.818944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:52:39.824463 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:52:39.824646 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:52:39.824774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:40.238837 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:52:40.241137 [debug] [ThreadPool]: On list_analytics: Close
[0m14:52:40.358770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:52:40.369900 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:52:40.370360 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:52:40.370656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:40.739461 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m14:52:40.740830 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:52:40.854979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a735230d-7761-4997-8900-330468e8a18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105978e50>]}
[0m14:52:40.855624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:40.855914 [info ] [MainThread]: 
[0m14:52:40.859381 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:52:40.859785 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:52:40.860257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:52:40.860530 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:52:40.865760 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:52:40.866285 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:52:40.860666 => 14:52:40.866167
[0m14:52:40.866502 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:52:40.882859 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:52:40.884673 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:52:40.885005 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as fdos,
            max(order_placed_at) over(partition by customer_id) as most_recent_order_date,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when paid_orders.fdos = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m14:52:40.885321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:41.382726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:41.412524 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:52:40.866622 => 14:52:41.412313
[0m14:52:41.412963 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:52:41.520784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a735230d-7761-4997-8900-330468e8a18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e4ad0>]}
[0m14:52:41.521784 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.66s]
[0m14:52:41.522553 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:52:41.524400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:41.524792 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:52:41.525170 [info ] [MainThread]: 
[0m14:52:41.525652 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m14:52:41.526411 [debug] [MainThread]: Command end result
[0m14:52:41.534688 [info ] [MainThread]: 
[0m14:52:41.535054 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:41.535318 [info ] [MainThread]: 
[0m14:52:41.535605 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:41.536101 [debug] [MainThread]: Command `cli build` succeeded at 14:52:41.536020 after 1.89 seconds
[0m14:52:41.536417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104259f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042599d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009271d0>]}
[0m14:52:41.536717 [debug] [MainThread]: Flushing usage events
[0m14:55:26.125889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a66850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a77150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a77850>]}


============================== 14:55:26.127664 | 216e4185-9130-4916-88f5-72a87bf448e9 ==============================
[0m14:55:26.127664 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:55:26.127985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:55:26.229119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '216e4185-9130-4916-88f5-72a87bf448e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110350290>]}
[0m14:55:26.235313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '216e4185-9130-4916-88f5-72a87bf448e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110350290>]}
[0m14:55:26.235633 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:55:26.252584 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:55:26.269920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:26.270091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:26.270349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:55:26.273011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '216e4185-9130-4916-88f5-72a87bf448e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104c4050>]}
[0m14:55:26.277271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '216e4185-9130-4916-88f5-72a87bf448e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110324fd0>]}
[0m14:55:26.277479 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:55:26.278129 [info ] [MainThread]: 
[0m14:55:26.278495 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:26.278908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:55:26.284409 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:55:26.284553 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:55:26.284693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:26.873039 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:55:26.878218 [debug] [ThreadPool]: On list_analytics: Close
[0m14:55:26.985973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:55:26.996552 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:55:26.996984 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:55:26.997260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:27.550406 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m14:55:27.556394 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:55:27.674549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '216e4185-9130-4916-88f5-72a87bf448e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d5310>]}
[0m14:55:27.675838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:27.676332 [info ] [MainThread]: 
[0m14:55:27.682392 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:55:27.683066 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:55:27.683986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:55:27.684397 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:55:27.692795 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:55:27.693461 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:55:27.684662 => 14:55:27.693298
[0m14:55:27.693744 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:55:27.714190 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:55:27.716077 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:55:27.716393 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as fdos,
            max(order_placed_at) over(partition by customer_id) as most_recent_order_date,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name,
            nvl2(fdos = order_placed_at, 'new', 'return') as nvsr

        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m14:55:27.716703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:28.197816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:55:28.223275 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:55:27.693914 => 14:55:28.223089
[0m14:55:28.223679 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:55:28.325630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216e4185-9130-4916-88f5-72a87bf448e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119edbd0>]}
[0m14:55:28.326821 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.64s]
[0m14:55:28.327787 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:55:28.330191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:28.330513 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:55:28.330849 [info ] [MainThread]: 
[0m14:55:28.331242 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m14:55:28.332008 [debug] [MainThread]: Command end result
[0m14:55:28.341873 [info ] [MainThread]: 
[0m14:55:28.342349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:28.342667 [info ] [MainThread]: 
[0m14:55:28.343015 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:55:28.343560 [debug] [MainThread]: Command `cli build` succeeded at 14:55:28.343462 after 2.23 seconds
[0m14:55:28.343918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030abc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10301b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10301b2d0>]}
[0m14:55:28.344274 [debug] [MainThread]: Flushing usage events
[0m14:56:21.326819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065236d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106523d90>]}


============================== 14:56:21.328679 | a530cca7-0875-4277-b30b-46554c56528d ==============================
[0m14:56:21.328679 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:56:21.329015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:56:21.431306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a530cca7-0875-4277-b30b-46554c56528d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97090>]}
[0m14:56:21.437349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a530cca7-0875-4277-b30b-46554c56528d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d149d0>]}
[0m14:56:21.437644 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:56:21.455188 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:56:21.472894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:21.473179 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m14:56:21.482686 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m14:56:21.491267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:56:21.493552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a530cca7-0875-4277-b30b-46554c56528d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d50a10>]}
[0m14:56:21.497652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a530cca7-0875-4277-b30b-46554c56528d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de3510>]}
[0m14:56:21.497866 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:56:21.498501 [info ] [MainThread]: 
[0m14:56:21.498843 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:56:21.499268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:56:21.504858 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:56:21.505044 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:56:21.505170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:22.191475 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:56:22.195336 [debug] [ThreadPool]: On list_analytics: Close
[0m14:56:22.310930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:56:22.318059 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:56:22.318415 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:56:22.318658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:22.973042 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m14:56:22.975601 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:56:23.089916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a530cca7-0875-4277-b30b-46554c56528d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df3050>]}
[0m14:56:23.091392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:23.091995 [info ] [MainThread]: 
[0m14:56:23.096309 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:56:23.097008 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:56:23.097937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:56:23.098364 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:56:23.106943 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:56:23.107780 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:56:23.098620 => 14:56:23.107577
[0m14:56:23.108127 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:56:23.130512 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:56:23.133468 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:56:23.133807 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as fdos,
            max(order_placed_at) over(partition by customer_id) as most_recent_order_date,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name,
            nvl2(fdos = order_placed_at, 'return', 'new') as nvsr

        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m14:56:23.134109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:23.598868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:56:23.637780 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:56:23.108320 => 14:56:23.637560
[0m14:56:23.638282 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:56:23.747086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530cca7-0875-4277-b30b-46554c56528d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732a310>]}
[0m14:56:23.748446 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.65s]
[0m14:56:23.750063 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:56:23.753366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:23.753972 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:56:23.754517 [info ] [MainThread]: 
[0m14:56:23.755194 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m14:56:23.757118 [debug] [MainThread]: Command end result
[0m14:56:23.769251 [info ] [MainThread]: 
[0m14:56:23.769801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:23.770193 [info ] [MainThread]: 
[0m14:56:23.770601 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:56:23.771273 [debug] [MainThread]: Command `cli build` succeeded at 14:56:23.771152 after 2.45 seconds
[0m14:56:23.771827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106529f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c7fb90>]}
[0m14:56:23.772337 [debug] [MainThread]: Flushing usage events
[0m14:56:53.173535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106283650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106283d10>]}


============================== 14:56:53.175357 | 6b48850f-b238-4063-a431-0224193fc364 ==============================
[0m14:56:53.175357 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:56:53.175667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:56:53.276431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b48850f-b238-4063-a431-0224193fc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627f750>]}
[0m14:56:53.282829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b48850f-b238-4063-a431-0224193fc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a9cd0>]}
[0m14:56:53.283175 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:56:53.300498 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:56:53.318065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:53.318342 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m14:56:53.327989 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m14:56:53.335569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:56:53.337707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b48850f-b238-4063-a431-0224193fc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a33f50>]}
[0m14:56:53.341921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b48850f-b238-4063-a431-0224193fc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5ca50>]}
[0m14:56:53.342126 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:56:53.342794 [info ] [MainThread]: 
[0m14:56:53.343144 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:56:53.343576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:56:53.349200 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:56:53.349350 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:56:53.349465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:54.032124 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:56:54.036691 [debug] [ThreadPool]: On list_analytics: Close
[0m14:56:54.152644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:56:54.158387 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:56:54.158659 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:56:54.158877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:54.698265 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m14:56:54.702549 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:56:54.815223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b48850f-b238-4063-a431-0224193fc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a79c50>]}
[0m14:56:54.816198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:54.816630 [info ] [MainThread]: 
[0m14:56:54.820646 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:56:54.821170 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:56:54.821859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:56:54.822197 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:56:54.829943 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:56:54.830636 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:56:54.822409 => 14:56:54.830473
[0m14:56:54.830935 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:56:54.850945 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:56:54.853785 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:56:54.854148 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as fdos,
            max(order_placed_at) over(partition by customer_id) as most_recent_order_date,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name,
            --nvl2(fdos = order_placed_at, new, return) as nvsr

        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when paid_orders.fdos = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m14:56:54.854480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:55.213971 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae0a24-0000-2300-0000-58990001249e
[0m14:56:55.214538 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 60 at position 8 unexpected 'from'.
[0m14:56:55.215211 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:56:54.831107 => 14:56:55.214976
[0m14:56:55.215659 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:56:55.337562 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 8 unexpected 'from'.
  compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m14:56:55.337984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b48850f-b238-4063-a431-0224193fc364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa30d0>]}
[0m14:56:55.338431 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.fct_customer_orders .......... [[31mERROR[0m in 0.52s]
[0m14:56:55.338808 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:56:55.339930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:55.340130 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:56:55.340309 [info ] [MainThread]: 
[0m14:56:55.340529 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m14:56:55.340892 [debug] [MainThread]: Command end result
[0m14:56:55.345951 [info ] [MainThread]: 
[0m14:56:55.346191 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:56:55.346377 [info ] [MainThread]: 
[0m14:56:55.346554 [error] [MainThread]: [33mDatabase Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)[0m
[0m14:56:55.346727 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m14:56:55.346891 [error] [MainThread]:   syntax error line 60 at position 8 unexpected 'from'.
[0m14:56:55.347055 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m14:56:55.347217 [info ] [MainThread]: 
[0m14:56:55.347394 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:56:55.347696 [debug] [MainThread]: Command `cli build` failed at 14:56:55.347632 after 2.18 seconds
[0m14:56:55.347903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106288050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10294f310>]}
[0m14:56:55.348089 [debug] [MainThread]: Flushing usage events
[0m14:57:10.155740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112db610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ebf90>]}


============================== 14:57:10.157570 | d017b3c9-ad3b-4349-8deb-8331a762c2e3 ==============================
[0m14:57:10.157570 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:57:10.157900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:57:10.261200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd017b3c9-ad3b-4349-8deb-8331a762c2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c21590>]}
[0m14:57:10.267331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd017b3c9-ad3b-4349-8deb-8331a762c2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11134b350>]}
[0m14:57:10.267611 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:57:10.285253 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:57:10.302838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:57:10.303116 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m14:57:10.312789 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m14:57:10.320453 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:57:10.322587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd017b3c9-ad3b-4349-8deb-8331a762c2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124845d0>]}
[0m14:57:10.326634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd017b3c9-ad3b-4349-8deb-8331a762c2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125687d0>]}
[0m14:57:10.326827 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:57:10.327477 [info ] [MainThread]: 
[0m14:57:10.327832 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:57:10.328315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:57:10.333854 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:57:10.334011 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:57:10.334129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:11.022674 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:57:11.024648 [debug] [ThreadPool]: On list_analytics: Close
[0m14:57:11.137985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:57:11.153770 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:57:11.154320 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:57:11.154697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:11.562160 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m14:57:11.568380 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:57:11.706592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd017b3c9-ad3b-4349-8deb-8331a762c2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c660d0>]}
[0m14:57:11.708577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:11.709433 [info ] [MainThread]: 
[0m14:57:11.716243 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:57:11.717090 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:57:11.718107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:57:11.718571 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:57:11.729476 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:57:11.730596 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:57:11.718853 => 14:57:11.730341
[0m14:57:11.731031 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:57:11.755661 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:57:11.758971 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:57:11.759320 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as fdos,
            max(order_placed_at) over(partition by customer_id) as most_recent_order_date,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name
            --nvl2(fdos = order_placed_at, new, return) as nvsr

        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq,
            case
                when paid_orders.fdos = paid_orders.order_placed_at then 'new' else 'return'
            end as nvsr
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m14:57:11.759663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:12.244547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:57:12.274790 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:57:11.731239 => 14:57:12.274665
[0m14:57:12.275078 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:57:12.375956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd017b3c9-ad3b-4349-8deb-8331a762c2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d39910>]}
[0m14:57:12.377618 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.66s]
[0m14:57:12.378949 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:57:12.381485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:12.381977 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:57:12.382370 [info ] [MainThread]: 
[0m14:57:12.382843 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m14:57:12.383732 [debug] [MainThread]: Command end result
[0m14:57:12.394228 [info ] [MainThread]: 
[0m14:57:12.394938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:12.395243 [info ] [MainThread]: 
[0m14:57:12.395677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:57:12.396069 [debug] [MainThread]: Command `cli build` succeeded at 14:57:12.396012 after 2.25 seconds
[0m14:57:12.396277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105073c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe32d0>]}
[0m14:57:12.396474 [debug] [MainThread]: Flushing usage events
[0m14:58:55.850798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104226850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421ff10>]}


============================== 14:58:55.852632 | 60121d75-a528-470c-b9e8-6ede8d122ae6 ==============================
[0m14:58:55.852632 [info ] [MainThread]: Running with dbt=1.5.4
[0m14:58:55.852954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:58:55.954898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60121d75-a528-470c-b9e8-6ede8d122ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421bad0>]}
[0m14:58:55.961079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60121d75-a528-470c-b9e8-6ede8d122ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104245650>]}
[0m14:58:55.961404 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m14:58:55.979545 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m14:58:55.997038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:58:55.997338 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m14:58:56.006708 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m14:58:56.014363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m14:58:56.016528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60121d75-a528-470c-b9e8-6ede8d122ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dce50>]}
[0m14:58:56.020376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60121d75-a528-470c-b9e8-6ede8d122ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af0810>]}
[0m14:58:56.020574 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:58:56.021225 [info ] [MainThread]: 
[0m14:58:56.021613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:58:56.022187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m14:58:56.028012 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m14:58:56.028174 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m14:58:56.028297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:56.626310 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:58:56.629856 [debug] [ThreadPool]: On list_analytics: Close
[0m14:58:56.743533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m14:58:56.751342 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m14:58:56.751723 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m14:58:56.751995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:57.111064 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m14:58:57.114557 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m14:58:57.229514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60121d75-a528-470c-b9e8-6ede8d122ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050220d0>]}
[0m14:58:57.230760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:57.231227 [info ] [MainThread]: 
[0m14:58:57.235996 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m14:58:57.236668 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m14:58:57.237561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m14:58:57.238014 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m14:58:57.246534 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:58:57.247259 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 14:58:57.238272 => 14:58:57.247096
[0m14:58:57.247578 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m14:58:57.268117 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m14:58:57.270860 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m14:58:57.271184 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports
    base_orders as (select * from raw.jaffle_shop.orders),

    base_payments as (select * from raw.stripe.payment where status <> 'fail'),

    base_customers as (select * from raw.jaffle_shop.customers),

    -- staging

    orders as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over(partition by customer_id) as fdos,
            max(order_placed_at) over(partition by customer_id) as most_recent_order_date,
            count(order_id) over(partition by customer_id) as number_of_orders
        from base_orders
    ),

    payments as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    ),

    customers as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from base_customers
    ),

    -- logical CTES

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            customers.customer_first_name,
            customers.customer_last_name,
            iff(fdos = order_placed_at, 'new', 'return') as nvsr

        from orders
        left join payments on orders.order_id = payments.order_id
        left join customers on orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m14:58:57.271480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:57.764211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:58:57.786446 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 14:58:57.247752 => 14:58:57.786274
[0m14:58:57.786772 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m14:58:57.898463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60121d75-a528-470c-b9e8-6ede8d122ae6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a155d0>]}
[0m14:58:57.899564 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.66s]
[0m14:58:57.900356 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m14:58:57.902757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:57.903291 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m14:58:57.903726 [info ] [MainThread]: 
[0m14:58:57.904147 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m14:58:57.904945 [debug] [MainThread]: Command end result
[0m14:58:57.914244 [info ] [MainThread]: 
[0m14:58:57.914731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:58:57.915046 [info ] [MainThread]: 
[0m14:58:57.915371 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:58:57.915856 [debug] [MainThread]: Command `cli build` succeeded at 14:58:57.915778 after 2.07 seconds
[0m14:58:57.916153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10097bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008eb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008eb2d0>]}
[0m14:58:57.916452 [debug] [MainThread]: Flushing usage events
[0m15:12:05.384484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108056850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805fc50>]}


============================== 15:12:05.386496 | 884659f4-4318-4157-b409-f23f3b6f0aff ==============================
[0m15:12:05.386496 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:12:05.386817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:12:05.488135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '884659f4-4318-4157-b409-f23f3b6f0aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108053890>]}
[0m15:12:05.494328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '884659f4-4318-4157-b409-f23f3b6f0aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807e0d0>]}
[0m15:12:05.494604 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:12:05.511775 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:12:05.529754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:05.529935 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:05.530225 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:12:05.533008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '884659f4-4318-4157-b409-f23f3b6f0aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890d350>]}
[0m15:12:05.537251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '884659f4-4318-4157-b409-f23f3b6f0aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10883ecd0>]}
[0m15:12:05.537445 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:12:05.538096 [info ] [MainThread]: 
[0m15:12:05.538446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:12:05.538935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:12:05.544534 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:12:05.544711 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:12:05.544828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:06.350207 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:12:06.355458 [debug] [ThreadPool]: On list_analytics: Close
[0m15:12:06.483750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:12:06.495212 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:12:06.495717 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:12:06.496059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:06.888952 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m15:12:06.893592 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:12:07.016820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '884659f4-4318-4157-b409-f23f3b6f0aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108808050>]}
[0m15:12:07.017945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:07.018361 [info ] [MainThread]: 
[0m15:12:07.023218 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:07.023774 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ............ [RUN]
[0m15:12:07.024572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__customers)
[0m15:12:07.024925 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:07.031547 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m15:12:07.032282 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (compile): 15:12:07.025135 => 15:12:07.032089
[0m15:12:07.032566 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:07.052540 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m15:12:07.053321 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m15:12:07.053558 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers
  
   as (
    with
    source as (select * from raw.jaffle_shop.customers),

    transform as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from source
    ),

select *
from transform
;
[0m15:12:07.053778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:07.550753 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae0a34-0000-2300-0000-5899000124c6
[0m15:12:07.551024 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 0 unexpected 'select'.
[0m15:12:07.551334 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (execute): 15:12:07.032739 => 15:12:07.551228
[0m15:12:07.551531 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: Close
[0m15:12:07.659978 [debug] [Thread-1 (]: Database Error in model stg_jaffle_shop__customers (models/staging/jaffle_shop/stg_jaffle_shop__customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'select'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_jaffle_shop__customers.sql
[0m15:12:07.660398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '884659f4-4318-4157-b409-f23f3b6f0aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887e510>]}
[0m15:12:07.660881 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ... [[31mERROR[0m in 0.64s]
[0m15:12:07.661310 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:07.662555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:07.662829 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_jaffle_shop__customers' was properly closed.
[0m15:12:07.663080 [info ] [MainThread]: 
[0m15:12:07.663374 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m15:12:07.663830 [debug] [MainThread]: Command end result
[0m15:12:07.670015 [info ] [MainThread]: 
[0m15:12:07.670298 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:12:07.670521 [info ] [MainThread]: 
[0m15:12:07.670739 [error] [MainThread]: [33mDatabase Error in model stg_jaffle_shop__customers (models/staging/jaffle_shop/stg_jaffle_shop__customers.sql)[0m
[0m15:12:07.670951 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m15:12:07.671155 [error] [MainThread]:   syntax error line 15 at position 0 unexpected 'select'.
[0m15:12:07.671352 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_jaffle_shop__customers.sql
[0m15:12:07.671553 [info ] [MainThread]: 
[0m15:12:07.671778 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:12:07.672140 [debug] [MainThread]: Command `cli build` failed at 15:12:07.672076 after 2.30 seconds
[0m15:12:07.672385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108043f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104723390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088089d0>]}
[0m15:12:07.672624 [debug] [MainThread]: Flushing usage events
[0m15:12:12.287583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d66850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d6b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d6b810>]}


============================== 15:12:12.289660 | 6bb7504a-f844-40d2-83ed-9f81f068f054 ==============================
[0m15:12:12.289660 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:12:12.289981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:12:12.392427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bb7504a-f844-40d2-83ed-9f81f068f054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d678d0>]}
[0m15:12:12.398907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bb7504a-f844-40d2-83ed-9f81f068f054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d993d0>]}
[0m15:12:12.399243 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:12:12.417605 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:12:12.436299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:12:12.436595 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/staging/jaffle_shop/stg_jaffle_shop__customers.sql
[0m15:12:12.445987 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_jaffle_shop__customers.sql
[0m15:12:12.453877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:12:12.456103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bb7504a-f844-40d2-83ed-9f81f068f054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11178f2d0>]}
[0m15:12:12.460056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bb7504a-f844-40d2-83ed-9f81f068f054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111776d50>]}
[0m15:12:12.460275 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:12:12.460951 [info ] [MainThread]: 
[0m15:12:12.461293 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:12:12.461738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:12:12.467180 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:12:12.467326 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:12:12.467441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:13.112974 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:12:13.116711 [debug] [ThreadPool]: On list_analytics: Close
[0m15:12:13.242537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:12:13.251691 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:12:13.252079 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:12:13.252368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:13.634305 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m15:12:13.636808 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:12:13.751591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bb7504a-f844-40d2-83ed-9f81f068f054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ae310>]}
[0m15:12:13.752577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:13.753016 [info ] [MainThread]: 
[0m15:12:13.757323 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:13.757870 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ............ [RUN]
[0m15:12:13.758580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__customers)
[0m15:12:13.758915 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:13.765849 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m15:12:13.766583 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (compile): 15:12:13.759128 => 15:12:13.766409
[0m15:12:13.766875 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:13.788004 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m15:12:13.788771 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m15:12:13.789001 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers
  
   as (
    with
    source as (select * from raw.jaffle_shop.customers),

    transform as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from source
    )

select *
from transform
;
[0m15:12:13.789213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:14.208856 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae0a34-0000-22f6-0000-589900015006
[0m15:12:14.209568 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 0 unexpected ';'.
[0m15:12:14.210349 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (execute): 15:12:13.767045 => 15:12:14.210071
[0m15:12:14.210847 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: Close
[0m15:12:14.335332 [debug] [Thread-1 (]: Database Error in model stg_jaffle_shop__customers (models/staging/jaffle_shop/stg_jaffle_shop__customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected ';'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_jaffle_shop__customers.sql
[0m15:12:14.335905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb7504a-f844-40d2-83ed-9f81f068f054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111724ed0>]}
[0m15:12:14.336511 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ... [[31mERROR[0m in 0.58s]
[0m15:12:14.337056 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:14.338548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:14.338834 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_jaffle_shop__customers' was properly closed.
[0m15:12:14.339101 [info ] [MainThread]: 
[0m15:12:14.339396 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m15:12:14.339865 [debug] [MainThread]: Command end result
[0m15:12:14.347141 [info ] [MainThread]: 
[0m15:12:14.347472 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:12:14.347696 [info ] [MainThread]: 
[0m15:12:14.347911 [error] [MainThread]: [33mDatabase Error in model stg_jaffle_shop__customers (models/staging/jaffle_shop/stg_jaffle_shop__customers.sql)[0m
[0m15:12:14.348170 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m15:12:14.348369 [error] [MainThread]:   syntax error line 17 at position 0 unexpected ';'.
[0m15:12:14.348579 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_jaffle_shop__customers.sql
[0m15:12:14.348909 [info ] [MainThread]: 
[0m15:12:14.349193 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:12:14.349582 [debug] [MainThread]: Command `cli build` failed at 15:12:14.349513 after 2.07 seconds
[0m15:12:14.349848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d57f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a133d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111687b10>]}
[0m15:12:14.350108 [debug] [MainThread]: Flushing usage events
[0m15:12:55.900842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d67610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d73a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d73f90>]}


============================== 15:12:55.902639 | f6e6132e-1515-4dc5-9322-b19eaaf43e02 ==============================
[0m15:12:55.902639 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:12:55.902968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:12:56.003984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6e6132e-1515-4dc5-9322-b19eaaf43e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d67950>]}
[0m15:12:56.010241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6e6132e-1515-4dc5-9322-b19eaaf43e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d92fd0>]}
[0m15:12:56.010526 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:12:56.028159 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:12:56.046498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:56.046704 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:56.047040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:12:56.049815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6e6132e-1515-4dc5-9322-b19eaaf43e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d9ed0>]}
[0m15:12:56.054009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6e6132e-1515-4dc5-9322-b19eaaf43e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b2b10>]}
[0m15:12:56.054200 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:12:56.054854 [info ] [MainThread]: 
[0m15:12:56.055197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:12:56.055635 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:12:56.061870 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:12:56.062056 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:12:56.062178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:56.481388 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m15:12:56.484763 [debug] [ThreadPool]: On list_analytics: Close
[0m15:12:56.597631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:12:56.604450 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:12:56.604749 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:12:56.604988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:57.242447 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m15:12:57.245962 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:12:57.362743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6e6132e-1515-4dc5-9322-b19eaaf43e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642f610>]}
[0m15:12:57.363984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:57.364458 [info ] [MainThread]: 
[0m15:12:57.370743 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:57.371416 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ............ [RUN]
[0m15:12:57.372326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__customers)
[0m15:12:57.372732 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:57.380381 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m15:12:57.381098 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (compile): 15:12:57.372993 => 15:12:57.380921
[0m15:12:57.381386 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:57.402126 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m15:12:57.402926 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m15:12:57.403174 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers
  
   as (
    with
    source as (select * from raw.jaffle_shop.customers),

    transform as (
        select
            id as customer_id,
            first_name as customer_first_name,
            last_name as customer_last_name
        from source
    )

select *
from transform
  );
[0m15:12:57.403404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:57.960611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:12:57.983101 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (execute): 15:12:57.381558 => 15:12:57.982942
[0m15:12:57.983432 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: Close
[0m15:12:58.090204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e6132e-1515-4dc5-9322-b19eaaf43e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e26590>]}
[0m15:12:58.091278 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ....... [[32mSUCCESS 1[0m in 0.72s]
[0m15:12:58.092119 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m15:12:58.094235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:58.094637 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_jaffle_shop__customers' was properly closed.
[0m15:12:58.095212 [info ] [MainThread]: 
[0m15:12:58.095778 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m15:12:58.096727 [debug] [MainThread]: Command end result
[0m15:12:58.106106 [info ] [MainThread]: 
[0m15:12:58.106548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:58.106847 [info ] [MainThread]: 
[0m15:12:58.107166 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:12:58.107675 [debug] [MainThread]: Command `cli build` succeeded at 15:12:58.107586 after 2.22 seconds
[0m15:12:58.108018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d69f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bbfad0>]}
[0m15:12:58.108361 [debug] [MainThread]: Flushing usage events
[0m15:13:08.885888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f974d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f97b90>]}


============================== 15:13:08.887672 | e8fb4c40-6620-4d11-8f32-979583639b2a ==============================
[0m15:13:08.887672 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:13:08.887983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:13:08.987499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8fb4c40-6620-4d11-8f32-979583639b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f979d0>]}
[0m15:13:08.993594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8fb4c40-6620-4d11-8f32-979583639b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f979d0>]}
[0m15:13:08.993873 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:13:09.010986 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:13:09.028800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:09.028972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:09.029273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:13:09.032371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8fb4c40-6620-4d11-8f32-979583639b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106872b50>]}
[0m15:13:09.036775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8fb4c40-6620-4d11-8f32-979583639b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ad990>]}
[0m15:13:09.036973 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:13:09.037626 [info ] [MainThread]: 
[0m15:13:09.037976 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:13:09.038455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:13:09.043959 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:13:09.044107 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:13:09.044226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:09.712426 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:13:09.713452 [debug] [ThreadPool]: On list_analytics: Close
[0m15:13:09.816766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:13:09.823411 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:13:09.823717 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:13:09.823946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.339708 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m15:13:10.346159 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:13:10.463633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8fb4c40-6620-4d11-8f32-979583639b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b5810>]}
[0m15:13:10.465110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:10.465695 [info ] [MainThread]: 
[0m15:13:10.473652 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m15:13:10.474364 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders ............... [RUN]
[0m15:13:10.475310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__orders)
[0m15:13:10.475720 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m15:13:10.484041 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m15:13:10.484889 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (compile): 15:13:10.475984 => 15:13:10.484663
[0m15:13:10.485234 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m15:13:10.506651 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m15:13:10.507663 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m15:13:10.507925 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
  
   as (
    with
    source as (select * from raw.jaffle_shop.orders),

    transform as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over (partition by customer_id) as fdos,
            max(order_placed_at) over (
                partition by customer_id
            ) as most_recent_order_date,
            count(order_id) over (partition by customer_id) as number_of_orders
        from source
    )

select *
from transform
  );
[0m15:13:10.508161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:10.986374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:13:11.011629 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (execute): 15:13:10.485436 => 15:13:11.011466
[0m15:13:11.012016 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: Close
[0m15:13:11.136846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fb4c40-6620-4d11-8f32-979583639b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066026d0>]}
[0m15:13:11.137414 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders .......... [[32mSUCCESS 1[0m in 0.66s]
[0m15:13:11.137961 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m15:13:11.139296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:11.139523 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_jaffle_shop__orders' was properly closed.
[0m15:13:11.139757 [info ] [MainThread]: 
[0m15:13:11.140035 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m15:13:11.140582 [debug] [MainThread]: Command end result
[0m15:13:11.146759 [info ] [MainThread]: 
[0m15:13:11.147069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:11.147296 [info ] [MainThread]: 
[0m15:13:11.147535 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:13:11.147988 [debug] [MainThread]: Command `cli build` succeeded at 15:13:11.147925 after 2.27 seconds
[0m15:13:11.148258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026ebc90>]}
[0m15:13:11.148560 [debug] [MainThread]: Flushing usage events
[0m15:13:18.953197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a76850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7b810>]}


============================== 15:13:18.955122 | 992213d0-738f-4b23-b34d-e5db32eac8f5 ==============================
[0m15:13:18.955122 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:13:18.955440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:13:19.056270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '992213d0-738f-4b23-b34d-e5db32eac8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7b650>]}
[0m15:13:19.062429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '992213d0-738f-4b23-b34d-e5db32eac8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e2990>]}
[0m15:13:19.062872 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:13:19.080801 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:13:19.098895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:19.099184 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/staging/stripe/stg_stripe__payments.sql
[0m15:13:19.108883 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_stripe__payments.sql
[0m15:13:19.117065 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:13:19.119496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '992213d0-738f-4b23-b34d-e5db32eac8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925a010>]}
[0m15:13:19.123491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '992213d0-738f-4b23-b34d-e5db32eac8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109348510>]}
[0m15:13:19.123693 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:13:19.124405 [info ] [MainThread]: 
[0m15:13:19.124765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:13:19.125198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:13:19.131205 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:13:19.131407 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:13:19.131544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:19.533412 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m15:13:19.536321 [debug] [ThreadPool]: On list_analytics: Close
[0m15:13:19.649291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:13:19.659836 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:13:19.660322 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:13:19.660656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:20.039663 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m15:13:20.042899 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:13:20.160793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '992213d0-738f-4b23-b34d-e5db32eac8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109853250>]}
[0m15:13:20.162418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:20.163002 [info ] [MainThread]: 
[0m15:13:20.168361 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_stripe__payments
[0m15:13:20.169044 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_stripe__payments .................. [RUN]
[0m15:13:20.169924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_stripe__payments)
[0m15:13:20.170349 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_stripe__payments
[0m15:13:20.179127 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m15:13:20.179956 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (compile): 15:13:20.170611 => 15:13:20.179758
[0m15:13:20.180299 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_stripe__payments
[0m15:13:20.202600 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m15:13:20.203501 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_stripe__payments"
[0m15:13:20.203763 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_stripe__payments"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_stripe__payments
  
   as (
    with
    source as (select * from raw.stripe.payment where status <> 'fail'),

    transform as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from base_payments
        group by order_id, order_status
    )

select *
from transform
  );
[0m15:13:20.204011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:20.730662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae0a35-0000-22f6-0000-589900015016
[0m15:13:20.731284 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_AMOLEIRO.BASE_PAYMENTS' does not exist or not authorized.
[0m15:13:20.731989 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (execute): 15:13:20.180510 => 15:13:20.731758
[0m15:13:20.732377 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: Close
[0m15:13:20.845778 [debug] [Thread-1 (]: Database Error in model stg_stripe__payments (models/staging/stripe/stg_stripe__payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_AMOLEIRO.BASE_PAYMENTS' does not exist or not authorized.
  compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_stripe__payments.sql
[0m15:13:20.846354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '992213d0-738f-4b23-b34d-e5db32eac8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938f0d0>]}
[0m15:13:20.846963 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_stripe__payments ......... [[31mERROR[0m in 0.68s]
[0m15:13:20.847497 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_stripe__payments
[0m15:13:20.849045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:20.849310 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_stripe__payments' was properly closed.
[0m15:13:20.849577 [info ] [MainThread]: 
[0m15:13:20.849907 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m15:13:20.850449 [debug] [MainThread]: Command end result
[0m15:13:20.857645 [info ] [MainThread]: 
[0m15:13:20.858108 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:13:20.858377 [info ] [MainThread]: 
[0m15:13:20.858643 [error] [MainThread]: [33mDatabase Error in model stg_stripe__payments (models/staging/stripe/stg_stripe__payments.sql)[0m
[0m15:13:20.858942 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m15:13:20.859158 [error] [MainThread]:   Object 'ANALYTICS.DBT_AMOLEIRO.BASE_PAYMENTS' does not exist or not authorized.
[0m15:13:20.859362 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_stripe__payments.sql
[0m15:13:20.859568 [info ] [MainThread]: 
[0m15:13:20.859793 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:13:20.860163 [debug] [MainThread]: Command `cli build` failed at 15:13:20.860100 after 1.92 seconds
[0m15:13:20.860414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a87850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5a410>]}
[0m15:13:20.860650 [debug] [MainThread]: Flushing usage events
[0m15:14:03.251806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f84cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f8eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f8f5d0>]}


============================== 15:14:03.253686 | 1f546c5b-11e6-4cde-9b92-ae52958d2b66 ==============================
[0m15:14:03.253686 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:14:03.254011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:14:03.354379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f546c5b-11e6-4cde-9b92-ae52958d2b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa9b50>]}
[0m15:14:03.360719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f546c5b-11e6-4cde-9b92-ae52958d2b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa8910>]}
[0m15:14:03.361019 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:14:03.378202 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:14:03.396543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:03.396845 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/staging/stripe/stg_stripe__payments.sql
[0m15:14:03.406456 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_stripe__payments.sql
[0m15:14:03.414646 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:14:03.416913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f546c5b-11e6-4cde-9b92-ae52958d2b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104613450>]}
[0m15:14:03.420961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f546c5b-11e6-4cde-9b92-ae52958d2b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104865a50>]}
[0m15:14:03.421165 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:14:03.421912 [info ] [MainThread]: 
[0m15:14:03.422290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:03.422732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:14:03.428400 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:14:03.428561 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:14:03.428680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:04.100352 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:14:04.104431 [debug] [ThreadPool]: On list_analytics: Close
[0m15:14:04.228468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:14:04.236030 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:14:04.236383 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:14:04.236659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:04.790170 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m15:14:04.794032 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:14:04.909037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f546c5b-11e6-4cde-9b92-ae52958d2b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d5c10>]}
[0m15:14:04.909970 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:04.910412 [info ] [MainThread]: 
[0m15:14:04.914287 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_stripe__payments
[0m15:14:04.914789 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_stripe__payments .................. [RUN]
[0m15:14:04.915489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_stripe__payments)
[0m15:14:04.915831 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_stripe__payments
[0m15:14:04.922818 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m15:14:04.923643 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (compile): 15:14:04.916042 => 15:14:04.923465
[0m15:14:04.923999 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_stripe__payments
[0m15:14:04.944902 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m15:14:04.945712 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_stripe__payments"
[0m15:14:04.945959 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_stripe__payments"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_stripe__payments
  
   as (
    with
    source as (select * from raw.stripe.payment where status <> 'fail'),

    transform as (
        select
            orderid as order_id,
            status as order_status,
            max(created) payment_finalized_date,
            sum(amount) / 100.0 as total_amount_paid
        from source
        group by order_id, order_status
    )

select *
from transform
  );
[0m15:14:04.946189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:05.403957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:14:05.433899 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (execute): 15:14:04.924210 => 15:14:05.433703
[0m15:14:05.434331 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: Close
[0m15:14:05.545509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f546c5b-11e6-4cde-9b92-ae52958d2b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104824b90>]}
[0m15:14:05.546868 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_stripe__payments ............. [[32mSUCCESS 1[0m in 0.63s]
[0m15:14:05.547874 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_stripe__payments
[0m15:14:05.550245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:05.550614 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_stripe__payments' was properly closed.
[0m15:14:05.550983 [info ] [MainThread]: 
[0m15:14:05.551437 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m15:14:05.552200 [debug] [MainThread]: Command end result
[0m15:14:05.562563 [info ] [MainThread]: 
[0m15:14:05.563027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:05.563327 [info ] [MainThread]: 
[0m15:14:05.563649 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:14:05.564201 [debug] [MainThread]: Command `cli build` succeeded at 15:14:05.564092 after 2.32 seconds
[0m15:14:05.564585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006dfc90>]}
[0m15:14:05.564926 [debug] [MainThread]: Flushing usage events
[0m15:14:13.627906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f76850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6ff90>]}


============================== 15:14:13.629708 | 7ff7c668-4a14-403c-9381-7f0f901d5acd ==============================
[0m15:14:13.629708 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:14:13.630024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:14:13.729822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ff7c668-4a14-403c-9381-7f0f901d5acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f83e10>]}
[0m15:14:13.736075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ff7c668-4a14-403c-9381-7f0f901d5acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11171cb10>]}
[0m15:14:13.736376 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:14:13.753624 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:14:13.771559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:13.771732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:13.772017 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:14:13.775007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ff7c668-4a14-403c-9381-7f0f901d5acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dbb910>]}
[0m15:14:13.779172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ff7c668-4a14-403c-9381-7f0f901d5acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11177e110>]}
[0m15:14:13.779359 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:14:13.780025 [info ] [MainThread]: 
[0m15:14:13.780376 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:13.780887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:14:13.786573 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:14:13.786721 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:14:13.786843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:14.359312 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:14:14.364248 [debug] [ThreadPool]: On list_analytics: Close
[0m15:14:14.487389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:14:14.495850 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:14:14.496212 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:14:14.496485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:14.860507 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m15:14:14.862865 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:14:14.973433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ff7c668-4a14-403c-9381-7f0f901d5acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127ff810>]}
[0m15:14:14.974024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:14.974287 [info ] [MainThread]: 
[0m15:14:14.977303 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_paid_orders
[0m15:14:14.977624 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.int_paid_orders ....................... [RUN]
[0m15:14:14.978109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.int_paid_orders)
[0m15:14:14.978328 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_paid_orders
[0m15:14:14.983159 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:14:14.983756 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (compile): 15:14:14.978460 => 15:14:14.983629
[0m15:14:14.983987 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_paid_orders
[0m15:14:15.000122 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:14:15.001055 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_paid_orders"
[0m15:14:15.001280 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_paid_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_paid_orders
  
   as (
    with

    orders as (
        select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
    ),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments
    ),

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            iff(fdos = order_placed_at, 'new', 'return') as nvsr
        from orders
        left join payments on orders.order_id = payments.order_id
    )

    select * from paid_orders
  );
[0m15:14:15.001483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:15.717011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:14:15.747301 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (execute): 15:14:14.984119 => 15:14:15.747079
[0m15:14:15.747770 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: Close
[0m15:14:15.866597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ff7c668-4a14-403c-9381-7f0f901d5acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127b7650>]}
[0m15:14:15.867804 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.int_paid_orders .................. [[32mSUCCESS 1[0m in 0.89s]
[0m15:14:15.868339 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_paid_orders
[0m15:14:15.869493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:15.869679 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.int_paid_orders' was properly closed.
[0m15:14:15.869866 [info ] [MainThread]: 
[0m15:14:15.870091 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m15:14:15.870521 [debug] [MainThread]: Command end result
[0m15:14:15.876386 [info ] [MainThread]: 
[0m15:14:15.876670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:15.876872 [info ] [MainThread]: 
[0m15:14:15.877082 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:14:15.877417 [debug] [MainThread]: Command `cli build` succeeded at 15:14:15.877365 after 2.26 seconds
[0m15:14:15.877643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105183c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f33d0>]}
[0m15:14:15.877846 [debug] [MainThread]: Flushing usage events
[0m15:17:03.214534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a70cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a70e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6b950>]}


============================== 15:17:03.216363 | 5dc1d2c2-cf28-48f8-b4c0-37b812c3a408 ==============================
[0m15:17:03.216363 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:17:03.216700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:17:03.317595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dc1d2c2-cf28-48f8-b4c0-37b812c3a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a83950>]}
[0m15:17:03.323758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dc1d2c2-cf28-48f8-b4c0-37b812c3a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ef450>]}
[0m15:17:03.324055 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:17:03.341926 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:17:03.360035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:03.360218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:03.360509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:17:03.363271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dc1d2c2-cf28-48f8-b4c0-37b812c3a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c0890>]}
[0m15:17:03.367863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dc1d2c2-cf28-48f8-b4c0-37b812c3a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e97d0>]}
[0m15:17:03.368073 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:17:03.368736 [info ] [MainThread]: 
[0m15:17:03.369087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:17:03.369502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:17:03.375269 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:17:03.375425 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:17:03.375536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:04.219160 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:17:04.223071 [debug] [ThreadPool]: On list_analytics: Close
[0m15:17:04.354995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:17:04.360569 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:17:04.360826 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:17:04.361029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:04.750424 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.0 seconds
[0m15:17:04.751678 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:17:04.858964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dc1d2c2-cf28-48f8-b4c0-37b812c3a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cf0d0>]}
[0m15:17:04.859724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:04.860071 [info ] [MainThread]: 
[0m15:17:04.863681 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m15:17:04.864069 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m15:17:04.864644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m15:17:04.864916 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m15:17:04.870833 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:17:04.871426 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 15:17:04.865083 => 15:17:04.871284
[0m15:17:04.871669 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m15:17:04.890216 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:17:04.891223 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m15:17:04.891477 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with
    paid_orders as (select * from analytics.DBT_AMOLEIRO.int_paid_orders),

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    paid_orders_with_customer_info as (
        select
            paid_orders.*, customers.customer_first_name, customers.customer_last_name
        from paid_orders
        left join customers on paid_orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq
        from paid_orders
        order by order_id
    )

select *
from final
  );
[0m15:17:04.891704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:06.181282 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:17:06.208999 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 15:17:04.871811 => 15:17:06.208816
[0m15:17:06.209444 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m15:17:06.332145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dc1d2c2-cf28-48f8-b4c0-37b812c3a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111426510>]}
[0m15:17:06.334064 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 1.47s]
[0m15:17:06.335774 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m15:17:06.338533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:06.339038 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m15:17:06.339475 [info ] [MainThread]: 
[0m15:17:06.340004 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m15:17:06.340887 [debug] [MainThread]: Command end result
[0m15:17:06.350461 [info ] [MainThread]: 
[0m15:17:06.350871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:06.351162 [info ] [MainThread]: 
[0m15:17:06.351490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:17:06.352020 [debug] [MainThread]: Command `cli build` succeeded at 15:17:06.351926 after 3.15 seconds
[0m15:17:06.352380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110929c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a831d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c3bc90>]}
[0m15:17:06.352752 [debug] [MainThread]: Flushing usage events
[0m15:18:43.324954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10843f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844ba50>]}


============================== 15:18:43.326989 | 8f292c9d-49be-4ada-bd80-b0f1d5e10cad ==============================
[0m15:18:43.326989 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:18:43.327305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:18:43.428460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f292c9d-49be-4ada-bd80-b0f1d5e10cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10843f990>]}
[0m15:18:43.434823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f292c9d-49be-4ada-bd80-b0f1d5e10cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10845ba10>]}
[0m15:18:43.435174 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:18:43.452482 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:18:43.470448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:43.470636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:43.470935 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:18:43.473670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f292c9d-49be-4ada-bd80-b0f1d5e10cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c20f10>]}
[0m15:18:43.477887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f292c9d-49be-4ada-bd80-b0f1d5e10cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf18d0>]}
[0m15:18:43.478093 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:18:43.478827 [info ] [MainThread]: 
[0m15:18:43.479185 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:43.479622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:18:43.485672 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:18:43.485830 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:18:43.485951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:44.184050 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:18:44.186424 [debug] [ThreadPool]: On list_analytics: Close
[0m15:18:44.304287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:18:44.309807 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:18:44.310066 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:18:44.310270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:44.842289 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.0 seconds
[0m15:18:44.846006 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:18:44.971183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f292c9d-49be-4ada-bd80-b0f1d5e10cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7cc50>]}
[0m15:18:44.972158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:44.972594 [info ] [MainThread]: 
[0m15:18:44.977281 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m15:18:44.977752 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m15:18:44.978443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m15:18:44.978759 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m15:18:44.985648 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:18:44.986425 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 15:18:44.978962 => 15:18:44.986220
[0m15:18:44.986741 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m15:18:45.006909 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:18:45.007980 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m15:18:45.008236 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with
    paid_orders as (select * from analytics.DBT_AMOLEIRO.int_paid_orders),

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    paid_orders_with_customer_info as (
        select
            paid_orders.*, customers.customer_first_name, customers.customer_last_name
        from paid_orders
        left join customers on paid_orders.customer_id = customers.customer_id
    ),

    final as (
        select
            paid_orders.*,
            row_number() over (order by paid_orders.order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by paid_orders.order_id
            ) as customer_sales_seq
        from paid_orders_with_customer_info
        order by order_id
    )

select *
from final
  );
[0m15:18:45.008472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:45.445570 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae0a3a-0000-231e-0000-589900014146
[0m15:18:45.445949 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002001 (02000): SQL compilation error:
Object 'PAID_ORDERS' does not exist or not authorized.
[0m15:18:45.446395 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 15:18:44.986928 => 15:18:45.446241
[0m15:18:45.446678 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m15:18:45.556444 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)
  002001 (02000): SQL compilation error:
  Object 'PAID_ORDERS' does not exist or not authorized.
  compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m15:18:45.557084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f292c9d-49be-4ada-bd80-b0f1d5e10cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c28fd0>]}
[0m15:18:45.557713 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.fct_customer_orders .......... [[31mERROR[0m in 0.58s]
[0m15:18:45.558250 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m15:18:45.559814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:45.560132 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m15:18:45.560425 [info ] [MainThread]: 
[0m15:18:45.560784 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m15:18:45.561336 [debug] [MainThread]: Command end result
[0m15:18:45.568966 [info ] [MainThread]: 
[0m15:18:45.569330 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:18:45.569589 [info ] [MainThread]: 
[0m15:18:45.569831 [error] [MainThread]: [33mDatabase Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)[0m
[0m15:18:45.570064 [error] [MainThread]:   002001 (02000): SQL compilation error:
[0m15:18:45.570315 [error] [MainThread]:   Object 'PAID_ORDERS' does not exist or not authorized.
[0m15:18:45.570536 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m15:18:45.570766 [info ] [MainThread]: 
[0m15:18:45.570994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:18:45.571349 [debug] [MainThread]: Command `cli build` failed at 15:18:45.571287 after 2.26 seconds
[0m15:18:45.571606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10842ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108441f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084425d0>]}
[0m15:18:45.571847 [debug] [MainThread]: Flushing usage events
[0m15:19:46.307797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e62850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5ba50>]}


============================== 15:19:46.309618 | 0d7447e5-c1cd-4c61-9856-e2b6a3897dfc ==============================
[0m15:19:46.309618 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:19:46.309936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:19:46.411297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d7447e5-c1cd-4c61-9856-e2b6a3897dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e73e50>]}
[0m15:19:46.417531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d7447e5-c1cd-4c61-9856-e2b6a3897dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e625d0>]}
[0m15:19:46.417831 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:19:46.435415 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:19:46.454176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:46.454368 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:46.454674 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:19:46.457434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d7447e5-c1cd-4c61-9856-e2b6a3897dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4da10>]}
[0m15:19:46.461667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d7447e5-c1cd-4c61-9856-e2b6a3897dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e80290>]}
[0m15:19:46.461864 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:19:46.462503 [info ] [MainThread]: 
[0m15:19:46.462864 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:46.463327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:19:46.469433 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:19:46.469602 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:19:46.469720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:47.138036 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:19:47.141215 [debug] [ThreadPool]: On list_analytics: Close
[0m15:19:47.254198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:19:47.264189 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:19:47.264624 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:19:47.264909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:47.633295 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.0 seconds
[0m15:19:47.634638 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:19:47.764072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d7447e5-c1cd-4c61-9856-e2b6a3897dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5c090>]}
[0m15:19:47.764925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:47.765296 [info ] [MainThread]: 
[0m15:19:47.769853 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m15:19:47.770330 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m15:19:47.770967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m15:19:47.771286 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m15:19:47.777433 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:19:47.778033 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 15:19:47.771466 => 15:19:47.777887
[0m15:19:47.778313 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m15:19:47.797101 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:19:47.798127 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m15:19:47.798363 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with
    paid_orders as (select * from analytics.DBT_AMOLEIRO.int_paid_orders),

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    paid_orders_with_customer_info as (
        select
            paid_orders.*, customers.customer_first_name, customers.customer_last_name
        from paid_orders
        left join customers on paid_orders.customer_id = customers.customer_id
    ),

    final as (
        select
            *,
            row_number() over (order by order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by order_id
            ) as customer_sales_seq
        from paid_orders_with_customer_info
        order by order_id
    )

select *
from final
  );
[0m15:19:47.798577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:48.462335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:19:48.490946 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 15:19:47.778471 => 15:19:48.490740
[0m15:19:48.491375 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m15:19:48.604808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7447e5-c1cd-4c61-9856-e2b6a3897dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602e590>]}
[0m15:19:48.605456 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.83s]
[0m15:19:48.606043 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m15:19:48.607262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:48.607481 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m15:19:48.607696 [info ] [MainThread]: 
[0m15:19:48.607955 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m15:19:48.608437 [debug] [MainThread]: Command end result
[0m15:19:48.614746 [info ] [MainThread]: 
[0m15:19:48.615025 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:48.615227 [info ] [MainThread]: 
[0m15:19:48.615549 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:19:48.615930 [debug] [MainThread]: Command `cli build` succeeded at 15:19:48.615847 after 2.32 seconds
[0m15:19:48.616211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1005b6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100527250>]}
[0m15:19:48.616449 [debug] [MainThread]: Flushing usage events
[0m15:21:36.105576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f77fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f778d0>]}


============================== 15:21:36.107396 | 08a1a399-41e6-4ed2-9de2-c620f92ab80d ==============================
[0m15:21:36.107396 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:21:36.107717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:21:36.209774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08a1a399-41e6-4ed2-9de2-c620f92ab80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f74b90>]}
[0m15:21:36.215893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08a1a399-41e6-4ed2-9de2-c620f92ab80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f80550>]}
[0m15:21:36.216207 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:21:36.233130 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:21:36.251353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:36.251581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:36.251876 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:21:36.254725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08a1a399-41e6-4ed2-9de2-c620f92ab80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112797ad0>]}
[0m15:21:36.258848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08a1a399-41e6-4ed2-9de2-c620f92ab80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a82d90>]}
[0m15:21:36.259038 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:21:36.259695 [info ] [MainThread]: 
[0m15:21:36.260040 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:36.260527 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:21:36.266471 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:21:36.266709 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:21:36.266854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:36.912558 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:21:36.916107 [debug] [ThreadPool]: On list_analytics: Close
[0m15:21:37.055687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:21:37.063715 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:21:37.064068 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:21:37.064339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:37.467548 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.0 seconds
[0m15:21:37.469969 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:21:37.598650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a1a399-41e6-4ed2-9de2-c620f92ab80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ace2d0>]}
[0m15:21:37.599602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:37.600017 [info ] [MainThread]: 
[0m15:21:37.604553 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_paid_orders
[0m15:21:37.605012 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.int_paid_orders ....................... [RUN]
[0m15:21:37.605683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.int_paid_orders)
[0m15:21:37.605992 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_paid_orders
[0m15:21:37.613034 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:21:37.613990 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (compile): 15:21:37.606197 => 15:21:37.613773
[0m15:21:37.614297 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_paid_orders
[0m15:21:37.634161 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:21:37.635471 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_paid_orders"
[0m15:21:37.635735 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_paid_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_paid_orders
  
   as (
    with

    orders as (
        select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
    ),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments
    ),

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            iff(fdos = order_placed_at, 'new', 'return') as nvsr
            row_number() over (order by order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by order_id
            ) as customer_sales_seq
        from orders
        left join payments on orders.order_id = payments.order_id
    )

    select * from paid_orders
  );
[0m15:21:37.635989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:38.184042 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae0a3d-0000-2300-0000-589900012512
[0m15:21:38.185272 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 12 unexpected 'row_number'.
syntax error line 24 at position 23 unexpected ')'.
syntax error line 24 at position 25 unexpected 'over'.
syntax error line 24 at position 48 unexpected ')'.
[0m15:21:38.186803 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (execute): 15:21:37.614463 => 15:21:38.186281
[0m15:21:38.187743 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: Close
[0m15:21:38.315906 [debug] [Thread-1 (]: Database Error in model int_paid_orders (models/marts/intermediate/int_paid_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 12 unexpected 'row_number'.
  syntax error line 24 at position 23 unexpected ')'.
  syntax error line 24 at position 25 unexpected 'over'.
  syntax error line 24 at position 48 unexpected ')'.
  compiled Code at target/run/refactoring_for_modularity/models/marts/intermediate/int_paid_orders.sql
[0m15:21:38.316484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a1a399-41e6-4ed2-9de2-c620f92ab80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270b150>]}
[0m15:21:38.317070 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.int_paid_orders .............. [[31mERROR[0m in 0.71s]
[0m15:21:38.317602 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_paid_orders
[0m15:21:38.319050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:38.319305 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.int_paid_orders' was properly closed.
[0m15:21:38.319562 [info ] [MainThread]: 
[0m15:21:38.319883 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m15:21:38.320460 [debug] [MainThread]: Command end result
[0m15:21:38.327651 [info ] [MainThread]: 
[0m15:21:38.327939 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:21:38.328158 [info ] [MainThread]: 
[0m15:21:38.328378 [error] [MainThread]: [33mDatabase Error in model int_paid_orders (models/marts/intermediate/int_paid_orders.sql)[0m
[0m15:21:38.328585 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m15:21:38.328796 [error] [MainThread]:   syntax error line 24 at position 12 unexpected 'row_number'.
[0m15:21:38.329016 [error] [MainThread]:   syntax error line 24 at position 23 unexpected ')'.
[0m15:21:38.329273 [error] [MainThread]:   syntax error line 24 at position 25 unexpected 'over'.
[0m15:21:38.329467 [error] [MainThread]:   syntax error line 24 at position 48 unexpected ')'.
[0m15:21:38.329660 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/intermediate/int_paid_orders.sql
[0m15:21:38.329864 [info ] [MainThread]: 
[0m15:21:38.330111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:38.330479 [debug] [MainThread]: Command `cli build` failed at 15:21:38.330414 after 2.23 seconds
[0m15:21:38.330752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f74c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a3f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd1810>]}
[0m15:21:38.331020 [debug] [MainThread]: Flushing usage events
[0m15:21:47.125242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c6e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c67410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c67b10>]}


============================== 15:21:47.127063 | d4fb1c8c-4ed1-4297-ba62-26820a1e9bfe ==============================
[0m15:21:47.127063 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:21:47.127387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:21:47.230669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4fb1c8c-4ed1-4297-ba62-26820a1e9bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5cfd0>]}
[0m15:21:47.236903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4fb1c8c-4ed1-4297-ba62-26820a1e9bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021d1dd0>]}
[0m15:21:47.237214 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:21:47.254524 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:21:47.272846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:47.273148 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/intermediate/int_paid_orders.sql
[0m15:21:47.282595 [debug] [MainThread]: 1699: static parser successfully parsed marts/intermediate/int_paid_orders.sql
[0m15:21:47.290455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:21:47.292705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4fb1c8c-4ed1-4297-ba62-26820a1e9bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104402110>]}
[0m15:21:47.296723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4fb1c8c-4ed1-4297-ba62-26820a1e9bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452dd10>]}
[0m15:21:47.296922 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:21:47.297626 [info ] [MainThread]: 
[0m15:21:47.297987 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:47.298513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:21:47.304544 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:21:47.304717 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:21:47.304842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:47.723932 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m15:21:47.727286 [debug] [ThreadPool]: On list_analytics: Close
[0m15:21:47.848374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:21:47.857530 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:21:47.857896 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:21:47.858204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:48.491201 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.0 seconds
[0m15:21:48.495155 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:21:48.610983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4fb1c8c-4ed1-4297-ba62-26820a1e9bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a17d0>]}
[0m15:21:48.611995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:48.612452 [info ] [MainThread]: 
[0m15:21:48.616550 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_paid_orders
[0m15:21:48.617087 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.int_paid_orders ....................... [RUN]
[0m15:21:48.617793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.int_paid_orders)
[0m15:21:48.618125 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_paid_orders
[0m15:21:48.625403 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:21:48.626264 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (compile): 15:21:48.618330 => 15:21:48.626049
[0m15:21:48.626556 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_paid_orders
[0m15:21:48.647526 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:21:48.648626 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_paid_orders"
[0m15:21:48.648917 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_paid_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_paid_orders
  
   as (
    with

    orders as (
        select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
    ),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments
    ),

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            iff(fdos = order_placed_at, 'new', 'return') as nvsr,
            row_number() over (order by order_id) as transaction_seq,
            row_number() over (
                partition by customer_id order by order_id
            ) as customer_sales_seq
        from orders
        left join payments on orders.order_id = payments.order_id
    )

    select * from paid_orders
  );
[0m15:21:48.649191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:49.075527 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ae0a3d-0000-231e-0000-589900014152
[0m15:21:49.076251 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'ORDER_ID'
[0m15:21:49.077131 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (execute): 15:21:48.626728 => 15:21:49.076841
[0m15:21:49.077596 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: Close
[0m15:21:49.202443 [debug] [Thread-1 (]: Database Error in model int_paid_orders (models/marts/intermediate/int_paid_orders.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'ORDER_ID'
  compiled Code at target/run/refactoring_for_modularity/models/marts/intermediate/int_paid_orders.sql
[0m15:21:49.203178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4fb1c8c-4ed1-4297-ba62-26820a1e9bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597a490>]}
[0m15:21:49.203906 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.int_paid_orders .............. [[31mERROR[0m in 0.59s]
[0m15:21:49.204543 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_paid_orders
[0m15:21:49.206402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:49.206793 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.int_paid_orders' was properly closed.
[0m15:21:49.207144 [info ] [MainThread]: 
[0m15:21:49.207567 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m15:21:49.208217 [debug] [MainThread]: Command end result
[0m15:21:49.217087 [info ] [MainThread]: 
[0m15:21:49.217513 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:21:49.217806 [info ] [MainThread]: 
[0m15:21:49.218072 [error] [MainThread]: [33mDatabase Error in model int_paid_orders (models/marts/intermediate/int_paid_orders.sql)[0m
[0m15:21:49.218325 [error] [MainThread]:   002028 (42601): SQL compilation error:
[0m15:21:49.218568 [error] [MainThread]:   ambiguous column name 'ORDER_ID'
[0m15:21:49.218799 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/intermediate/int_paid_orders.sql
[0m15:21:49.219046 [info ] [MainThread]: 
[0m15:21:49.219320 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:49.219771 [debug] [MainThread]: Command `cli build` failed at 15:21:49.219685 after 2.10 seconds
[0m15:21:49.220069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101051350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100333350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1003d5990>]}
[0m15:21:49.220354 [debug] [MainThread]: Flushing usage events
[0m15:23:05.860020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108113610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108123550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108123bd0>]}


============================== 15:23:05.861924 | 6c8d2261-f9af-430e-82e5-2591287342f4 ==============================
[0m15:23:05.861924 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:23:05.862233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:23:05.963936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c8d2261-f9af-430e-82e5-2591287342f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ffb50>]}
[0m15:23:05.969911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c8d2261-f9af-430e-82e5-2591287342f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089083d0>]}
[0m15:23:05.970183 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:23:05.987112 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:23:06.005840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:06.006153 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/intermediate/int_paid_orders.sql
[0m15:23:06.016114 [debug] [MainThread]: 1699: static parser successfully parsed marts/intermediate/int_paid_orders.sql
[0m15:23:06.024224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:23:06.026569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c8d2261-f9af-430e-82e5-2591287342f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c1f10>]}
[0m15:23:06.030755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c8d2261-f9af-430e-82e5-2591287342f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d6110>]}
[0m15:23:06.030982 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:23:06.031698 [info ] [MainThread]: 
[0m15:23:06.032050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:06.032555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:23:06.038477 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:23:06.038642 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:23:06.038764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:06.707607 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:23:06.710935 [debug] [ThreadPool]: On list_analytics: Close
[0m15:23:06.827691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:23:06.836208 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:23:06.836616 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:23:06.836900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:07.221882 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.0 seconds
[0m15:23:07.225745 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:23:07.354361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c8d2261-f9af-430e-82e5-2591287342f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f41650>]}
[0m15:23:07.355608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:07.356098 [info ] [MainThread]: 
[0m15:23:07.361018 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_paid_orders
[0m15:23:07.361733 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.int_paid_orders ....................... [RUN]
[0m15:23:07.362659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.int_paid_orders)
[0m15:23:07.363082 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_paid_orders
[0m15:23:07.371242 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:23:07.372268 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (compile): 15:23:07.363336 => 15:23:07.372026
[0m15:23:07.372588 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_paid_orders
[0m15:23:07.394465 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:23:07.395613 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_paid_orders"
[0m15:23:07.395888 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_paid_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_paid_orders
  
   as (
    with

    orders as (
        select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
    ),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments
    ),

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            iff(orders.fdos = orders.order_placed_at, 'new', 'return') as nvsr,
            row_number() over (order by orders.order_id) as transaction_seq,
            row_number() over (
                partition by orders.customer_id order by orders.order_id
            ) as customer_sales_seq
        from orders
        left join payments on orders.order_id = payments.order_id
    )

    select * from paid_orders
  );
[0m15:23:07.396134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:08.144034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:23:08.158483 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (execute): 15:23:07.372772 => 15:23:08.158368
[0m15:23:08.158722 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: Close
[0m15:23:08.264642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c8d2261-f9af-430e-82e5-2591287342f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e25f890>]}
[0m15:23:08.265328 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.int_paid_orders .................. [[32mSUCCESS 1[0m in 0.90s]
[0m15:23:08.265937 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_paid_orders
[0m15:23:08.267264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:08.267525 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.int_paid_orders' was properly closed.
[0m15:23:08.267759 [info ] [MainThread]: 
[0m15:23:08.268041 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m15:23:08.268548 [debug] [MainThread]: Command end result
[0m15:23:08.274891 [info ] [MainThread]: 
[0m15:23:08.275221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:08.275471 [info ] [MainThread]: 
[0m15:23:08.275738 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:23:08.276140 [debug] [MainThread]: Command `cli build` succeeded at 15:23:08.276050 after 2.43 seconds
[0m15:23:08.276444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108115f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081166d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104873c50>]}
[0m15:23:08.276738 [debug] [MainThread]: Flushing usage events
[0m15:24:20.832764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ff3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104207310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104207a10>]}


============================== 15:24:20.834656 | ac4fd842-21c7-44e8-b5ca-20000cc9adba ==============================
[0m15:24:20.834656 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:24:20.834984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:24:20.936576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac4fd842-21c7-44e8-b5ca-20000cc9adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104203c10>]}
[0m15:24:20.942686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac4fd842-21c7-44e8-b5ca-20000cc9adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454ee90>]}
[0m15:24:20.942997 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:24:20.959961 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:24:20.978767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:24:20.978963 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:24:20.979290 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:24:20.982124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac4fd842-21c7-44e8-b5ca-20000cc9adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3f690>]}
[0m15:24:20.986329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac4fd842-21c7-44e8-b5ca-20000cc9adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042028d0>]}
[0m15:24:20.986534 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:24:20.987198 [info ] [MainThread]: 
[0m15:24:20.987559 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:24:20.988067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:24:20.994598 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:24:20.994770 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:24:20.994894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:21.578601 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:24:21.583148 [debug] [ThreadPool]: On list_analytics: Close
[0m15:24:21.706556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:24:21.718265 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:24:21.718728 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:24:21.719049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:22.281993 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.0 seconds
[0m15:24:22.284037 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:24:22.405414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4fd842-21c7-44e8-b5ca-20000cc9adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ff350>]}
[0m15:24:22.406477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:22.406938 [info ] [MainThread]: 
[0m15:24:22.412215 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m15:24:22.412752 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m15:24:22.413463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m15:24:22.413784 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m15:24:22.420959 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:24:22.421754 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 15:24:22.413992 => 15:24:22.421551
[0m15:24:22.422079 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m15:24:22.442663 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:24:22.443903 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m15:24:22.444185 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with
    paid_orders as (select * from analytics.DBT_AMOLEIRO.int_paid_orders),

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    paid_orders_with_customer_info as (
        select
            paid_orders.*, customers.customer_first_name, customers.customer_last_name
        from paid_orders
        left join customers on paid_orders.customer_id = customers.customer_id
    ),

    final as (
        select
            customer_id,
            order_id,
            order_placed_at,
            order_status,
            total_amount_paid,
            payment_finalized_date,
            customer_first_name,
            customer_last_name,
            transaction_seq,
            customer_sales_seq,
            nvsr,
            customer_lifetime_value,
            fdos
        from paid_orders_with_customer_info
        order by order_id
    )

select *
from final
  );
[0m15:24:22.444434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:22.956304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:24:22.981132 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 15:24:22.422251 => 15:24:22.980947
[0m15:24:22.981524 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m15:24:23.102854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac4fd842-21c7-44e8-b5ca-20000cc9adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a25c90>]}
[0m15:24:23.103988 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.69s]
[0m15:24:23.104782 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m15:24:23.107261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:23.107800 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m15:24:23.108241 [info ] [MainThread]: 
[0m15:24:23.108664 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m15:24:23.109475 [debug] [MainThread]: Command end result
[0m15:24:23.119002 [info ] [MainThread]: 
[0m15:24:23.119542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:23.119890 [info ] [MainThread]: 
[0m15:24:23.120191 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:24:23.120643 [debug] [MainThread]: Command `cli build` succeeded at 15:24:23.120567 after 2.30 seconds
[0m15:24:23.120924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100963c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008d3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008d32d0>]}
[0m15:24:23.121212 [debug] [MainThread]: Flushing usage events
[0m15:25:20.478645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b70cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b70250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6bf50>]}


============================== 15:25:20.480466 | 076bd9ac-d13d-473f-bf1d-96e40529cbec ==============================
[0m15:25:20.480466 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:25:20.480789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:25:20.582130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '076bd9ac-d13d-473f-bf1d-96e40529cbec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b83e90>]}
[0m15:25:20.588290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '076bd9ac-d13d-473f-bf1d-96e40529cbec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108401890>]}
[0m15:25:20.588605 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:25:20.605399 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:25:20.624013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:20.624231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:20.624571 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:25:20.627466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '076bd9ac-d13d-473f-bf1d-96e40529cbec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922f990>]}
[0m15:25:20.631731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '076bd9ac-d13d-473f-bf1d-96e40529cbec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b2b50>]}
[0m15:25:20.631935 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:25:20.632576 [info ] [MainThread]: 
[0m15:25:20.632932 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:20.633448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:25:20.639844 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:25:20.640026 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:25:20.640144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:21.249113 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:25:21.253237 [debug] [ThreadPool]: On list_analytics: Close
[0m15:25:21.371281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:25:21.378173 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:25:21.378493 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:25:21.378728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:21.765641 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.0 seconds
[0m15:25:21.770166 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:25:21.896871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '076bd9ac-d13d-473f-bf1d-96e40529cbec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ed350>]}
[0m15:25:21.898232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:21.898769 [info ] [MainThread]: 
[0m15:25:21.905597 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m15:25:21.906353 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders ............... [RUN]
[0m15:25:21.907328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__orders)
[0m15:25:21.907758 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m15:25:21.915835 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m15:25:21.916650 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (compile): 15:25:21.908028 => 15:25:21.916453
[0m15:25:21.916956 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m15:25:21.937634 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m15:25:21.938673 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m15:25:21.938929 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
  
   as (
    with
    source as (select * from raw.jaffle_shop.orders),

    transform as (
        select
            id as order_id,
            user_id as customer_id,
            order_date as order_placed_at,
            status as order_status,
            min(order_placed_at) over (partition by customer_id) as fdos,
            max(order_placed_at) over (
                partition by customer_id
            ) as most_recent_order_date,
            count(order_id) over (partition by customer_id) as number_of_orders,
            iff(fdos = order_placed_at, 'new', 'return') as nvsr
        from source
    )

select *
from transform
  );
[0m15:25:21.939146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:22.383109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:25:22.405725 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (execute): 15:25:21.917130 => 15:25:22.405546
[0m15:25:22.406071 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: Close
[0m15:25:22.518665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076bd9ac-d13d-473f-bf1d-96e40529cbec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a30a90>]}
[0m15:25:22.519865 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders .......... [[32mSUCCESS 1[0m in 0.61s]
[0m15:25:22.520810 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m15:25:22.523205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:22.523591 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_jaffle_shop__orders' was properly closed.
[0m15:25:22.523976 [info ] [MainThread]: 
[0m15:25:22.524424 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m15:25:22.525311 [debug] [MainThread]: Command end result
[0m15:25:22.536005 [info ] [MainThread]: 
[0m15:25:22.536465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:22.536809 [info ] [MainThread]: 
[0m15:25:22.537127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:25:22.537624 [debug] [MainThread]: Command `cli build` succeeded at 15:25:22.537540 after 2.07 seconds
[0m15:25:22.537944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b83a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b835d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103003b90>]}
[0m15:25:22.538274 [debug] [MainThread]: Flushing usage events
[0m15:25:26.380040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae6090>]}


============================== 15:25:26.381927 | 4f494603-4412-45bb-b173-f5de3b7f1341 ==============================
[0m15:25:26.381927 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:25:26.382243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:25:26.488315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f494603-4412-45bb-b173-f5de3b7f1341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113de550>]}
[0m15:25:26.494533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f494603-4412-45bb-b173-f5de3b7f1341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b33990>]}
[0m15:25:26.494823 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:25:26.512238 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:25:26.530409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:26.530589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:26.530909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:25:26.533900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f494603-4412-45bb-b173-f5de3b7f1341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b8610>]}
[0m15:25:26.538254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f494603-4412-45bb-b173-f5de3b7f1341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ea050>]}
[0m15:25:26.538451 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:25:26.539119 [info ] [MainThread]: 
[0m15:25:26.539489 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:26.540027 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:25:26.545744 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:25:26.545905 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:25:26.546031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:27.112035 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:25:27.115147 [debug] [ThreadPool]: On list_analytics: Close
[0m15:25:27.232152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:25:27.240778 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:25:27.241232 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:25:27.241519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:27.623633 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.0 seconds
[0m15:25:27.627643 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:25:27.739547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f494603-4412-45bb-b173-f5de3b7f1341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111637f50>]}
[0m15:25:27.740536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:27.740962 [info ] [MainThread]: 
[0m15:25:27.746140 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_paid_orders
[0m15:25:27.746672 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.int_paid_orders ....................... [RUN]
[0m15:25:27.747420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.int_paid_orders)
[0m15:25:27.747763 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_paid_orders
[0m15:25:27.754971 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:25:27.755707 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (compile): 15:25:27.747972 => 15:25:27.755509
[0m15:25:27.756016 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_paid_orders
[0m15:25:27.775827 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_paid_orders"
[0m15:25:27.777021 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_paid_orders"
[0m15:25:27.777298 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_paid_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_paid_orders
  
   as (
    with

    orders as (
        select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
    ),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments
    ),

    paid_orders as (
        select
            orders.*,
            payments.total_amount_paid,
            payments.payment_finalized_date,
            sum(total_amount_paid) over (
                partition by orders.customer_id 
                order by orders.order_id asc
                rows between unbounded preceding and current row) as customer_lifetime_value,
            row_number() over (order by orders.order_id) as transaction_seq,
            row_number() over (
                partition by orders.customer_id order by orders.order_id
            ) as customer_sales_seq
        from orders
        left join payments on orders.order_id = payments.order_id
    )

    select * from paid_orders
  );
[0m15:25:27.777535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:28.260893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:25:28.284505 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_paid_orders (execute): 15:25:27.756186 => 15:25:28.284334
[0m15:25:28.284886 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_paid_orders: Close
[0m15:25:28.392777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f494603-4412-45bb-b173-f5de3b7f1341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111497450>]}
[0m15:25:28.393977 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.int_paid_orders .................. [[32mSUCCESS 1[0m in 0.65s]
[0m15:25:28.394938 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_paid_orders
[0m15:25:28.397508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:28.397908 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.int_paid_orders' was properly closed.
[0m15:25:28.398286 [info ] [MainThread]: 
[0m15:25:28.398735 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m15:25:28.399567 [debug] [MainThread]: Command end result
[0m15:25:28.410878 [info ] [MainThread]: 
[0m15:25:28.411354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:28.411667 [info ] [MainThread]: 
[0m15:25:28.411993 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:25:28.412537 [debug] [MainThread]: Command `cli build` succeeded at 15:25:28.412434 after 2.04 seconds
[0m15:25:28.412917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512fc50>]}
[0m15:25:28.413284 [debug] [MainThread]: Flushing usage events
[0m15:25:32.358571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471b810>]}


============================== 15:25:32.360375 | 7496584f-4914-45c0-a733-0aa18507df6c ==============================
[0m15:25:32.360375 [info ] [MainThread]: Running with dbt=1.5.4
[0m15:25:32.360699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:25:32.462337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7496584f-4914-45c0-a733-0aa18507df6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104749c90>]}
[0m15:25:32.468451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7496584f-4914-45c0-a733-0aa18507df6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8e910>]}
[0m15:25:32.468745 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m15:25:32.486776 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m15:25:32.506106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:32.506377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:32.506759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m15:25:32.509960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7496584f-4914-45c0-a733-0aa18507df6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef4090>]}
[0m15:25:32.515444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7496584f-4914-45c0-a733-0aa18507df6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f215d0>]}
[0m15:25:32.515724 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:25:32.516531 [info ] [MainThread]: 
[0m15:25:32.516939 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:32.517740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:25:32.524053 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:25:32.524277 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:25:32.524418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:33.254498 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m15:25:33.256812 [debug] [ThreadPool]: On list_analytics: Close
[0m15:25:33.380238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m15:25:33.389059 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m15:25:33.389460 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m15:25:33.389749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:33.765273 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.0 seconds
[0m15:25:33.768843 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m15:25:33.887267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7496584f-4914-45c0-a733-0aa18507df6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b96350>]}
[0m15:25:33.888698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:33.889301 [info ] [MainThread]: 
[0m15:25:33.894854 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m15:25:33.895426 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m15:25:33.896222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m15:25:33.896565 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m15:25:33.904304 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:25:33.905236 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 15:25:33.896781 => 15:25:33.905051
[0m15:25:33.905524 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m15:25:33.925589 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m15:25:33.926693 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m15:25:33.926950 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with
    paid_orders as (select * from analytics.DBT_AMOLEIRO.int_paid_orders),

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    paid_orders_with_customer_info as (
        select
            paid_orders.*, customers.customer_first_name, customers.customer_last_name
        from paid_orders
        left join customers on paid_orders.customer_id = customers.customer_id
    ),

    final as (
        select
            customer_id,
            order_id,
            order_placed_at,
            order_status,
            total_amount_paid,
            payment_finalized_date,
            customer_first_name,
            customer_last_name,
            transaction_seq,
            customer_sales_seq,
            nvsr,
            customer_lifetime_value,
            fdos
        from paid_orders_with_customer_info
        order by order_id
    )

select *
from final
  );
[0m15:25:33.927190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:34.476139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:25:34.506090 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 15:25:33.905698 => 15:25:34.505880
[0m15:25:34.506513 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m15:25:34.615999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7496584f-4914-45c0-a733-0aa18507df6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f7b010>]}
[0m15:25:34.616700 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.72s]
[0m15:25:34.617330 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m15:25:34.618846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:34.619169 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m15:25:34.619466 [info ] [MainThread]: 
[0m15:25:34.619854 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m15:25:34.620486 [debug] [MainThread]: Command end result
[0m15:25:34.627905 [info ] [MainThread]: 
[0m15:25:34.628248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:34.628472 [info ] [MainThread]: 
[0m15:25:34.628738 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:25:34.629138 [debug] [MainThread]: Command `cli build` succeeded at 15:25:34.629076 after 2.28 seconds
[0m15:25:34.629377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104733250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e77c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100de72d0>]}
[0m15:25:34.629624 [debug] [MainThread]: Flushing usage events
