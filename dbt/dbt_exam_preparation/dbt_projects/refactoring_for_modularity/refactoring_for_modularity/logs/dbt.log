[0m10:43:46.708505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082da850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ea4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ead50>]}


============================== 10:43:46.710250 | eb3ce87d-05a4-43f6-862b-b40e84d894c7 ==============================
[0m10:43:46.710250 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:43:46.710574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:43:46.807270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cbe90>]}
[0m10:43:46.813138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cbe90>]}
[0m10:43:46.813641 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:43:46.822821 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m10:43:46.823187 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:43:46.823395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830c150>]}
[0m10:43:47.054061 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m10:43:47.059520 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m10:43:47.088436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108baf350>]}
[0m10:43:47.091204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba5750>]}
[0m10:43:47.091387 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:43:47.092225 [info ] [MainThread]: 
[0m10:43:47.092550 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:43:47.092961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:43:47.098160 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:43:47.098295 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:43:47.098406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:52.128484 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 5.0 seconds
[0m10:43:52.132451 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:52.266869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:43:52.274424 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:43:52.274763 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:43:52.275034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:52.683736 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m10:43:52.687100 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:43:52.816247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa4710>]}
[0m10:43:52.817041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:52.817402 [info ] [MainThread]: 
[0m10:43:52.834926 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.835327 [info ] [Thread-1 (]: 1 of 6 START sql table model DBT_AMOLEIRO.my_first_dbt_model ................... [RUN]
[0m10:43:52.835835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m10:43:52.836050 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.837949 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.838653 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 10:43:52.836184 => 10:43:52.838526
[0m10:43:52.838866 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.855405 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.856208 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.856413 [debug] [Thread-1 (]: On model.refactoring_for_modularity.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.my_first_dbt_model"} */
create or replace transient table analytics.DBT_AMOLEIRO.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:43:52.856598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:54.363495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:43:54.387779 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 10:43:52.838995 => 10:43:54.387613
[0m10:43:54.388146 [debug] [Thread-1 (]: On model.refactoring_for_modularity.my_first_dbt_model: Close
[0m10:43:54.495099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1d790>]}
[0m10:43:54.496350 [info ] [Thread-1 (]: 1 of 6 OK created sql table model DBT_AMOLEIRO.my_first_dbt_model .............. [[32mSUCCESS 1[0m in 1.66s]
[0m10:43:54.497342 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:54.499040 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.499726 [info ] [Thread-1 (]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m10:43:54.500738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m10:43:54.501180 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.517695 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.518673 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 10:43:54.501457 => 10:43:54.518509
[0m10:43:54.518978 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.561136 [debug] [Thread-1 (]: Writing runtime sql for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.561822 [debug] [Thread-1 (]: Using snowflake connection "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.562021 [debug] [Thread-1 (]: On test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from analytics.DBT_AMOLEIRO.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m10:43:54.562191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:55.182309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:43:55.190074 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 10:43:54.519163 => 10:43:55.189722
[0m10:43:55.190691 [debug] [Thread-1 (]: On test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m10:43:55.304010 [error] [Thread-1 (]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.80s]
[0m10:43:55.304905 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:55.305387 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.305917 [info ] [Thread-1 (]: 3 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m10:43:55.306673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m10:43:55.307061 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.313621 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.314363 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 10:43:55.307274 => 10:43:55.314207
[0m10:43:55.314659 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.316736 [debug] [Thread-1 (]: Writing runtime sql for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.317613 [debug] [Thread-1 (]: Using snowflake connection "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.318057 [debug] [Thread-1 (]: On test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.DBT_AMOLEIRO.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:43:55.318345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:55.813273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:43:55.819700 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 10:43:55.314833 => 10:43:55.819147
[0m10:43:55.820688 [debug] [Thread-1 (]: On test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321: Close
[0m10:43:55.942332 [info ] [Thread-1 (]: 3 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m10:43:55.943338 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.944375 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m10:43:55.944883 [info ] [Thread-1 (]: 4 of 6 SKIP relation DBT_AMOLEIRO.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m10:43:55.945442 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m10:43:55.946135 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m10:43:55.946612 [info ] [Thread-1 (]: 5 of 6 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m10:43:55.947146 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m10:43:55.947562 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m10:43:55.948002 [info ] [Thread-1 (]: 6 of 6 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m10:43:55.948496 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m10:43:55.950116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:55.950438 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m10:43:55.950773 [info ] [MainThread]: 
[0m10:43:55.951095 [info ] [MainThread]: Finished running 1 table model, 4 tests, 1 view model in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m10:43:55.951959 [debug] [MainThread]: Command end result
[0m10:43:55.957904 [info ] [MainThread]: 
[0m10:43:55.958228 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:43:55.958485 [info ] [MainThread]: 
[0m10:43:55.958744 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m10:43:55.958995 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:43:55.959235 [info ] [MainThread]: 
[0m10:43:55.959571 [info ] [MainThread]:   compiled Code at target/compiled/refactoring_for_modularity/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m10:43:55.959918 [info ] [MainThread]: 
[0m10:43:55.960229 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m10:43:55.960688 [debug] [MainThread]: Command `dbt build` failed at 10:43:55.960610 after 9.26 seconds
[0m10:43:55.961008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47410>]}
[0m10:43:55.961322 [debug] [MainThread]: Flushing usage events
[0m10:45:30.307075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c6610>]}


============================== 10:45:30.308923 | f0ecf51d-2f3b-461c-9cba-6b4dfe7a32ad ==============================
[0m10:45:30.308923 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:45:30.309256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:45:30.319092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0ecf51d-2f3b-461c-9cba-6b4dfe7a32ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81190>]}
[0m10:45:30.319418 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:45:30.319707 [debug] [MainThread]: Command `dbt deps` succeeded at 10:45:30.319653 after 0.02 seconds
[0m10:45:30.319865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472c250>]}
[0m10:45:30.320017 [debug] [MainThread]: Flushing usage events
[0m10:46:07.336083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104592850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a2410>]}


============================== 10:46:07.337909 | 9f66b2fe-399d-4e1f-a364-9900ba67afbc ==============================
[0m10:46:07.337909 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:46:07.338243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:46:07.348153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045adc90>]}
[0m10:46:07.349059 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-7lefbxz_'
[0m10:46:07.349260 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:46:07.640042 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:46:07.643236 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m10:46:07.842295 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m10:46:07.848063 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:46:08.022935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:46:08.040161 [info ] [MainThread]: Installing dbt-labs/codegen
[0m10:46:08.433565 [info ] [MainThread]: Installed from version 0.10.0
[0m10:46:08.433977 [info ] [MainThread]: Up to date!
[0m10:46:08.434345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104593d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e0b10>]}
[0m10:46:08.434682 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:46:08.936254 [info ] [MainThread]: Installed from version 1.1.1
[0m10:46:08.936521 [info ] [MainThread]: Up to date!
[0m10:46:08.936840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408fe50>]}
[0m10:46:08.937467 [debug] [MainThread]: Command `dbt deps` succeeded at 10:46:08.937400 after 1.61 seconds
[0m10:46:08.937662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b27510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cff410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd4990>]}
[0m10:46:08.937838 [debug] [MainThread]: Flushing usage events
[0m11:41:10.530851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424ba10>]}


============================== 11:41:10.532657 | a1f2e0ca-3429-4fc4-b5df-7122b371555e ==============================
[0m11:41:10.532657 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:41:10.532966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:41:10.637878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104231bd0>]}
[0m11:41:10.643886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104231bd0>]}
[0m11:41:10.644157 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:41:10.659574 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:41:10.678196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:10.678449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:10.681655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ae750>]}
[0m11:41:10.682974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b22010>]}
[0m11:41:10.683188 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:41:10.683365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fc0f50>]}
[0m11:41:10.684217 [info ] [MainThread]: 
[0m11:41:10.684618 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:10.685099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m11:41:10.691212 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:41:10.691406 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:41:10.691536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:13.553502 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 3.0 seconds
[0m11:41:13.557984 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:41:13.673037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f75410>]}
[0m11:41:13.673989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:13.674431 [info ] [MainThread]: 
[0m11:41:13.679436 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.680168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m11:41:13.680514 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.683921 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m11:41:13.684821 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 11:41:13.680728 => 11:41:13.684655
[0m11:41:13.685092 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.685403 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 11:41:13.685264 => 11:41:13.685279
[0m11:41:13.686072 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.686662 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.687235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now model.refactoring_for_modularity.my_second_dbt_model)
[0m11:41:13.687523 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.689866 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_second_dbt_model"
[0m11:41:13.690453 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (compile): 11:41:13.687703 => 11:41:13.690309
[0m11:41:13.690676 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.690935 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (execute): 11:41:13.690821 => 11:41:13.690827
[0m11:41:13.691471 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.691721 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.692188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_second_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:41:13.692400 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.701298 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:41:13.701819 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 11:41:13.692538 => 11:41:13.701699
[0m11:41:13.702033 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.702276 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 11:41:13.702166 => 11:41:13.702173
[0m11:41:13.702776 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.703003 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.703372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m11:41:13.703571 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.707436 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m11:41:13.707840 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 11:41:13.703698 => 11:41:13.707728
[0m11:41:13.708025 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.708241 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 11:41:13.708146 => 11:41:13.708151
[0m11:41:13.708673 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.708882 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.709211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321, now test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778)
[0m11:41:13.709403 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.711799 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778"
[0m11:41:13.712186 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:41:13.709522 => 11:41:13.712083
[0m11:41:13.712368 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.712577 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:41:13.712486 => 11:41:13.712490
[0m11:41:13.712998 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.713197 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.713556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778, now test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:41:13.713733 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.715980 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:41:13.716368 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:41:13.713864 => 11:41:13.716268
[0m11:41:13.716534 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.716727 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:41:13.716643 => 11:41:13.716646
[0m11:41:13.717125 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.717576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:13.717713 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:41:13.718266 [debug] [MainThread]: Command end result
[0m11:41:13.724482 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:41:13.724636 [info ] [MainThread]: Building catalog
[0m11:41:13.725250 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m11:41:13.729027 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m11:41:13.729307 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m11:41:13.729562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:16.178081 [debug] [ThreadPool]: SQL status: SUCCESS 83 in 2.0 seconds
[0m11:41:16.195433 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m11:41:16.337707 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/target/catalog.json
[0m11:41:16.338629 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:41:16.338529 after 5.82 seconds
[0m11:41:16.338904 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:41:16.339108 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m11:41:16.339386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fc1190>]}
[0m11:41:16.339682 [debug] [MainThread]: Flushing usage events
[0m11:45:04.231409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11186a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11187a250>]}


============================== 11:45:04.233187 | 2b78b227-a0c5-47b8-abfe-3e9ef68187b0 ==============================
[0m11:45:04.233187 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:45:04.233489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:45:04.332302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b78b227-a0c5-47b8-abfe-3e9ef68187b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120de010>]}
[0m11:45:04.338082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b78b227-a0c5-47b8-abfe-3e9ef68187b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118caa90>]}
[0m11:46:35.608693 [error] [MainThread]: Encountered an error:

[0m11:46:35.613811 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:46:35.615840 [debug] [MainThread]: Command `dbt docs serve` failed at 11:46:35.615549 after 91.39 seconds
[0m11:46:35.616532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111861850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11186a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112191f90>]}
[0m11:46:35.617149 [debug] [MainThread]: Flushing usage events
[0m11:46:40.911313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b43110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b43990>]}


============================== 11:46:40.913053 | 5941d7f4-5be9-4dbe-970b-b5eb285619bf ==============================
[0m11:46:40.913053 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:46:40.913381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:41.012346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b349d0>]}
[0m11:46:41.018208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109330910>]}
[0m11:46:41.018468 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:46:41.032635 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:46:41.051041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:41.051211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:41.053862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109308ad0>]}
[0m11:46:41.054666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094298d0>]}
[0m11:46:41.054838 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:46:41.055026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c4f50>]}
[0m11:46:41.055853 [info ] [MainThread]: 
[0m11:46:41.056213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:41.056678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m11:46:41.062584 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:46:41.062782 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:46:41.062923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:41.741005 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m11:46:41.743168 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:46:41.855162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0e90>]}
[0m11:46:41.856245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:41.856691 [info ] [MainThread]: 
[0m11:46:41.862650 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.863531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m11:46:41.863974 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.867107 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m11:46:41.867982 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 11:46:41.864200 => 11:46:41.867780
[0m11:46:41.868316 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.868693 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 11:46:41.868522 => 11:46:41.868536
[0m11:46:41.869502 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.870264 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.870902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now model.refactoring_for_modularity.my_second_dbt_model)
[0m11:46:41.871187 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.873464 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_second_dbt_model"
[0m11:46:41.874085 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (compile): 11:46:41.871367 => 11:46:41.873938
[0m11:46:41.874338 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.874639 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (execute): 11:46:41.874503 => 11:46:41.874511
[0m11:46:41.875277 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.875585 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.876119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_second_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:46:41.876361 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.884909 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:46:41.885391 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 11:46:41.876524 => 11:46:41.885273
[0m11:46:41.885595 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.885843 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 11:46:41.885731 => 11:46:41.885737
[0m11:46:41.886318 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.886538 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.886898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m11:46:41.887086 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.891162 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m11:46:41.891573 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 11:46:41.887212 => 11:46:41.891452
[0m11:46:41.891776 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.892021 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 11:46:41.891909 => 11:46:41.891915
[0m11:46:41.892486 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.892703 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.893025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321, now test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778)
[0m11:46:41.893199 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.896465 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778"
[0m11:46:41.897036 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:46:41.893314 => 11:46:41.896924
[0m11:46:41.897220 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.897426 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:46:41.897336 => 11:46:41.897340
[0m11:46:41.897848 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.898065 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.898385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778, now test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:46:41.898565 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.900727 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:46:41.901093 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:46:41.898682 => 11:46:41.900990
[0m11:46:41.901262 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.901456 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:46:41.901371 => 11:46:41.901374
[0m11:46:41.901843 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.902276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:41.902424 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:46:41.902974 [debug] [MainThread]: Command end result
[0m11:46:41.907888 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:46:41.908029 [info ] [MainThread]: Building catalog
[0m11:46:41.908624 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m11:46:41.912367 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m11:46:41.912622 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m11:46:41.912831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:43.793945 [debug] [ThreadPool]: SQL status: SUCCESS 83 in 2.0 seconds
[0m11:46:43.810483 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m11:46:43.971280 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/target/catalog.json
[0m11:46:43.972081 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:46:43.971997 after 3.07 seconds
[0m11:46:43.972323 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:46:43.972494 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m11:46:43.972735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30fe50>]}
[0m11:46:43.973007 [debug] [MainThread]: Flushing usage events
[0m11:46:55.096091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104789a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478b010>]}


============================== 11:46:55.097882 | 35ac56aa-3b18-4e2c-9047-7e637ecaee3e ==============================
[0m11:46:55.097882 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:46:55.098203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:55.196285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35ac56aa-3b18-4e2c-9047-7e637ecaee3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476e750>]}
[0m11:46:55.202077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35ac56aa-3b18-4e2c-9047-7e637ecaee3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f48290>]}
