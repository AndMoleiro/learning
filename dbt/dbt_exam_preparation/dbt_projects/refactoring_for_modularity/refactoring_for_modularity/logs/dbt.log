[0m10:43:46.708505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082da850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ea4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ead50>]}


============================== 10:43:46.710250 | eb3ce87d-05a4-43f6-862b-b40e84d894c7 ==============================
[0m10:43:46.710250 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:43:46.710574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:43:46.807270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cbe90>]}
[0m10:43:46.813138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cbe90>]}
[0m10:43:46.813641 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:43:46.822821 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m10:43:46.823187 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:43:46.823395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830c150>]}
[0m10:43:47.054061 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m10:43:47.059520 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m10:43:47.088436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108baf350>]}
[0m10:43:47.091204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba5750>]}
[0m10:43:47.091387 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:43:47.092225 [info ] [MainThread]: 
[0m10:43:47.092550 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:43:47.092961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:43:47.098160 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:43:47.098295 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:43:47.098406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:52.128484 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 5.0 seconds
[0m10:43:52.132451 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:52.266869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:43:52.274424 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:43:52.274763 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:43:52.275034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:52.683736 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m10:43:52.687100 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:43:52.816247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa4710>]}
[0m10:43:52.817041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:52.817402 [info ] [MainThread]: 
[0m10:43:52.834926 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.835327 [info ] [Thread-1 (]: 1 of 6 START sql table model DBT_AMOLEIRO.my_first_dbt_model ................... [RUN]
[0m10:43:52.835835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m10:43:52.836050 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.837949 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.838653 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 10:43:52.836184 => 10:43:52.838526
[0m10:43:52.838866 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.855405 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.856208 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.856413 [debug] [Thread-1 (]: On model.refactoring_for_modularity.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.my_first_dbt_model"} */
create or replace transient table analytics.DBT_AMOLEIRO.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:43:52.856598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:54.363495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:43:54.387779 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 10:43:52.838995 => 10:43:54.387613
[0m10:43:54.388146 [debug] [Thread-1 (]: On model.refactoring_for_modularity.my_first_dbt_model: Close
[0m10:43:54.495099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1d790>]}
[0m10:43:54.496350 [info ] [Thread-1 (]: 1 of 6 OK created sql table model DBT_AMOLEIRO.my_first_dbt_model .............. [[32mSUCCESS 1[0m in 1.66s]
[0m10:43:54.497342 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:54.499040 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.499726 [info ] [Thread-1 (]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m10:43:54.500738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m10:43:54.501180 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.517695 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.518673 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 10:43:54.501457 => 10:43:54.518509
[0m10:43:54.518978 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.561136 [debug] [Thread-1 (]: Writing runtime sql for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.561822 [debug] [Thread-1 (]: Using snowflake connection "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.562021 [debug] [Thread-1 (]: On test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from analytics.DBT_AMOLEIRO.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m10:43:54.562191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:55.182309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:43:55.190074 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 10:43:54.519163 => 10:43:55.189722
[0m10:43:55.190691 [debug] [Thread-1 (]: On test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m10:43:55.304010 [error] [Thread-1 (]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.80s]
[0m10:43:55.304905 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:55.305387 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.305917 [info ] [Thread-1 (]: 3 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m10:43:55.306673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m10:43:55.307061 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.313621 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.314363 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 10:43:55.307274 => 10:43:55.314207
[0m10:43:55.314659 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.316736 [debug] [Thread-1 (]: Writing runtime sql for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.317613 [debug] [Thread-1 (]: Using snowflake connection "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.318057 [debug] [Thread-1 (]: On test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.DBT_AMOLEIRO.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:43:55.318345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:55.813273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:43:55.819700 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 10:43:55.314833 => 10:43:55.819147
[0m10:43:55.820688 [debug] [Thread-1 (]: On test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321: Close
[0m10:43:55.942332 [info ] [Thread-1 (]: 3 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m10:43:55.943338 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.944375 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m10:43:55.944883 [info ] [Thread-1 (]: 4 of 6 SKIP relation DBT_AMOLEIRO.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m10:43:55.945442 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m10:43:55.946135 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m10:43:55.946612 [info ] [Thread-1 (]: 5 of 6 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m10:43:55.947146 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m10:43:55.947562 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m10:43:55.948002 [info ] [Thread-1 (]: 6 of 6 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m10:43:55.948496 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m10:43:55.950116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:55.950438 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m10:43:55.950773 [info ] [MainThread]: 
[0m10:43:55.951095 [info ] [MainThread]: Finished running 1 table model, 4 tests, 1 view model in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m10:43:55.951959 [debug] [MainThread]: Command end result
[0m10:43:55.957904 [info ] [MainThread]: 
[0m10:43:55.958228 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:43:55.958485 [info ] [MainThread]: 
[0m10:43:55.958744 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m10:43:55.958995 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:43:55.959235 [info ] [MainThread]: 
[0m10:43:55.959571 [info ] [MainThread]:   compiled Code at target/compiled/refactoring_for_modularity/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m10:43:55.959918 [info ] [MainThread]: 
[0m10:43:55.960229 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m10:43:55.960688 [debug] [MainThread]: Command `dbt build` failed at 10:43:55.960610 after 9.26 seconds
[0m10:43:55.961008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47410>]}
[0m10:43:55.961322 [debug] [MainThread]: Flushing usage events
[0m10:45:30.307075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c6610>]}


============================== 10:45:30.308923 | f0ecf51d-2f3b-461c-9cba-6b4dfe7a32ad ==============================
[0m10:45:30.308923 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:45:30.309256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:45:30.319092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0ecf51d-2f3b-461c-9cba-6b4dfe7a32ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81190>]}
[0m10:45:30.319418 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:45:30.319707 [debug] [MainThread]: Command `dbt deps` succeeded at 10:45:30.319653 after 0.02 seconds
[0m10:45:30.319865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472c250>]}
[0m10:45:30.320017 [debug] [MainThread]: Flushing usage events
[0m10:46:07.336083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104592850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a2410>]}


============================== 10:46:07.337909 | 9f66b2fe-399d-4e1f-a364-9900ba67afbc ==============================
[0m10:46:07.337909 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:46:07.338243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:46:07.348153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045adc90>]}
[0m10:46:07.349059 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-7lefbxz_'
[0m10:46:07.349260 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:46:07.640042 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:46:07.643236 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m10:46:07.842295 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m10:46:07.848063 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:46:08.022935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:46:08.040161 [info ] [MainThread]: Installing dbt-labs/codegen
[0m10:46:08.433565 [info ] [MainThread]: Installed from version 0.10.0
[0m10:46:08.433977 [info ] [MainThread]: Up to date!
[0m10:46:08.434345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104593d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e0b10>]}
[0m10:46:08.434682 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:46:08.936254 [info ] [MainThread]: Installed from version 1.1.1
[0m10:46:08.936521 [info ] [MainThread]: Up to date!
[0m10:46:08.936840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408fe50>]}
[0m10:46:08.937467 [debug] [MainThread]: Command `dbt deps` succeeded at 10:46:08.937400 after 1.61 seconds
[0m10:46:08.937662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b27510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cff410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd4990>]}
[0m10:46:08.937838 [debug] [MainThread]: Flushing usage events
[0m11:41:10.530851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424ba10>]}


============================== 11:41:10.532657 | a1f2e0ca-3429-4fc4-b5df-7122b371555e ==============================
[0m11:41:10.532657 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:41:10.532966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:41:10.637878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104231bd0>]}
[0m11:41:10.643886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104231bd0>]}
[0m11:41:10.644157 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:41:10.659574 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:41:10.678196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:10.678449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:10.681655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ae750>]}
[0m11:41:10.682974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b22010>]}
[0m11:41:10.683188 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:41:10.683365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fc0f50>]}
[0m11:41:10.684217 [info ] [MainThread]: 
[0m11:41:10.684618 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:10.685099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m11:41:10.691212 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:41:10.691406 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:41:10.691536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:13.553502 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 3.0 seconds
[0m11:41:13.557984 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:41:13.673037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f75410>]}
[0m11:41:13.673989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:13.674431 [info ] [MainThread]: 
[0m11:41:13.679436 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.680168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m11:41:13.680514 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.683921 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m11:41:13.684821 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 11:41:13.680728 => 11:41:13.684655
[0m11:41:13.685092 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.685403 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 11:41:13.685264 => 11:41:13.685279
[0m11:41:13.686072 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.686662 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.687235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now model.refactoring_for_modularity.my_second_dbt_model)
[0m11:41:13.687523 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.689866 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_second_dbt_model"
[0m11:41:13.690453 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (compile): 11:41:13.687703 => 11:41:13.690309
[0m11:41:13.690676 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.690935 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (execute): 11:41:13.690821 => 11:41:13.690827
[0m11:41:13.691471 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.691721 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.692188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_second_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:41:13.692400 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.701298 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:41:13.701819 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 11:41:13.692538 => 11:41:13.701699
[0m11:41:13.702033 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.702276 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 11:41:13.702166 => 11:41:13.702173
[0m11:41:13.702776 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.703003 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.703372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m11:41:13.703571 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.707436 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m11:41:13.707840 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 11:41:13.703698 => 11:41:13.707728
[0m11:41:13.708025 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.708241 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 11:41:13.708146 => 11:41:13.708151
[0m11:41:13.708673 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.708882 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.709211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321, now test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778)
[0m11:41:13.709403 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.711799 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778"
[0m11:41:13.712186 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:41:13.709522 => 11:41:13.712083
[0m11:41:13.712368 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.712577 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:41:13.712486 => 11:41:13.712490
[0m11:41:13.712998 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.713197 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.713556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778, now test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:41:13.713733 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.715980 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:41:13.716368 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:41:13.713864 => 11:41:13.716268
[0m11:41:13.716534 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.716727 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:41:13.716643 => 11:41:13.716646
[0m11:41:13.717125 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.717576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:13.717713 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:41:13.718266 [debug] [MainThread]: Command end result
[0m11:41:13.724482 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:41:13.724636 [info ] [MainThread]: Building catalog
[0m11:41:13.725250 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m11:41:13.729027 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m11:41:13.729307 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m11:41:13.729562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:16.178081 [debug] [ThreadPool]: SQL status: SUCCESS 83 in 2.0 seconds
[0m11:41:16.195433 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m11:41:16.337707 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/target/catalog.json
[0m11:41:16.338629 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:41:16.338529 after 5.82 seconds
[0m11:41:16.338904 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:41:16.339108 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m11:41:16.339386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fc1190>]}
[0m11:41:16.339682 [debug] [MainThread]: Flushing usage events
[0m11:45:04.231409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11186a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11187a250>]}


============================== 11:45:04.233187 | 2b78b227-a0c5-47b8-abfe-3e9ef68187b0 ==============================
[0m11:45:04.233187 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:45:04.233489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:45:04.332302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b78b227-a0c5-47b8-abfe-3e9ef68187b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120de010>]}
[0m11:45:04.338082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b78b227-a0c5-47b8-abfe-3e9ef68187b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118caa90>]}
[0m11:46:35.608693 [error] [MainThread]: Encountered an error:

[0m11:46:35.613811 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:46:35.615840 [debug] [MainThread]: Command `dbt docs serve` failed at 11:46:35.615549 after 91.39 seconds
[0m11:46:35.616532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111861850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11186a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112191f90>]}
[0m11:46:35.617149 [debug] [MainThread]: Flushing usage events
[0m11:46:40.911313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b43110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b43990>]}


============================== 11:46:40.913053 | 5941d7f4-5be9-4dbe-970b-b5eb285619bf ==============================
[0m11:46:40.913053 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:46:40.913381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:41.012346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b349d0>]}
[0m11:46:41.018208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109330910>]}
[0m11:46:41.018468 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:46:41.032635 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:46:41.051041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:41.051211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:41.053862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109308ad0>]}
[0m11:46:41.054666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094298d0>]}
[0m11:46:41.054838 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:46:41.055026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c4f50>]}
[0m11:46:41.055853 [info ] [MainThread]: 
[0m11:46:41.056213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:41.056678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m11:46:41.062584 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:46:41.062782 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:46:41.062923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:41.741005 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m11:46:41.743168 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:46:41.855162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0e90>]}
[0m11:46:41.856245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:41.856691 [info ] [MainThread]: 
[0m11:46:41.862650 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.863531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m11:46:41.863974 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.867107 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m11:46:41.867982 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 11:46:41.864200 => 11:46:41.867780
[0m11:46:41.868316 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.868693 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 11:46:41.868522 => 11:46:41.868536
[0m11:46:41.869502 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.870264 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.870902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now model.refactoring_for_modularity.my_second_dbt_model)
[0m11:46:41.871187 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.873464 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_second_dbt_model"
[0m11:46:41.874085 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (compile): 11:46:41.871367 => 11:46:41.873938
[0m11:46:41.874338 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.874639 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (execute): 11:46:41.874503 => 11:46:41.874511
[0m11:46:41.875277 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.875585 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.876119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_second_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:46:41.876361 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.884909 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:46:41.885391 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 11:46:41.876524 => 11:46:41.885273
[0m11:46:41.885595 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.885843 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 11:46:41.885731 => 11:46:41.885737
[0m11:46:41.886318 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.886538 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.886898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m11:46:41.887086 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.891162 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m11:46:41.891573 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 11:46:41.887212 => 11:46:41.891452
[0m11:46:41.891776 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.892021 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 11:46:41.891909 => 11:46:41.891915
[0m11:46:41.892486 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.892703 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.893025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321, now test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778)
[0m11:46:41.893199 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.896465 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778"
[0m11:46:41.897036 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:46:41.893314 => 11:46:41.896924
[0m11:46:41.897220 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.897426 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:46:41.897336 => 11:46:41.897340
[0m11:46:41.897848 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.898065 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.898385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778, now test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:46:41.898565 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.900727 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:46:41.901093 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:46:41.898682 => 11:46:41.900990
[0m11:46:41.901262 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.901456 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:46:41.901371 => 11:46:41.901374
[0m11:46:41.901843 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.902276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:41.902424 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:46:41.902974 [debug] [MainThread]: Command end result
[0m11:46:41.907888 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:46:41.908029 [info ] [MainThread]: Building catalog
[0m11:46:41.908624 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m11:46:41.912367 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m11:46:41.912622 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m11:46:41.912831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:43.793945 [debug] [ThreadPool]: SQL status: SUCCESS 83 in 2.0 seconds
[0m11:46:43.810483 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m11:46:43.971280 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/target/catalog.json
[0m11:46:43.972081 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:46:43.971997 after 3.07 seconds
[0m11:46:43.972323 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:46:43.972494 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m11:46:43.972735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30fe50>]}
[0m11:46:43.973007 [debug] [MainThread]: Flushing usage events
[0m11:46:55.096091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104789a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478b010>]}


============================== 11:46:55.097882 | 35ac56aa-3b18-4e2c-9047-7e637ecaee3e ==============================
[0m11:46:55.097882 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:46:55.098203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:55.196285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35ac56aa-3b18-4e2c-9047-7e637ecaee3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476e750>]}
[0m11:46:55.202077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35ac56aa-3b18-4e2c-9047-7e637ecaee3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f48290>]}
[0m11:55:43.876526 [error] [MainThread]: Encountered an error:

[0m11:55:43.883093 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:55:43.884623 [debug] [MainThread]: Command `dbt docs serve` failed at 11:55:43.884444 after 528.79 seconds
[0m11:55:43.885104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f14fd0>]}
[0m11:55:43.885546 [debug] [MainThread]: Flushing usage events
[0m11:56:46.564885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104133810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104142d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041433d0>]}


============================== 11:56:46.566735 | 8739d017-c4bb-4add-977f-2df74978bf0a ==============================
[0m11:56:46.566735 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:56:46.567026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:56:46.672153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414f8d0>]}
[0m11:56:46.678200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104159310>]}
[0m11:56:46.678470 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:56:46.692911 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:56:46.708765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:46.708925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:46.709143 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m11:56:46.711734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5ae90>]}
[0m11:56:46.715744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104988a10>]}
[0m11:56:46.716048 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:56:46.716236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ead0d0>]}
[0m11:56:46.716798 [info ] [MainThread]: 
[0m11:56:46.717162 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:46.717618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m11:56:46.723821 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m11:56:46.724007 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m11:56:46.724126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:47.622688 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:56:47.625500 [debug] [ThreadPool]: On list_analytics: Close
[0m11:56:47.748733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m11:56:47.757901 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:56:47.758308 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:56:47.758594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:48.450691 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m11:56:48.454999 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:56:48.639961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc6e50>]}
[0m11:56:48.641182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:48.641665 [info ] [MainThread]: 
[0m11:56:48.647980 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m11:56:48.648633 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.customer_orders ....................... [RUN]
[0m11:56:48.649522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m11:56:48.649925 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m11:56:48.651890 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m11:56:48.652781 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 11:56:48.650155 => 11:56:48.652483
[0m11:56:48.653203 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m11:56:48.676831 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.customer_orders"
[0m11:56:48.678626 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.customer_orders"
[0m11:56:48.678962 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
  );
[0m11:56:48.679264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:49.910913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:56:49.939646 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 11:56:48.653436 => 11:56:49.939459
[0m11:56:49.940061 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: Close
[0m11:56:50.080475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104989950>]}
[0m11:56:50.081776 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.customer_orders .................. [[32mSUCCESS 1[0m in 1.43s]
[0m11:56:50.082766 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m11:56:50.085138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:50.085504 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.customer_orders' was properly closed.
[0m11:56:50.085839 [info ] [MainThread]: 
[0m11:56:50.086238 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m11:56:50.087010 [debug] [MainThread]: Command end result
[0m11:56:50.096460 [info ] [MainThread]: 
[0m11:56:50.096992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:50.097326 [info ] [MainThread]: 
[0m11:56:50.097656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:56:50.098195 [debug] [MainThread]: Command `cli run` succeeded at 11:56:50.098104 after 3.54 seconds
[0m11:56:50.098563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100893ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008032d0>]}
[0m11:56:50.098911 [debug] [MainThread]: Flushing usage events
[0m12:03:45.851728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106666510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667ae50>]}


============================== 12:03:45.853751 | 867fca0e-39f2-47f3-aac4-e6cd0d2887e7 ==============================
[0m12:03:45.853751 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:03:45.854075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:03:45.956242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665cc90>]}
[0m12:03:45.962488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f70e50>]}
[0m12:03:45.962817 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:03:45.977271 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:03:45.993594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:45.993775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:45.994024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:03:45.996659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dc850>]}
[0m12:03:46.000539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed8b90>]}
[0m12:03:46.000759 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:03:46.000923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102795510>]}
[0m12:03:46.001508 [info ] [MainThread]: 
[0m12:03:46.001848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:03:46.002349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m12:03:46.008005 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m12:03:46.008155 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m12:03:46.008269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:46.832442 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:03:46.836076 [debug] [ThreadPool]: On list_analytics: Close
[0m12:03:46.973599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m12:03:46.979673 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m12:03:46.979942 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m12:03:46.980137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:47.531667 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m12:03:47.535926 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m12:03:47.649677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e06d10>]}
[0m12:03:47.650655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:03:47.651067 [info ] [MainThread]: 
[0m12:03:47.654102 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:47.654526 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m12:03:47.655113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m12:03:47.655392 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:47.656882 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:03:47.657619 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 12:03:47.655568 => 12:03:47.657466
[0m12:03:47.657883 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:47.679407 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:03:47.681303 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m12:03:47.681660 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
        Orders.USER_ID    as customer_id,
        Orders.ORDER_DATE AS order_placed_at,
            Orders.STATUS AS order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        C.FIRST_NAME    as customer_first_name,
            C.LAST_NAME as customer_last_name
    FROM raw.jaffle_shop.orders as Orders
    left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
from raw.stripe.payment
where STATUS <> 'fail'
group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
    as (select C.ID as customer_id
        , min(ORDER_DATE) as first_order_date
        , max(ORDER_DATE) as most_recent_order_date
        , count(ORDERS.ID) AS number_of_orders
    from raw.jaffle_shop.customers C 
    left join raw.jaffle_shop.orders as Orders
    on orders.USER_ID = C.ID 
    group by 1)

select
    p.*,
    ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
    CASE WHEN c.first_order_date = p.order_placed_at
    THEN 'new'
    ELSE 'return' END as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
    FROM paid_orders p
    left join customer_orders as c USING (customer_id)
    LEFT OUTER JOIN 
    (
            select
            p.order_id,
            sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x on x.order_id = p.order_id
    ORDER BY order_id
  );
[0m12:03:47.681950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:48.224630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:03:48.253312 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 12:03:47.658041 => 12:03:48.253113
[0m12:03:48.253749 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m12:03:49.010101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110827cd0>]}
[0m12:03:49.011536 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 1.35s]
[0m12:03:49.012481 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:49.014556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:49.014902 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m12:03:49.015243 [info ] [MainThread]: 
[0m12:03:49.015652 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m12:03:49.016392 [debug] [MainThread]: Command end result
[0m12:03:49.024525 [info ] [MainThread]: 
[0m12:03:49.024898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:49.025159 [info ] [MainThread]: 
[0m12:03:49.025434 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:03:49.025848 [debug] [MainThread]: Command `cli run` succeeded at 12:03:49.025777 after 3.18 seconds
[0m12:03:49.026120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106687bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10117b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010e7150>]}
[0m12:03:49.026381 [debug] [MainThread]: Flushing usage events
[0m12:04:19.488881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086266d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863af90>]}


============================== 12:04:19.490773 | dd0c439a-2fed-459e-bdfa-10273f3fecda ==============================
[0m12:04:19.490773 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:04:19.491102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:04:19.501948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd0c439a-2fed-459e-bdfa-10273f3fecda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863add0>]}
[0m12:04:19.502845 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-rowxftm7'
[0m12:04:19.503080 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:04:19.784785 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:04:19.787053 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:04:19.941425 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:04:19.944758 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:04:20.111546 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:04:20.116845 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=0.8.0', '<2.0.0', '>=0.7.0', '<0.8.0']
[0m12:04:20.118131 [debug] [MainThread]: Command `dbt deps` failed at 12:04:20.117945 after 0.64 seconds
[0m12:04:20.118622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108674fd0>]}
[0m12:04:20.119097 [debug] [MainThread]: Flushing usage events
[0m12:04:57.350270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108705a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108706a90>]}


============================== 12:04:57.352008 | 8565cd6b-c7c5-4251-86b6-31a31aaf6088 ==============================
[0m12:04:57.352008 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:04:57.352346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:04:57.361025 [error] [MainThread]: Encountered an error:
'version'
[0m12:04:57.363518 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 125, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 158, in wrapper
    project = load_project(
              ^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/runtime.py", line 49, in load_project
    project = Project.from_project_root(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 675, in from_project_root
    return partial.render(renderer)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 288, in render
    return self.create_project(rendered)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 427, in create_project
    packages = package_config_from_data(rendered.packages_dict)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 111, in package_config_from_data
    PackageConfig.validate(packages_data)
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/contracts/project.py", line 102, in validate
    if not package["version"]:
           ~~~~~~~^^^^^^^^^^^
KeyError: 'version'

[0m12:04:57.364196 [debug] [MainThread]: Command `dbt deps` failed at 12:04:57.364108 after 0.02 seconds
[0m12:04:57.364403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bcfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc2e50>]}
[0m12:04:57.364594 [debug] [MainThread]: Flushing usage events
[0m12:05:34.771122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a53990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66e90>]}


============================== 12:05:34.772948 | a571a621-e156-4da8-9ba1-41dc70fb30c4 ==============================
[0m12:05:34.772948 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:05:34.773305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:05:34.784465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a571a621-e156-4da8-9ba1-41dc70fb30c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a67250>]}
[0m12:05:34.785434 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-083cwfvx'
[0m12:05:34.785666 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:05:35.078081 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:05:35.081916 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:05:35.250681 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:05:35.252960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:05:35.416657 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:05:35.421767 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=0.8.0', '<2.0.0', '>=0.7.0', '<0.8.0']
[0m12:05:35.423043 [debug] [MainThread]: Command `dbt deps` failed at 12:05:35.422644 after 0.66 seconds
[0m12:05:35.423666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a49710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa0fd0>]}
[0m12:05:35.424177 [debug] [MainThread]: Flushing usage events
[0m12:06:17.877137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3ef50>]}


============================== 12:06:17.878960 | 32d73340-b75e-441a-9326-761272dd7abb ==============================
[0m12:06:17.878960 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:06:17.879277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:06:17.890315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32d73340-b75e-441a-9326-761272dd7abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429ba90>]}
[0m12:06:17.891288 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-bu0jap77'
[0m12:06:17.891563 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:06:18.168304 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:06:18.172242 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:06:18.337395 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:06:18.342190 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:06:18.519684 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:06:18.531552 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: >=0.7.0, <0.8.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m12:06:18.532647 [debug] [MainThread]: Command `dbt deps` failed at 12:06:18.532492 after 0.66 seconds
[0m12:06:18.533063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d215d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023fae90>]}
[0m12:06:18.533465 [debug] [MainThread]: Flushing usage events
[0m12:07:05.783712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a66850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a70250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7acd0>]}


============================== 12:07:05.785467 | a872e5d7-08ba-434c-a678-3eaa0eda4925 ==============================
[0m12:07:05.785467 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:07:05.785785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:07:05.796654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a872e5d7-08ba-434c-a678-3eaa0eda4925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7a6d0>]}
[0m12:07:05.797770 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-p8_gse_t'
[0m12:07:05.797988 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:07:06.045880 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:07:06.049240 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:07:06.205391 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:07:06.209325 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:07:06.377284 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:07:06.393937 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m12:07:06.749812 [info ] [MainThread]: Installed from version 0.9.0
[0m12:07:06.750243 [info ] [MainThread]: Up to date!
[0m12:07:06.750691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a872e5d7-08ba-434c-a678-3eaa0eda4925', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a89f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aacc50>]}
[0m12:07:06.751074 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:07:07.235728 [info ] [MainThread]: Installed from version 1.1.1
[0m12:07:07.236009 [info ] [MainThread]: Up to date!
[0m12:07:07.236268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a872e5d7-08ba-434c-a678-3eaa0eda4925', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a79310>]}
[0m12:07:07.236998 [debug] [MainThread]: Command `dbt deps` succeeded at 12:07:07.236931 after 1.46 seconds
[0m12:07:07.237210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dcb510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eac310>]}
[0m12:07:07.237385 [debug] [MainThread]: Flushing usage events
[0m12:07:34.033610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722b90>]}


============================== 12:07:34.035455 | 27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46 ==============================
[0m12:07:34.035455 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:07:34.035764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:07:34.046682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722a10>]}
[0m12:07:34.047394 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-4902y0l5'
[0m12:07:34.047620 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:07:34.321928 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:07:34.325466 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:07:34.489871 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:07:34.494171 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:07:34.660746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:07:34.666475 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:07:34.836828 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:07:34.853504 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m12:07:35.193835 [info ] [MainThread]: Installed from version 0.9.0
[0m12:07:35.194183 [info ] [MainThread]: Up to date!
[0m12:07:35.194517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104755390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f150>]}
[0m12:07:35.194806 [info ] [MainThread]: Installing dbt-labs/codegen
[0m12:07:35.535356 [info ] [MainThread]: Installed from version 0.10.0
[0m12:07:35.535710 [info ] [MainThread]: Up to date!
[0m12:07:35.536003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f150>]}
[0m12:07:35.536293 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:07:35.985144 [info ] [MainThread]: Installed from version 1.1.1
[0m12:07:35.985430 [info ] [MainThread]: Up to date!
[0m12:07:35.985666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475f050>]}
[0m12:07:35.986482 [debug] [MainThread]: Command `dbt deps` succeeded at 12:07:35.986406 after 1.96 seconds
[0m12:07:35.986703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c97510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e6f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034893d0>]}
[0m12:07:35.986901 [debug] [MainThread]: Flushing usage events
[0m12:10:02.406890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108652910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108653010>]}


============================== 12:10:02.408697 | 93f47183-5619-4417-9cfd-3afef2cbdb0d ==============================
[0m12:10:02.408697 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:10:02.409029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:02.527439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b5b50>]}
[0m12:10:02.533605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108666190>]}
[0m12:10:02.533984 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:10:02.551568 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:10:02.556613 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:10:02.556870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108697dd0>]}
[0m12:10:02.923272 [debug] [MainThread]: 1699: static parser successfully parsed legacy/fct_customer_orders.sql
[0m12:10:02.928743 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m12:10:02.966738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:10:02.968812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fae010>]}
[0m12:10:02.972430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094aa010>]}
[0m12:10:02.972614 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:10:02.972779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108652fd0>]}
[0m12:10:02.973354 [info ] [MainThread]: 
[0m12:10:02.973527 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:10:02.973739 [debug] [MainThread]: Command end result
[0m12:10:02.977135 [debug] [MainThread]: Command `cli run` succeeded at 12:10:02.977086 after 0.58 seconds
[0m12:10:02.977306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108659bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0f2d0>]}
[0m12:10:02.977448 [debug] [MainThread]: Flushing usage events
[0m12:10:22.442462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ef5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043db2d0>]}


============================== 12:10:22.444420 | 7d7eb559-d4d9-4135-995b-197452ba2cdf ==============================
[0m12:10:22.444420 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:10:22.444743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:22.544765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104407b10>]}
[0m12:10:22.550971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5c9d0>]}
[0m12:10:22.551275 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:10:22.568671 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:10:22.585550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:10:22.585717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:10:22.585954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:10:22.588568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf28d0>]}
[0m12:10:22.592678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdbd90>]}
[0m12:10:22.592890 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:10:22.593058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102165350>]}
[0m12:10:22.593586 [info ] [MainThread]: 
[0m12:10:22.593754 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:10:22.593966 [debug] [MainThread]: Command end result
[0m12:10:22.597230 [debug] [MainThread]: Command `cli test` succeeded at 12:10:22.597184 after 0.16 seconds
[0m12:10:22.597400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b4bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100abb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100abb2d0>]}
[0m12:10:22.597543 [debug] [MainThread]: Flushing usage events
[0m12:16:19.220044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108007510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108007d50>]}


============================== 12:16:19.222392 | 74b03960-0259-4d11-9058-300327a785ad ==============================
[0m12:16:19.222392 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:16:19.222706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:16:19.336927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff9b50>]}
[0m12:16:19.343014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108023dd0>]}
[0m12:16:19.343345 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:16:19.361178 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:16:19.383351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:19.383643 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://analyses/compare_queries.sql
[0m12:16:19.411593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:16:19.413970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f98e90>]}
[0m12:16:19.418425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088595d0>]}
[0m12:16:19.418649 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:16:19.418822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d89250>]}
[0m12:16:19.419550 [info ] [MainThread]: 
[0m12:16:19.419895 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:19.420390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m12:16:19.425889 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m12:16:19.426069 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m12:16:19.426201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:20.182082 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:16:20.185612 [debug] [ThreadPool]: On list_analytics: Close
[0m12:16:20.311177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m12:16:20.319408 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m12:16:20.319767 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m12:16:20.320046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:20.953385 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m12:16:20.957999 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m12:16:21.084795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107699250>]}
[0m12:16:21.086339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:21.086911 [info ] [MainThread]: 
[0m12:16:21.093697 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m12:16:21.094447 [info ] [Thread-1 (]: 1 of 2 START sql view model DBT_AMOLEIRO.customer_orders ....................... [RUN]
[0m12:16:21.095431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m12:16:21.095862 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m12:16:21.097840 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m12:16:21.098570 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 12:16:21.096127 => 12:16:21.098388
[0m12:16:21.098891 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m12:16:21.123178 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.customer_orders"
[0m12:16:21.124968 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.customer_orders"
[0m12:16:21.125363 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
        Orders.USER_ID    as customer_id,
        Orders.ORDER_DATE AS order_placed_at,
            Orders.STATUS AS order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        C.FIRST_NAME    as customer_first_name,
            C.LAST_NAME as customer_last_name
    FROM raw.jaffle_shop.orders as Orders
    left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
from raw.stripe.payment
where STATUS <> 'fail'
group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
    as (select C.ID as customer_id
        , min(ORDER_DATE) as first_order_date
        , max(ORDER_DATE) as most_recent_order_date
        , count(ORDERS.ID) AS number_of_orders
    from raw.jaffle_shop.customers C 
    left join raw.jaffle_shop.orders as Orders
    on orders.USER_ID = C.ID 
    group by 1)

select
    p.*,
    ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
    CASE WHEN c.first_order_date = p.order_placed_at
    THEN 'new'
    ELSE 'return' END as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
    FROM paid_orders p
    left join customer_orders as c USING (customer_id)
    LEFT OUTER JOIN 
    (
            select
            p.order_id,
            sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x on x.order_id = p.order_id
    ORDER BY order_id
  );
[0m12:16:21.125675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:21.799392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:21.813071 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 12:16:21.099094 => 12:16:21.812957
[0m12:16:21.813317 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: Close
[0m12:16:21.923788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967b010>]}
[0m12:16:21.924569 [info ] [Thread-1 (]: 1 of 2 OK created sql view model DBT_AMOLEIRO.customer_orders .................. [[32mSUCCESS 1[0m in 0.83s]
[0m12:16:21.925320 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m12:16:21.925801 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:21.926401 [info ] [Thread-1 (]: 2 of 2 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m12:16:21.927261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.customer_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m12:16:21.927621 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:21.929361 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:16:21.931066 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 12:16:21.927836 => 12:16:21.930869
[0m12:16:21.931419 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:21.934941 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:16:21.937265 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m12:16:21.937662 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
        Orders.USER_ID    as customer_id,
        Orders.ORDER_DATE AS order_placed_at,
            Orders.STATUS AS order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        C.FIRST_NAME    as customer_first_name,
            C.LAST_NAME as customer_last_name
    FROM raw.jaffle_shop.orders as Orders
    left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
from raw.stripe.payment
where STATUS <> 'fail'
group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
    as (select C.ID as customer_id
        , min(ORDER_DATE) as first_order_date
        , max(ORDER_DATE) as most_recent_order_date
        , count(ORDERS.ID) AS number_of_orders
    from raw.jaffle_shop.customers C 
    left join raw.jaffle_shop.orders as Orders
    on orders.USER_ID = C.ID 
    group by 1)

select
    p.*,
    ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
    CASE WHEN c.first_order_date = p.order_placed_at
    THEN 'new'
    ELSE 'return' END as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
    FROM paid_orders p
    left join customer_orders as c USING (customer_id)
    LEFT OUTER JOIN 
    (
            select
            p.order_id,
            sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x on x.order_id = p.order_id
    ORDER BY order_id
  );
[0m12:16:21.938043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:22.825680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:22.832336 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 12:16:21.931631 => 12:16:22.832143
[0m12:16:22.832724 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m12:16:22.943381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d07fd0>]}
[0m12:16:22.944116 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 1.02s]
[0m12:16:22.944837 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:22.946518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:22.946784 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m12:16:22.947067 [info ] [MainThread]: 
[0m12:16:22.947406 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m12:16:22.948122 [debug] [MainThread]: Command end result
[0m12:16:22.955919 [info ] [MainThread]: 
[0m12:16:22.956266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:22.956519 [info ] [MainThread]: 
[0m12:16:22.956788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:16:22.957299 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:22.957227 after 3.75 seconds
[0m12:16:22.957586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466c310>]}
[0m12:16:22.957850 [debug] [MainThread]: Flushing usage events
[0m12:17:01.920307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106143290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106152350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106153a10>]}


============================== 12:17:01.922740 | 37c2af2a-0354-464e-a586-8d46bc1ee3b4 ==============================
[0m12:17:01.922740 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:17:01.923045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:17:02.039394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614fd10>]}
[0m12:17:02.045483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616c4d0>]}
[0m12:17:02.045842 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:17:02.065301 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:17:02.089728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:02.089932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:02.090177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:17:02.093013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dec50>]}
[0m12:17:02.096747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106934dd0>]}
[0m12:17:02.096955 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:17:02.097127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec9250>]}
[0m12:17:02.097815 [info ] [MainThread]: 
[0m12:17:02.098178 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:17:02.098657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m12:17:02.104701 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m12:17:02.104886 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m12:17:02.105008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:02.889339 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m12:17:02.893447 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m12:17:03.012434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106903a10>]}
[0m12:17:03.013659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:17:03.014124 [info ] [MainThread]: 
[0m12:17:03.019493 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m12:17:03.020274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m12:17:03.020650 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m12:17:03.022843 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m12:17:03.023698 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 12:17:03.020884 => 12:17:03.023471
[0m12:17:03.024053 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m12:17:03.024438 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 12:17:03.024266 => 12:17:03.024281
[0m12:17:03.025314 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m12:17:03.025617 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.026223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.customer_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m12:17:03.026559 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.028824 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:17:03.029348 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 12:17:03.026752 => 12:17:03.029203
[0m12:17:03.029611 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.029932 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 12:17:03.029783 => 12:17:03.029790
[0m12:17:03.030586 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.031052 [debug] [Thread-1 (]: Began running node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.031609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.fct_customer_orders, now analysis.refactoring_for_modularity.compare_queries)
[0m12:17:03.031862 [debug] [Thread-1 (]: Began compiling node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.049189 [debug] [Thread-1 (]: Using snowflake connection "analysis.refactoring_for_modularity.compare_queries"
[0m12:17:03.049458 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "analysis.refactoring_for_modularity.compare_queries"} */
describe table analytics.DBT_AMOLEIRO.customer_orders
[0m12:17:03.049658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:03.600398 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.0 seconds
[0m12:17:03.615755 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.refactoring_for_modularity.compare_queries"
[0m12:17:03.616787 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (compile): 12:17:03.032028 => 12:17:03.616573
[0m12:17:03.617133 [debug] [Thread-1 (]: Began executing node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.617515 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (execute): 12:17:03.617350 => 12:17:03.617366
[0m12:17:03.617843 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: Close
[0m12:17:03.734303 [debug] [Thread-1 (]: Finished running node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.736095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:03.736525 [debug] [MainThread]: Connection 'analysis.refactoring_for_modularity.compare_queries' was properly closed.
[0m12:17:03.737781 [debug] [MainThread]: Command end result
[0m12:17:03.750505 [debug] [MainThread]: Command `dbt compile` succeeded at 12:17:03.750370 after 1.84 seconds
[0m12:17:03.750930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061630d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106163190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026cb510>]}
[0m12:17:03.751313 [debug] [MainThread]: Flushing usage events
[0m12:36:18.912304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613b2d0>]}


============================== 12:36:18.914783 | 04288725-dc50-441d-87cc-2f1ad19e1916 ==============================
[0m12:36:18.914783 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:36:18.915096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:36:19.034050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04288725-dc50-441d-87cc-2f1ad19e1916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106141ed0>]}
[0m12:36:19.040112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04288725-dc50-441d-87cc-2f1ad19e1916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106176010>]}
[0m12:36:19.040441 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:36:19.058435 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:36:19.065113 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading refactoring_for_modularity: staging/jaffle_shop/sources.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  | - name: jaffle_shop
    5  |     database: raw
    6  |     tables:
    7  |     - name: customers
    8  |     - name: orders
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
[0m12:36:19.065471 [debug] [MainThread]: Command `cli build` failed at 12:36:19.065415 after 0.16 seconds
[0m12:36:19.065662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281b190>]}
[0m12:36:19.065845 [debug] [MainThread]: Flushing usage events
