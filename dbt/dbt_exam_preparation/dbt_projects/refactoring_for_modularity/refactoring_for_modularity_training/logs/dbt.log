[0m10:43:46.708505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082da850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ea4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ead50>]}


============================== 10:43:46.710250 | eb3ce87d-05a4-43f6-862b-b40e84d894c7 ==============================
[0m10:43:46.710250 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:43:46.710574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:43:46.807270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cbe90>]}
[0m10:43:46.813138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cbe90>]}
[0m10:43:46.813641 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:43:46.822821 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m10:43:46.823187 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:43:46.823395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830c150>]}
[0m10:43:47.054061 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m10:43:47.059520 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m10:43:47.088436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108baf350>]}
[0m10:43:47.091204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba5750>]}
[0m10:43:47.091387 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:43:47.092225 [info ] [MainThread]: 
[0m10:43:47.092550 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:43:47.092961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:43:47.098160 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:43:47.098295 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:43:47.098406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:52.128484 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 5.0 seconds
[0m10:43:52.132451 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:52.266869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:43:52.274424 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:43:52.274763 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:43:52.275034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:52.683736 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m10:43:52.687100 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:43:52.816247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa4710>]}
[0m10:43:52.817041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:52.817402 [info ] [MainThread]: 
[0m10:43:52.834926 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.835327 [info ] [Thread-1 (]: 1 of 6 START sql table model DBT_AMOLEIRO.my_first_dbt_model ................... [RUN]
[0m10:43:52.835835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m10:43:52.836050 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.837949 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.838653 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 10:43:52.836184 => 10:43:52.838526
[0m10:43:52.838866 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:52.855405 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.856208 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.my_first_dbt_model"
[0m10:43:52.856413 [debug] [Thread-1 (]: On model.refactoring_for_modularity.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.my_first_dbt_model"} */
create or replace transient table analytics.DBT_AMOLEIRO.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m10:43:52.856598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:54.363495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:43:54.387779 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 10:43:52.838995 => 10:43:54.387613
[0m10:43:54.388146 [debug] [Thread-1 (]: On model.refactoring_for_modularity.my_first_dbt_model: Close
[0m10:43:54.495099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3ce87d-05a4-43f6-862b-b40e84d894c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1d790>]}
[0m10:43:54.496350 [info ] [Thread-1 (]: 1 of 6 OK created sql table model DBT_AMOLEIRO.my_first_dbt_model .............. [[32mSUCCESS 1[0m in 1.66s]
[0m10:43:54.497342 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m10:43:54.499040 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.499726 [info ] [Thread-1 (]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m10:43:54.500738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m10:43:54.501180 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.517695 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.518673 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 10:43:54.501457 => 10:43:54.518509
[0m10:43:54.518978 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:54.561136 [debug] [Thread-1 (]: Writing runtime sql for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.561822 [debug] [Thread-1 (]: Using snowflake connection "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m10:43:54.562021 [debug] [Thread-1 (]: On test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from analytics.DBT_AMOLEIRO.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m10:43:54.562191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:55.182309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:43:55.190074 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 10:43:54.519163 => 10:43:55.189722
[0m10:43:55.190691 [debug] [Thread-1 (]: On test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m10:43:55.304010 [error] [Thread-1 (]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.80s]
[0m10:43:55.304905 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m10:43:55.305387 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.305917 [info ] [Thread-1 (]: 3 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m10:43:55.306673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m10:43:55.307061 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.313621 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.314363 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 10:43:55.307274 => 10:43:55.314207
[0m10:43:55.314659 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.316736 [debug] [Thread-1 (]: Writing runtime sql for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.317613 [debug] [Thread-1 (]: Using snowflake connection "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m10:43:55.318057 [debug] [Thread-1 (]: On test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.DBT_AMOLEIRO.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:43:55.318345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:55.813273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:43:55.819700 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 10:43:55.314833 => 10:43:55.819147
[0m10:43:55.820688 [debug] [Thread-1 (]: On test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321: Close
[0m10:43:55.942332 [info ] [Thread-1 (]: 3 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m10:43:55.943338 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m10:43:55.944375 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m10:43:55.944883 [info ] [Thread-1 (]: 4 of 6 SKIP relation DBT_AMOLEIRO.my_second_dbt_model .......................... [[33mSKIP[0m]
[0m10:43:55.945442 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m10:43:55.946135 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m10:43:55.946612 [info ] [Thread-1 (]: 5 of 6 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m10:43:55.947146 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m10:43:55.947562 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m10:43:55.948002 [info ] [Thread-1 (]: 6 of 6 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m10:43:55.948496 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m10:43:55.950116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:55.950438 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m10:43:55.950773 [info ] [MainThread]: 
[0m10:43:55.951095 [info ] [MainThread]: Finished running 1 table model, 4 tests, 1 view model in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m10:43:55.951959 [debug] [MainThread]: Command end result
[0m10:43:55.957904 [info ] [MainThread]: 
[0m10:43:55.958228 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:43:55.958485 [info ] [MainThread]: 
[0m10:43:55.958744 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m10:43:55.958995 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:43:55.959235 [info ] [MainThread]: 
[0m10:43:55.959571 [info ] [MainThread]:   compiled Code at target/compiled/refactoring_for_modularity/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m10:43:55.959918 [info ] [MainThread]: 
[0m10:43:55.960229 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m10:43:55.960688 [debug] [MainThread]: Command `dbt build` failed at 10:43:55.960610 after 9.26 seconds
[0m10:43:55.961008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47410>]}
[0m10:43:55.961322 [debug] [MainThread]: Flushing usage events
[0m10:45:30.307075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c6610>]}


============================== 10:45:30.308923 | f0ecf51d-2f3b-461c-9cba-6b4dfe7a32ad ==============================
[0m10:45:30.308923 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:45:30.309256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:45:30.319092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0ecf51d-2f3b-461c-9cba-6b4dfe7a32ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81190>]}
[0m10:45:30.319418 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:45:30.319707 [debug] [MainThread]: Command `dbt deps` succeeded at 10:45:30.319653 after 0.02 seconds
[0m10:45:30.319865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472c250>]}
[0m10:45:30.320017 [debug] [MainThread]: Flushing usage events
[0m10:46:07.336083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104592850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a2410>]}


============================== 10:46:07.337909 | 9f66b2fe-399d-4e1f-a364-9900ba67afbc ==============================
[0m10:46:07.337909 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:46:07.338243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:46:07.348153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045adc90>]}
[0m10:46:07.349059 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-7lefbxz_'
[0m10:46:07.349260 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:46:07.640042 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:46:07.643236 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m10:46:07.842295 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m10:46:07.848063 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:46:08.022935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:46:08.040161 [info ] [MainThread]: Installing dbt-labs/codegen
[0m10:46:08.433565 [info ] [MainThread]: Installed from version 0.10.0
[0m10:46:08.433977 [info ] [MainThread]: Up to date!
[0m10:46:08.434345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104593d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e0b10>]}
[0m10:46:08.434682 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:46:08.936254 [info ] [MainThread]: Installed from version 1.1.1
[0m10:46:08.936521 [info ] [MainThread]: Up to date!
[0m10:46:08.936840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f66b2fe-399d-4e1f-a364-9900ba67afbc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408fe50>]}
[0m10:46:08.937467 [debug] [MainThread]: Command `dbt deps` succeeded at 10:46:08.937400 after 1.61 seconds
[0m10:46:08.937662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b27510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cff410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd4990>]}
[0m10:46:08.937838 [debug] [MainThread]: Flushing usage events
[0m11:41:10.530851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424ba10>]}


============================== 11:41:10.532657 | a1f2e0ca-3429-4fc4-b5df-7122b371555e ==============================
[0m11:41:10.532657 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:41:10.532966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:41:10.637878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104231bd0>]}
[0m11:41:10.643886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104231bd0>]}
[0m11:41:10.644157 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:41:10.659574 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:41:10.678196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:10.678449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:10.681655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ae750>]}
[0m11:41:10.682974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b22010>]}
[0m11:41:10.683188 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:41:10.683365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fc0f50>]}
[0m11:41:10.684217 [info ] [MainThread]: 
[0m11:41:10.684618 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:10.685099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m11:41:10.691212 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:41:10.691406 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:41:10.691536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:13.553502 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 3.0 seconds
[0m11:41:13.557984 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:41:13.673037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f2e0ca-3429-4fc4-b5df-7122b371555e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f75410>]}
[0m11:41:13.673989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:13.674431 [info ] [MainThread]: 
[0m11:41:13.679436 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.680168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m11:41:13.680514 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.683921 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m11:41:13.684821 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 11:41:13.680728 => 11:41:13.684655
[0m11:41:13.685092 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.685403 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 11:41:13.685264 => 11:41:13.685279
[0m11:41:13.686072 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:41:13.686662 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.687235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now model.refactoring_for_modularity.my_second_dbt_model)
[0m11:41:13.687523 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.689866 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_second_dbt_model"
[0m11:41:13.690453 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (compile): 11:41:13.687703 => 11:41:13.690309
[0m11:41:13.690676 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.690935 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (execute): 11:41:13.690821 => 11:41:13.690827
[0m11:41:13.691471 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:41:13.691721 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.692188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_second_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:41:13.692400 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.701298 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:41:13.701819 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 11:41:13.692538 => 11:41:13.701699
[0m11:41:13.702033 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.702276 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 11:41:13.702166 => 11:41:13.702173
[0m11:41:13.702776 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:41:13.703003 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.703372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m11:41:13.703571 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.707436 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m11:41:13.707840 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 11:41:13.703698 => 11:41:13.707728
[0m11:41:13.708025 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.708241 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 11:41:13.708146 => 11:41:13.708151
[0m11:41:13.708673 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:41:13.708882 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.709211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321, now test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778)
[0m11:41:13.709403 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.711799 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778"
[0m11:41:13.712186 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:41:13.709522 => 11:41:13.712083
[0m11:41:13.712368 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.712577 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:41:13.712486 => 11:41:13.712490
[0m11:41:13.712998 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:41:13.713197 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.713556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778, now test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:41:13.713733 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.715980 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:41:13.716368 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:41:13.713864 => 11:41:13.716268
[0m11:41:13.716534 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.716727 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:41:13.716643 => 11:41:13.716646
[0m11:41:13.717125 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:41:13.717576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:13.717713 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:41:13.718266 [debug] [MainThread]: Command end result
[0m11:41:13.724482 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:41:13.724636 [info ] [MainThread]: Building catalog
[0m11:41:13.725250 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m11:41:13.729027 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m11:41:13.729307 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m11:41:13.729562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:16.178081 [debug] [ThreadPool]: SQL status: SUCCESS 83 in 2.0 seconds
[0m11:41:16.195433 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m11:41:16.337707 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/target/catalog.json
[0m11:41:16.338629 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:41:16.338529 after 5.82 seconds
[0m11:41:16.338904 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:41:16.339108 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m11:41:16.339386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fc1190>]}
[0m11:41:16.339682 [debug] [MainThread]: Flushing usage events
[0m11:45:04.231409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11186a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11187a250>]}


============================== 11:45:04.233187 | 2b78b227-a0c5-47b8-abfe-3e9ef68187b0 ==============================
[0m11:45:04.233187 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:45:04.233489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:45:04.332302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b78b227-a0c5-47b8-abfe-3e9ef68187b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120de010>]}
[0m11:45:04.338082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b78b227-a0c5-47b8-abfe-3e9ef68187b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118caa90>]}
[0m11:46:35.608693 [error] [MainThread]: Encountered an error:

[0m11:46:35.613811 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:46:35.615840 [debug] [MainThread]: Command `dbt docs serve` failed at 11:46:35.615549 after 91.39 seconds
[0m11:46:35.616532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111861850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11186a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112191f90>]}
[0m11:46:35.617149 [debug] [MainThread]: Flushing usage events
[0m11:46:40.911313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b43110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b43990>]}


============================== 11:46:40.913053 | 5941d7f4-5be9-4dbe-970b-b5eb285619bf ==============================
[0m11:46:40.913053 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:46:40.913381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:41.012346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b349d0>]}
[0m11:46:41.018208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109330910>]}
[0m11:46:41.018468 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:46:41.032635 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:46:41.051041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:41.051211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:41.053862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109308ad0>]}
[0m11:46:41.054666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094298d0>]}
[0m11:46:41.054838 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:46:41.055026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c4f50>]}
[0m11:46:41.055853 [info ] [MainThread]: 
[0m11:46:41.056213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:41.056678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m11:46:41.062584 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:46:41.062782 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:46:41.062923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:41.741005 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m11:46:41.743168 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:46:41.855162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5941d7f4-5be9-4dbe-970b-b5eb285619bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0e90>]}
[0m11:46:41.856245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:41.856691 [info ] [MainThread]: 
[0m11:46:41.862650 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.863531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.my_first_dbt_model)
[0m11:46:41.863974 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.867107 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_first_dbt_model"
[0m11:46:41.867982 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (compile): 11:46:41.864200 => 11:46:41.867780
[0m11:46:41.868316 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.868693 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_first_dbt_model (execute): 11:46:41.868522 => 11:46:41.868536
[0m11:46:41.869502 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_first_dbt_model
[0m11:46:41.870264 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.870902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_first_dbt_model, now model.refactoring_for_modularity.my_second_dbt_model)
[0m11:46:41.871187 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.873464 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.my_second_dbt_model"
[0m11:46:41.874085 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (compile): 11:46:41.871367 => 11:46:41.873938
[0m11:46:41.874338 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.874639 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.my_second_dbt_model (execute): 11:46:41.874503 => 11:46:41.874511
[0m11:46:41.875277 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.my_second_dbt_model
[0m11:46:41.875585 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.876119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.my_second_dbt_model, now test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:46:41.876361 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.884909 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:46:41.885391 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 11:46:41.876524 => 11:46:41.885273
[0m11:46:41.885595 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.885843 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 11:46:41.885731 => 11:46:41.885737
[0m11:46:41.886318 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:46:41.886538 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.886898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_first_dbt_model_id.5fb22c2710, now test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321)
[0m11:46:41.887086 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.891162 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321"
[0m11:46:41.891573 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (compile): 11:46:41.887212 => 11:46:41.891452
[0m11:46:41.891776 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.892021 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321 (execute): 11:46:41.891909 => 11:46:41.891915
[0m11:46:41.892486 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321
[0m11:46:41.892703 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.893025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.unique_my_first_dbt_model_id.16e066b321, now test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778)
[0m11:46:41.893199 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.896465 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778"
[0m11:46:41.897036 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:46:41.893314 => 11:46:41.896924
[0m11:46:41.897220 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.897426 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:46:41.897336 => 11:46:41.897340
[0m11:46:41.897848 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778
[0m11:46:41.898065 [debug] [Thread-1 (]: Began running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.898385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.refactoring_for_modularity.not_null_my_second_dbt_model_id.151b76d778, now test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:46:41.898565 [debug] [Thread-1 (]: Began compiling node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.900727 [debug] [Thread-1 (]: Writing injected SQL for node "test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:46:41.901093 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:46:41.898682 => 11:46:41.900990
[0m11:46:41.901262 [debug] [Thread-1 (]: Began executing node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.901456 [debug] [Thread-1 (]: Timing info for test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:46:41.901371 => 11:46:41.901374
[0m11:46:41.901843 [debug] [Thread-1 (]: Finished running node test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493
[0m11:46:41.902276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:41.902424 [debug] [MainThread]: Connection 'test.refactoring_for_modularity.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:46:41.902974 [debug] [MainThread]: Command end result
[0m11:46:41.907888 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:46:41.908029 [info ] [MainThread]: Building catalog
[0m11:46:41.908624 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m11:46:41.912367 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m11:46:41.912622 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m11:46:41.912831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:43.793945 [debug] [ThreadPool]: SQL status: SUCCESS 83 in 2.0 seconds
[0m11:46:43.810483 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m11:46:43.971280 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/target/catalog.json
[0m11:46:43.972081 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:46:43.971997 after 3.07 seconds
[0m11:46:43.972323 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:46:43.972494 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m11:46:43.972735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30fe50>]}
[0m11:46:43.973007 [debug] [MainThread]: Flushing usage events
[0m11:46:55.096091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104789a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478b010>]}


============================== 11:46:55.097882 | 35ac56aa-3b18-4e2c-9047-7e637ecaee3e ==============================
[0m11:46:55.097882 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:46:55.098203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:55.196285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35ac56aa-3b18-4e2c-9047-7e637ecaee3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476e750>]}
[0m11:46:55.202077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35ac56aa-3b18-4e2c-9047-7e637ecaee3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f48290>]}
[0m11:55:43.876526 [error] [MainThread]: Encountered an error:

[0m11:55:43.883093 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:55:43.884623 [debug] [MainThread]: Command `dbt docs serve` failed at 11:55:43.884444 after 528.79 seconds
[0m11:55:43.885104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f14fd0>]}
[0m11:55:43.885546 [debug] [MainThread]: Flushing usage events
[0m11:56:46.564885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104133810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104142d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041433d0>]}


============================== 11:56:46.566735 | 8739d017-c4bb-4add-977f-2df74978bf0a ==============================
[0m11:56:46.566735 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:56:46.567026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:56:46.672153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414f8d0>]}
[0m11:56:46.678200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104159310>]}
[0m11:56:46.678470 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m11:56:46.692911 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:56:46.708765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:46.708925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:46.709143 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m11:56:46.711734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5ae90>]}
[0m11:56:46.715744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104988a10>]}
[0m11:56:46.716048 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:56:46.716236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ead0d0>]}
[0m11:56:46.716798 [info ] [MainThread]: 
[0m11:56:46.717162 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:46.717618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m11:56:46.723821 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m11:56:46.724007 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m11:56:46.724126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:47.622688 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:56:47.625500 [debug] [ThreadPool]: On list_analytics: Close
[0m11:56:47.748733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m11:56:47.757901 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m11:56:47.758308 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m11:56:47.758594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:48.450691 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m11:56:48.454999 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m11:56:48.639961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc6e50>]}
[0m11:56:48.641182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:48.641665 [info ] [MainThread]: 
[0m11:56:48.647980 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m11:56:48.648633 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.customer_orders ....................... [RUN]
[0m11:56:48.649522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m11:56:48.649925 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m11:56:48.651890 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m11:56:48.652781 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 11:56:48.650155 => 11:56:48.652483
[0m11:56:48.653203 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m11:56:48.676831 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.customer_orders"
[0m11:56:48.678626 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.customer_orders"
[0m11:56:48.678962 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
  );
[0m11:56:48.679264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:49.910913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:56:49.939646 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 11:56:48.653436 => 11:56:49.939459
[0m11:56:49.940061 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: Close
[0m11:56:50.080475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8739d017-c4bb-4add-977f-2df74978bf0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104989950>]}
[0m11:56:50.081776 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.customer_orders .................. [[32mSUCCESS 1[0m in 1.43s]
[0m11:56:50.082766 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m11:56:50.085138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:50.085504 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.customer_orders' was properly closed.
[0m11:56:50.085839 [info ] [MainThread]: 
[0m11:56:50.086238 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m11:56:50.087010 [debug] [MainThread]: Command end result
[0m11:56:50.096460 [info ] [MainThread]: 
[0m11:56:50.096992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:50.097326 [info ] [MainThread]: 
[0m11:56:50.097656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:56:50.098195 [debug] [MainThread]: Command `cli run` succeeded at 11:56:50.098104 after 3.54 seconds
[0m11:56:50.098563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100893ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008032d0>]}
[0m11:56:50.098911 [debug] [MainThread]: Flushing usage events
[0m12:03:45.851728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106666510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667ae50>]}


============================== 12:03:45.853751 | 867fca0e-39f2-47f3-aac4-e6cd0d2887e7 ==============================
[0m12:03:45.853751 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:03:45.854075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:03:45.956242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665cc90>]}
[0m12:03:45.962488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f70e50>]}
[0m12:03:45.962817 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:03:45.977271 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:03:45.993594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:45.993775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:45.994024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:03:45.996659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dc850>]}
[0m12:03:46.000539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed8b90>]}
[0m12:03:46.000759 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 447 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:03:46.000923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102795510>]}
[0m12:03:46.001508 [info ] [MainThread]: 
[0m12:03:46.001848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:03:46.002349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m12:03:46.008005 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m12:03:46.008155 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m12:03:46.008269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:46.832442 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:03:46.836076 [debug] [ThreadPool]: On list_analytics: Close
[0m12:03:46.973599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m12:03:46.979673 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m12:03:46.979942 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m12:03:46.980137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:47.531667 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m12:03:47.535926 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m12:03:47.649677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e06d10>]}
[0m12:03:47.650655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:03:47.651067 [info ] [MainThread]: 
[0m12:03:47.654102 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:47.654526 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m12:03:47.655113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m12:03:47.655392 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:47.656882 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:03:47.657619 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 12:03:47.655568 => 12:03:47.657466
[0m12:03:47.657883 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:47.679407 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:03:47.681303 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m12:03:47.681660 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
        Orders.USER_ID    as customer_id,
        Orders.ORDER_DATE AS order_placed_at,
            Orders.STATUS AS order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        C.FIRST_NAME    as customer_first_name,
            C.LAST_NAME as customer_last_name
    FROM raw.jaffle_shop.orders as Orders
    left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
from raw.stripe.payment
where STATUS <> 'fail'
group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
    as (select C.ID as customer_id
        , min(ORDER_DATE) as first_order_date
        , max(ORDER_DATE) as most_recent_order_date
        , count(ORDERS.ID) AS number_of_orders
    from raw.jaffle_shop.customers C 
    left join raw.jaffle_shop.orders as Orders
    on orders.USER_ID = C.ID 
    group by 1)

select
    p.*,
    ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
    CASE WHEN c.first_order_date = p.order_placed_at
    THEN 'new'
    ELSE 'return' END as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
    FROM paid_orders p
    left join customer_orders as c USING (customer_id)
    LEFT OUTER JOIN 
    (
            select
            p.order_id,
            sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x on x.order_id = p.order_id
    ORDER BY order_id
  );
[0m12:03:47.681950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:48.224630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:03:48.253312 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 12:03:47.658041 => 12:03:48.253113
[0m12:03:48.253749 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m12:03:49.010101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867fca0e-39f2-47f3-aac4-e6cd0d2887e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110827cd0>]}
[0m12:03:49.011536 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 1.35s]
[0m12:03:49.012481 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m12:03:49.014556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:49.014902 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m12:03:49.015243 [info ] [MainThread]: 
[0m12:03:49.015652 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m12:03:49.016392 [debug] [MainThread]: Command end result
[0m12:03:49.024525 [info ] [MainThread]: 
[0m12:03:49.024898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:49.025159 [info ] [MainThread]: 
[0m12:03:49.025434 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:03:49.025848 [debug] [MainThread]: Command `cli run` succeeded at 12:03:49.025777 after 3.18 seconds
[0m12:03:49.026120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106687bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10117b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010e7150>]}
[0m12:03:49.026381 [debug] [MainThread]: Flushing usage events
[0m12:04:19.488881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086266d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863af90>]}


============================== 12:04:19.490773 | dd0c439a-2fed-459e-bdfa-10273f3fecda ==============================
[0m12:04:19.490773 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:04:19.491102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:04:19.501948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd0c439a-2fed-459e-bdfa-10273f3fecda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863add0>]}
[0m12:04:19.502845 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-rowxftm7'
[0m12:04:19.503080 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:04:19.784785 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:04:19.787053 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:04:19.941425 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:04:19.944758 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:04:20.111546 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:04:20.116845 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=0.8.0', '<2.0.0', '>=0.7.0', '<0.8.0']
[0m12:04:20.118131 [debug] [MainThread]: Command `dbt deps` failed at 12:04:20.117945 after 0.64 seconds
[0m12:04:20.118622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108674fd0>]}
[0m12:04:20.119097 [debug] [MainThread]: Flushing usage events
[0m12:04:57.350270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108705a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108706a90>]}


============================== 12:04:57.352008 | 8565cd6b-c7c5-4251-86b6-31a31aaf6088 ==============================
[0m12:04:57.352008 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:04:57.352346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:04:57.361025 [error] [MainThread]: Encountered an error:
'version'
[0m12:04:57.363518 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 125, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 158, in wrapper
    project = load_project(
              ^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/runtime.py", line 49, in load_project
    project = Project.from_project_root(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 675, in from_project_root
    return partial.render(renderer)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 288, in render
    return self.create_project(rendered)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 427, in create_project
    packages = package_config_from_data(rendered.packages_dict)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/config/project.py", line 111, in package_config_from_data
    PackageConfig.validate(packages_data)
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/contracts/project.py", line 102, in validate
    if not package["version"]:
           ~~~~~~~^^^^^^^^^^^
KeyError: 'version'

[0m12:04:57.364196 [debug] [MainThread]: Command `dbt deps` failed at 12:04:57.364108 after 0.02 seconds
[0m12:04:57.364403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bcfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc2e50>]}
[0m12:04:57.364594 [debug] [MainThread]: Flushing usage events
[0m12:05:34.771122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a53990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66e90>]}


============================== 12:05:34.772948 | a571a621-e156-4da8-9ba1-41dc70fb30c4 ==============================
[0m12:05:34.772948 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:05:34.773305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:05:34.784465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a571a621-e156-4da8-9ba1-41dc70fb30c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a67250>]}
[0m12:05:34.785434 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-083cwfvx'
[0m12:05:34.785666 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:05:35.078081 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:05:35.081916 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:05:35.250681 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:05:35.252960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:05:35.416657 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:05:35.421767 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['>=0.8.0', '<2.0.0', '>=0.7.0', '<0.8.0']
[0m12:05:35.423043 [debug] [MainThread]: Command `dbt deps` failed at 12:05:35.422644 after 0.66 seconds
[0m12:05:35.423666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a49710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a66c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa0fd0>]}
[0m12:05:35.424177 [debug] [MainThread]: Flushing usage events
[0m12:06:17.877137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3ef50>]}


============================== 12:06:17.878960 | 32d73340-b75e-441a-9326-761272dd7abb ==============================
[0m12:06:17.878960 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:06:17.879277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:06:17.890315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32d73340-b75e-441a-9326-761272dd7abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429ba90>]}
[0m12:06:17.891288 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-bu0jap77'
[0m12:06:17.891563 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:06:18.168304 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:06:18.172242 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:06:18.337395 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:06:18.342190 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:06:18.519684 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:06:18.531552 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: >=0.7.0, <0.8.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m12:06:18.532647 [debug] [MainThread]: Command `dbt deps` failed at 12:06:18.532492 after 0.66 seconds
[0m12:06:18.533063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d215d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023fae90>]}
[0m12:06:18.533465 [debug] [MainThread]: Flushing usage events
[0m12:07:05.783712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a66850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a70250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7acd0>]}


============================== 12:07:05.785467 | a872e5d7-08ba-434c-a678-3eaa0eda4925 ==============================
[0m12:07:05.785467 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:07:05.785785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:07:05.796654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a872e5d7-08ba-434c-a678-3eaa0eda4925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7a6d0>]}
[0m12:07:05.797770 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-p8_gse_t'
[0m12:07:05.797988 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:07:06.045880 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:07:06.049240 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:07:06.205391 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:07:06.209325 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:07:06.377284 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:07:06.393937 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m12:07:06.749812 [info ] [MainThread]: Installed from version 0.9.0
[0m12:07:06.750243 [info ] [MainThread]: Up to date!
[0m12:07:06.750691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a872e5d7-08ba-434c-a678-3eaa0eda4925', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a89f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aacc50>]}
[0m12:07:06.751074 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:07:07.235728 [info ] [MainThread]: Installed from version 1.1.1
[0m12:07:07.236009 [info ] [MainThread]: Up to date!
[0m12:07:07.236268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a872e5d7-08ba-434c-a678-3eaa0eda4925', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a79310>]}
[0m12:07:07.236998 [debug] [MainThread]: Command `dbt deps` succeeded at 12:07:07.236931 after 1.46 seconds
[0m12:07:07.237210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dcb510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eac310>]}
[0m12:07:07.237385 [debug] [MainThread]: Flushing usage events
[0m12:07:34.033610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722b90>]}


============================== 12:07:34.035455 | 27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46 ==============================
[0m12:07:34.035455 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:07:34.035764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:07:34.046682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104722a10>]}
[0m12:07:34.047394 [debug] [MainThread]: Set downloads directory='/var/folders/3n/z5bw_fy124bgpdchnz83c1jm0000gn/T/dbt-downloads-4902y0l5'
[0m12:07:34.047620 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:07:34.321928 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:07:34.325466 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:07:34.489871 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:07:34.494171 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:07:34.660746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:07:34.666475 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:07:34.836828 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:07:34.853504 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m12:07:35.193835 [info ] [MainThread]: Installed from version 0.9.0
[0m12:07:35.194183 [info ] [MainThread]: Up to date!
[0m12:07:35.194517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104755390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f150>]}
[0m12:07:35.194806 [info ] [MainThread]: Installing dbt-labs/codegen
[0m12:07:35.535356 [info ] [MainThread]: Installed from version 0.10.0
[0m12:07:35.535710 [info ] [MainThread]: Up to date!
[0m12:07:35.536003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f150>]}
[0m12:07:35.536293 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:07:35.985144 [info ] [MainThread]: Installed from version 1.1.1
[0m12:07:35.985430 [info ] [MainThread]: Up to date!
[0m12:07:35.985666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27aec94d-fb5f-43e7-bc4a-4f2bddbc2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475f050>]}
[0m12:07:35.986482 [debug] [MainThread]: Command `dbt deps` succeeded at 12:07:35.986406 after 1.96 seconds
[0m12:07:35.986703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c97510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e6f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034893d0>]}
[0m12:07:35.986901 [debug] [MainThread]: Flushing usage events
[0m12:10:02.406890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108652910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108653010>]}


============================== 12:10:02.408697 | 93f47183-5619-4417-9cfd-3afef2cbdb0d ==============================
[0m12:10:02.408697 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:10:02.409029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:02.527439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b5b50>]}
[0m12:10:02.533605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108666190>]}
[0m12:10:02.533984 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:10:02.551568 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:10:02.556613 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:10:02.556870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108697dd0>]}
[0m12:10:02.923272 [debug] [MainThread]: 1699: static parser successfully parsed legacy/fct_customer_orders.sql
[0m12:10:02.928743 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m12:10:02.966738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:10:02.968812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fae010>]}
[0m12:10:02.972430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094aa010>]}
[0m12:10:02.972614 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:10:02.972779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93f47183-5619-4417-9cfd-3afef2cbdb0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108652fd0>]}
[0m12:10:02.973354 [info ] [MainThread]: 
[0m12:10:02.973527 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:10:02.973739 [debug] [MainThread]: Command end result
[0m12:10:02.977135 [debug] [MainThread]: Command `cli run` succeeded at 12:10:02.977086 after 0.58 seconds
[0m12:10:02.977306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108659bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0f2d0>]}
[0m12:10:02.977448 [debug] [MainThread]: Flushing usage events
[0m12:10:22.442462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ef5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043db2d0>]}


============================== 12:10:22.444420 | 7d7eb559-d4d9-4135-995b-197452ba2cdf ==============================
[0m12:10:22.444420 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:10:22.444743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:22.544765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104407b10>]}
[0m12:10:22.550971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5c9d0>]}
[0m12:10:22.551275 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:10:22.568671 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:10:22.585550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:10:22.585717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:10:22.585954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:10:22.588568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf28d0>]}
[0m12:10:22.592678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdbd90>]}
[0m12:10:22.592890 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:10:22.593058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7eb559-d4d9-4135-995b-197452ba2cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102165350>]}
[0m12:10:22.593586 [info ] [MainThread]: 
[0m12:10:22.593754 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:10:22.593966 [debug] [MainThread]: Command end result
[0m12:10:22.597230 [debug] [MainThread]: Command `cli test` succeeded at 12:10:22.597184 after 0.16 seconds
[0m12:10:22.597400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b4bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100abb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100abb2d0>]}
[0m12:10:22.597543 [debug] [MainThread]: Flushing usage events
[0m12:16:19.220044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108007510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108007d50>]}


============================== 12:16:19.222392 | 74b03960-0259-4d11-9058-300327a785ad ==============================
[0m12:16:19.222392 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:16:19.222706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:16:19.336927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff9b50>]}
[0m12:16:19.343014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108023dd0>]}
[0m12:16:19.343345 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:16:19.361178 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:16:19.383351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:19.383643 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://analyses/compare_queries.sql
[0m12:16:19.411593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:16:19.413970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f98e90>]}
[0m12:16:19.418425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088595d0>]}
[0m12:16:19.418649 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:16:19.418822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d89250>]}
[0m12:16:19.419550 [info ] [MainThread]: 
[0m12:16:19.419895 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:19.420390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m12:16:19.425889 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m12:16:19.426069 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m12:16:19.426201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:20.182082 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:16:20.185612 [debug] [ThreadPool]: On list_analytics: Close
[0m12:16:20.311177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m12:16:20.319408 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m12:16:20.319767 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m12:16:20.320046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:20.953385 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m12:16:20.957999 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m12:16:21.084795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107699250>]}
[0m12:16:21.086339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:21.086911 [info ] [MainThread]: 
[0m12:16:21.093697 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m12:16:21.094447 [info ] [Thread-1 (]: 1 of 2 START sql view model DBT_AMOLEIRO.customer_orders ....................... [RUN]
[0m12:16:21.095431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m12:16:21.095862 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m12:16:21.097840 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m12:16:21.098570 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 12:16:21.096127 => 12:16:21.098388
[0m12:16:21.098891 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m12:16:21.123178 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.customer_orders"
[0m12:16:21.124968 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.customer_orders"
[0m12:16:21.125363 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
        Orders.USER_ID    as customer_id,
        Orders.ORDER_DATE AS order_placed_at,
            Orders.STATUS AS order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        C.FIRST_NAME    as customer_first_name,
            C.LAST_NAME as customer_last_name
    FROM raw.jaffle_shop.orders as Orders
    left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
from raw.stripe.payment
where STATUS <> 'fail'
group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
    as (select C.ID as customer_id
        , min(ORDER_DATE) as first_order_date
        , max(ORDER_DATE) as most_recent_order_date
        , count(ORDERS.ID) AS number_of_orders
    from raw.jaffle_shop.customers C 
    left join raw.jaffle_shop.orders as Orders
    on orders.USER_ID = C.ID 
    group by 1)

select
    p.*,
    ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
    CASE WHEN c.first_order_date = p.order_placed_at
    THEN 'new'
    ELSE 'return' END as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
    FROM paid_orders p
    left join customer_orders as c USING (customer_id)
    LEFT OUTER JOIN 
    (
            select
            p.order_id,
            sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x on x.order_id = p.order_id
    ORDER BY order_id
  );
[0m12:16:21.125675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:21.799392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:21.813071 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 12:16:21.099094 => 12:16:21.812957
[0m12:16:21.813317 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: Close
[0m12:16:21.923788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967b010>]}
[0m12:16:21.924569 [info ] [Thread-1 (]: 1 of 2 OK created sql view model DBT_AMOLEIRO.customer_orders .................. [[32mSUCCESS 1[0m in 0.83s]
[0m12:16:21.925320 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m12:16:21.925801 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:21.926401 [info ] [Thread-1 (]: 2 of 2 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m12:16:21.927261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.customer_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m12:16:21.927621 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:21.929361 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:16:21.931066 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 12:16:21.927836 => 12:16:21.930869
[0m12:16:21.931419 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:21.934941 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:16:21.937265 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m12:16:21.937662 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
        Orders.USER_ID    as customer_id,
        Orders.ORDER_DATE AS order_placed_at,
            Orders.STATUS AS order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        C.FIRST_NAME    as customer_first_name,
            C.LAST_NAME as customer_last_name
    FROM raw.jaffle_shop.orders as Orders
    left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
from raw.stripe.payment
where STATUS <> 'fail'
group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
    as (select C.ID as customer_id
        , min(ORDER_DATE) as first_order_date
        , max(ORDER_DATE) as most_recent_order_date
        , count(ORDERS.ID) AS number_of_orders
    from raw.jaffle_shop.customers C 
    left join raw.jaffle_shop.orders as Orders
    on orders.USER_ID = C.ID 
    group by 1)

select
    p.*,
    ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
    CASE WHEN c.first_order_date = p.order_placed_at
    THEN 'new'
    ELSE 'return' END as nvsr,
    x.clv_bad as customer_lifetime_value,
    c.first_order_date as fdos
    FROM paid_orders p
    left join customer_orders as c USING (customer_id)
    LEFT OUTER JOIN 
    (
            select
            p.order_id,
            sum(t2.total_amount_paid) as clv_bad
        from paid_orders p
        left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
        group by 1
        order by p.order_id
    ) x on x.order_id = p.order_id
    ORDER BY order_id
  );
[0m12:16:21.938043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:22.825680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:22.832336 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 12:16:21.931631 => 12:16:22.832143
[0m12:16:22.832724 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m12:16:22.943381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b03960-0259-4d11-9058-300327a785ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d07fd0>]}
[0m12:16:22.944116 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 1.02s]
[0m12:16:22.944837 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m12:16:22.946518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:22.946784 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m12:16:22.947067 [info ] [MainThread]: 
[0m12:16:22.947406 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m12:16:22.948122 [debug] [MainThread]: Command end result
[0m12:16:22.955919 [info ] [MainThread]: 
[0m12:16:22.956266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:22.956519 [info ] [MainThread]: 
[0m12:16:22.956788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:16:22.957299 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:22.957227 after 3.75 seconds
[0m12:16:22.957586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466c310>]}
[0m12:16:22.957850 [debug] [MainThread]: Flushing usage events
[0m12:17:01.920307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106143290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106152350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106153a10>]}


============================== 12:17:01.922740 | 37c2af2a-0354-464e-a586-8d46bc1ee3b4 ==============================
[0m12:17:01.922740 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:17:01.923045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:17:02.039394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614fd10>]}
[0m12:17:02.045483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616c4d0>]}
[0m12:17:02.045842 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:17:02.065301 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:17:02.089728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:02.089932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:02.090177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m12:17:02.093013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dec50>]}
[0m12:17:02.096747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106934dd0>]}
[0m12:17:02.096955 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:17:02.097127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec9250>]}
[0m12:17:02.097815 [info ] [MainThread]: 
[0m12:17:02.098178 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:17:02.098657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m12:17:02.104701 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m12:17:02.104886 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m12:17:02.105008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:02.889339 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m12:17:02.893447 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m12:17:03.012434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c2af2a-0354-464e-a586-8d46bc1ee3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106903a10>]}
[0m12:17:03.013659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:17:03.014124 [info ] [MainThread]: 
[0m12:17:03.019493 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m12:17:03.020274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m12:17:03.020650 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m12:17:03.022843 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m12:17:03.023698 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 12:17:03.020884 => 12:17:03.023471
[0m12:17:03.024053 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m12:17:03.024438 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 12:17:03.024266 => 12:17:03.024281
[0m12:17:03.025314 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m12:17:03.025617 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.026223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.customer_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m12:17:03.026559 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.028824 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m12:17:03.029348 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 12:17:03.026752 => 12:17:03.029203
[0m12:17:03.029611 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.029932 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 12:17:03.029783 => 12:17:03.029790
[0m12:17:03.030586 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m12:17:03.031052 [debug] [Thread-1 (]: Began running node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.031609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.fct_customer_orders, now analysis.refactoring_for_modularity.compare_queries)
[0m12:17:03.031862 [debug] [Thread-1 (]: Began compiling node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.049189 [debug] [Thread-1 (]: Using snowflake connection "analysis.refactoring_for_modularity.compare_queries"
[0m12:17:03.049458 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "analysis.refactoring_for_modularity.compare_queries"} */
describe table analytics.DBT_AMOLEIRO.customer_orders
[0m12:17:03.049658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:03.600398 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.0 seconds
[0m12:17:03.615755 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.refactoring_for_modularity.compare_queries"
[0m12:17:03.616787 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (compile): 12:17:03.032028 => 12:17:03.616573
[0m12:17:03.617133 [debug] [Thread-1 (]: Began executing node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.617515 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (execute): 12:17:03.617350 => 12:17:03.617366
[0m12:17:03.617843 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: Close
[0m12:17:03.734303 [debug] [Thread-1 (]: Finished running node analysis.refactoring_for_modularity.compare_queries
[0m12:17:03.736095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:03.736525 [debug] [MainThread]: Connection 'analysis.refactoring_for_modularity.compare_queries' was properly closed.
[0m12:17:03.737781 [debug] [MainThread]: Command end result
[0m12:17:03.750505 [debug] [MainThread]: Command `dbt compile` succeeded at 12:17:03.750370 after 1.84 seconds
[0m12:17:03.750930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061630d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106163190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026cb510>]}
[0m12:17:03.751313 [debug] [MainThread]: Flushing usage events
[0m12:36:18.912304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613b2d0>]}


============================== 12:36:18.914783 | 04288725-dc50-441d-87cc-2f1ad19e1916 ==============================
[0m12:36:18.914783 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:36:18.915096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:36:19.034050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04288725-dc50-441d-87cc-2f1ad19e1916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106141ed0>]}
[0m12:36:19.040112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04288725-dc50-441d-87cc-2f1ad19e1916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106176010>]}
[0m12:36:19.040441 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m12:36:19.058435 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:36:19.065113 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading refactoring_for_modularity: staging/jaffle_shop/sources.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  | - name: jaffle_shop
    5  |     database: raw
    6  |     tables:
    7  |     - name: customers
    8  |     - name: orders
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 13
[0m12:36:19.065471 [debug] [MainThread]: Command `cli build` failed at 12:36:19.065415 after 0.16 seconds
[0m12:36:19.065662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281b190>]}
[0m12:36:19.065845 [debug] [MainThread]: Flushing usage events
[0m17:22:13.830330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104063d50>]}


============================== 17:22:13.832364 | 1fcc4e0a-481c-4d26-8f25-0bf0cacc581a ==============================
[0m17:22:13.832364 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:22:13.832680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:22:13.937013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104058d50>]}
[0m17:22:13.943138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031d9110>]}
[0m17:22:13.943413 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:22:13.960573 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:22:13.966496 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:22:13.966749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a0fd0>]}
[0m17:22:14.343283 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:22:14.348908 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:22:14.350402 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:22:14.351985 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:22:14.353412 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:22:14.399755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:22:14.402004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1ddd0>]}
[0m17:22:14.405806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104906b90>]}
[0m17:22:14.406001 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:22:14.406676 [info ] [MainThread]: 
[0m17:22:14.407009 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:14.407463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:22:14.413462 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:22:14.413679 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:22:14.413803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:15.274248 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:22:15.277706 [debug] [ThreadPool]: On list_analytics: Close
[0m17:22:15.403776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:22:15.415738 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:22:15.416245 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:22:15.416582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:15.822363 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m17:22:15.826599 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:22:15.949122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b8090>]}
[0m17:22:15.950228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:15.950689 [info ] [MainThread]: 
[0m17:22:15.956510 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_payment
[0m17:22:15.957057 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_payment ........................... [RUN]
[0m17:22:15.957802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_payment)
[0m17:22:15.958122 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_payment
[0m17:22:15.964834 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_payment"
[0m17:22:15.965675 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (compile): 17:22:15.958334 => 17:22:15.965513
[0m17:22:15.965957 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_payment
[0m17:22:15.985331 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_payment"
[0m17:22:15.986082 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_payment"
[0m17:22:15.986304 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_payment"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_payment
  
   as (
    with source as (
    select * from raw.stripe.payment
)

transform as (
    select
        orderid as order_id,
        created,
        amount
)

select * from transform
  );
[0m17:22:15.986496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:16.331657 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adf436-0000-22b4-0000-58990001002a
[0m17:22:16.332133 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 0 unexpected 'transform'.
syntax error line 15 at position 0 unexpected 'select'.
[0m17:22:16.332674 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (execute): 17:22:15.966123 => 17:22:16.332491
[0m17:22:16.333020 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: Close
[0m17:22:16.447914 [debug] [Thread-1 (]: Database Error in model stg_payment (models/staging/stripe/stg_payment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 0 unexpected 'transform'.
  syntax error line 15 at position 0 unexpected 'select'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_payment.sql
[0m17:22:16.448621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fcc4e0a-481c-4d26-8f25-0bf0cacc581a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5c490>]}
[0m17:22:16.449369 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_payment .................. [[31mERROR[0m in 0.49s]
[0m17:22:16.449990 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_payment
[0m17:22:16.451864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:16.452187 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_payment' was properly closed.
[0m17:22:16.452506 [info ] [MainThread]: 
[0m17:22:16.452892 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m17:22:16.453532 [debug] [MainThread]: Command end result
[0m17:22:16.463641 [info ] [MainThread]: 
[0m17:22:16.464070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:16.464343 [info ] [MainThread]: 
[0m17:22:16.464606 [error] [MainThread]: [33mDatabase Error in model stg_payment (models/staging/stripe/stg_payment.sql)[0m
[0m17:22:16.464857 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m17:22:16.465093 [error] [MainThread]:   syntax error line 8 at position 0 unexpected 'transform'.
[0m17:22:16.465329 [error] [MainThread]:   syntax error line 15 at position 0 unexpected 'select'.
[0m17:22:16.465561 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_payment.sql
[0m17:22:16.465799 [info ] [MainThread]: 
[0m17:22:16.466068 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:22:16.466487 [debug] [MainThread]: Command `cli build` failed at 17:22:16.466412 after 2.65 seconds
[0m17:22:16.466776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104058050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10072f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104883fd0>]}
[0m17:22:16.467041 [debug] [MainThread]: Flushing usage events
[0m17:22:36.170199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104086850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407fb90>]}


============================== 17:22:36.172320 | f6bb852c-23f3-45e7-9835-ee6195b4290a ==============================
[0m17:22:36.172320 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:22:36.172652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:22:36.275885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104097b50>]}
[0m17:22:36.282004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047edf10>]}
[0m17:22:36.282292 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:22:36.299632 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:22:36.305414 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:22:36.305715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac5350>]}
[0m17:22:36.679570 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:22:36.685324 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:22:36.686876 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:22:36.688387 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:22:36.689941 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:22:36.736534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:22:36.738737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104893350>]}
[0m17:22:36.742633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e9110>]}
[0m17:22:36.742814 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:22:36.743468 [info ] [MainThread]: 
[0m17:22:36.743814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:36.744226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:22:36.749973 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:22:36.750234 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:22:36.750372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:37.408906 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:22:37.412461 [debug] [ThreadPool]: On list_analytics: Close
[0m17:22:37.526411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:22:37.538146 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:22:37.538676 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:22:37.539035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:38.098088 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m17:22:38.101925 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:22:38.226668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101df98d0>]}
[0m17:22:38.227463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:38.227824 [info ] [MainThread]: 
[0m17:22:38.231506 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_customers
[0m17:22:38.232026 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_customers ......................... [RUN]
[0m17:22:38.232731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_customers)
[0m17:22:38.233072 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_customers
[0m17:22:38.239471 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_customers"
[0m17:22:38.240463 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_customers (compile): 17:22:38.233278 => 17:22:38.240269
[0m17:22:38.240756 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_customers
[0m17:22:38.259865 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_customers"
[0m17:22:38.260741 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_customers"
[0m17:22:38.261003 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.customers
),

transform as (
    select
        id as customer_id,
        first_name as customer_first_name,
        last_name as customer_last_name
    from source
),

select * from transform
  );
[0m17:22:38.261213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:38.900396 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adf436-0000-228a-0000-00005899c16d
[0m17:22:38.900789 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 0 unexpected 'select'.
[0m17:22:38.901242 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_customers (execute): 17:22:38.240928 => 17:22:38.901092
[0m17:22:38.901529 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_customers: Close
[0m17:22:39.018404 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/jaffle_shop/stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 0 unexpected 'select'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_customers.sql
[0m17:22:39.018995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6bb852c-23f3-45e7-9835-ee6195b4290a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a6950>]}
[0m17:22:39.019581 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_customers ................ [[31mERROR[0m in 0.79s]
[0m17:22:39.020097 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_customers
[0m17:22:39.021510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:39.021770 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_customers' was properly closed.
[0m17:22:39.022033 [info ] [MainThread]: 
[0m17:22:39.022319 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m17:22:39.022754 [debug] [MainThread]: Command end result
[0m17:22:39.031329 [info ] [MainThread]: 
[0m17:22:39.031651 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:39.031883 [info ] [MainThread]: 
[0m17:22:39.032100 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/staging/jaffle_shop/stg_customers.sql)[0m
[0m17:22:39.032316 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m17:22:39.032515 [error] [MainThread]:   syntax error line 16 at position 0 unexpected 'select'.
[0m17:22:39.032719 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_customers.sql
[0m17:22:39.032924 [info ] [MainThread]: 
[0m17:22:39.033145 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:22:39.033615 [debug] [MainThread]: Command `cli build` failed at 17:22:39.033520 after 2.87 seconds
[0m17:22:39.033905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10074b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10074b390>]}
[0m17:22:39.034174 [debug] [MainThread]: Flushing usage events
[0m17:23:08.888291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d67610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6be50>]}


============================== 17:23:08.890102 | 74db4d96-53c3-4f4e-8d58-8b34552735ba ==============================
[0m17:23:08.890102 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:23:08.890438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:23:08.994553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d67ad0>]}
[0m17:23:09.000671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104dd2d0>]}
[0m17:23:09.000943 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:23:09.017967 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:23:09.024116 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:23:09.024374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083d410>]}
[0m17:23:09.399845 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:23:09.405459 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:23:09.406980 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:23:09.408587 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:23:09.410126 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:23:09.457301 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:23:09.459536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca9d90>]}
[0m17:23:09.463471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107bbc10>]}
[0m17:23:09.463658 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:23:09.464300 [info ] [MainThread]: 
[0m17:23:09.464634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:09.465097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:23:09.470677 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:23:09.470849 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:23:09.470963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:10.128645 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:23:10.132040 [debug] [ThreadPool]: On list_analytics: Close
[0m17:23:10.248621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:23:10.256484 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:23:10.256869 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:23:10.257143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:10.646849 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m17:23:10.648975 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:23:10.769380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f4750>]}
[0m17:23:10.770118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:10.770472 [info ] [MainThread]: 
[0m17:23:10.773786 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_customers
[0m17:23:10.774209 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_customers ......................... [RUN]
[0m17:23:10.774799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_customers)
[0m17:23:10.775082 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_customers
[0m17:23:10.781098 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_customers"
[0m17:23:10.781777 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_customers (compile): 17:23:10.775260 => 17:23:10.781632
[0m17:23:10.782083 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_customers
[0m17:23:10.800626 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_customers"
[0m17:23:10.801323 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_customers"
[0m17:23:10.801543 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.customers
),

transform as (
    select
        id as customer_id,
        first_name as customer_first_name,
        last_name as customer_last_name
    from source
)

select * from transform
  );
[0m17:23:10.801750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:11.345492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:23:11.368733 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_customers (execute): 17:23:10.782235 => 17:23:11.368560
[0m17:23:11.369080 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_customers: Close
[0m17:23:11.478066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74db4d96-53c3-4f4e-8d58-8b34552735ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cc70d0>]}
[0m17:23:11.479283 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_customers .................... [[32mSUCCESS 1[0m in 0.70s]
[0m17:23:11.480201 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_customers
[0m17:23:11.482495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:11.482854 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_customers' was properly closed.
[0m17:23:11.483225 [info ] [MainThread]: 
[0m17:23:11.483654 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m17:23:11.484472 [debug] [MainThread]: Command end result
[0m17:23:11.496863 [info ] [MainThread]: 
[0m17:23:11.497472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:11.497807 [info ] [MainThread]: 
[0m17:23:11.498129 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:23:11.498588 [debug] [MainThread]: Command `cli build` succeeded at 17:23:11.498504 after 2.62 seconds
[0m17:23:11.498897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c57a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc7210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc7350>]}
[0m17:23:11.499224 [debug] [MainThread]: Flushing usage events
[0m17:23:28.322580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bfed0>]}


============================== 17:23:28.324419 | 43042d50-75c5-4ba8-a2fb-9ac9bb205c27 ==============================
[0m17:23:28.324419 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:23:28.324741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:23:28.428110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bbb90>]}
[0m17:23:28.434241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106832910>]}
[0m17:23:28.434515 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:23:28.452102 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:23:28.457997 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:23:28.458262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afcfd0>]}
[0m17:23:28.830146 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:23:28.835751 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:23:28.837261 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:23:28.838848 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:23:28.840278 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:23:28.886532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:23:28.888677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f77f10>]}
[0m17:23:28.892606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f86fd0>]}
[0m17:23:28.892792 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:23:28.893465 [info ] [MainThread]: 
[0m17:23:28.893800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:28.894255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:23:28.900044 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:23:28.900203 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:23:28.900321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:29.543253 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:23:29.546718 [debug] [ThreadPool]: On list_analytics: Close
[0m17:23:29.711695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:23:29.720332 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:23:29.720699 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:23:29.720983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:30.314611 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m17:23:30.316607 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:23:30.438823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078da410>]}
[0m17:23:30.440270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:30.440887 [info ] [MainThread]: 
[0m17:23:30.446246 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_orders
[0m17:23:30.446941 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_orders ............................ [RUN]
[0m17:23:30.447867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_orders)
[0m17:23:30.448275 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_orders
[0m17:23:30.457019 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_orders"
[0m17:23:30.457817 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_orders (compile): 17:23:30.448551 => 17:23:30.457617
[0m17:23:30.458155 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_orders
[0m17:23:30.479344 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_orders"
[0m17:23:30.480142 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_orders"
[0m17:23:30.480399 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_orders
  
   as (
    with source as (
    select * from raw.jaffle_shop.orders
),

transform as (
    select
        id as order_id,
        user_id as customer_id,
        order_date as order_placed_at,
        status as order_status
    source
)

select * from transform
  );
[0m17:23:30.480620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:30.832943 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adf437-0000-22b4-0000-58990001003a
[0m17:23:30.833164 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 4 unexpected 'source'.
[0m17:23:30.833430 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_orders (execute): 17:23:30.458363 => 17:23:30.833329
[0m17:23:30.833587 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_orders: Close
[0m17:23:30.950694 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/jaffle_shop/stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 4 unexpected 'source'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_orders.sql
[0m17:23:30.950943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43042d50-75c5-4ba8-a2fb-9ac9bb205c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f84a90>]}
[0m17:23:30.951204 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_orders ................... [[31mERROR[0m in 0.50s]
[0m17:23:30.951436 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_orders
[0m17:23:30.952153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:30.952266 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_orders' was properly closed.
[0m17:23:30.952383 [info ] [MainThread]: 
[0m17:23:30.952529 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m17:23:30.952763 [debug] [MainThread]: Command end result
[0m17:23:30.957188 [info ] [MainThread]: 
[0m17:23:30.957382 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:23:30.957518 [info ] [MainThread]: 
[0m17:23:30.957654 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/staging/jaffle_shop/stg_orders.sql)[0m
[0m17:23:30.957792 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m17:23:30.957923 [error] [MainThread]:   syntax error line 14 at position 4 unexpected 'source'.
[0m17:23:30.958049 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/jaffle_shop/stg_orders.sql
[0m17:23:30.958180 [info ] [MainThread]: 
[0m17:23:30.958323 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:23:30.958549 [debug] [MainThread]: Command `cli build` failed at 17:23:30.958510 after 2.65 seconds
[0m17:23:30.958713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10288b210>]}
[0m17:23:30.958853 [debug] [MainThread]: Flushing usage events
[0m17:23:40.059970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e22850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1bf90>]}


============================== 17:23:40.061804 | b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa ==============================
[0m17:23:40.061804 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:23:40.062129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:23:40.164392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e33fd0>]}
[0m17:23:40.170489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448f010>]}
[0m17:23:40.170766 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:23:40.187940 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:23:40.193753 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:23:40.194012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104758a50>]}
[0m17:23:40.570866 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:23:40.576496 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:23:40.577983 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:23:40.579546 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:23:40.581167 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:23:40.628940 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:23:40.631145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd5f50>]}
[0m17:23:40.635019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d1190>]}
[0m17:23:40.635229 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:23:40.635837 [info ] [MainThread]: 
[0m17:23:40.636165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:40.636582 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:23:40.642025 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:23:40.642180 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:23:40.642316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:41.289519 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:23:41.292245 [debug] [ThreadPool]: On list_analytics: Close
[0m17:23:41.402748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:23:41.412704 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:23:41.413101 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:23:41.413387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:41.807785 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m17:23:41.809976 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:23:41.926473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046df850>]}
[0m17:23:41.927431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:41.927877 [info ] [MainThread]: 
[0m17:23:41.931957 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_orders
[0m17:23:41.932475 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_orders ............................ [RUN]
[0m17:23:41.933209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_orders)
[0m17:23:41.933540 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_orders
[0m17:23:41.940748 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_orders"
[0m17:23:41.941676 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_orders (compile): 17:23:41.933753 => 17:23:41.941469
[0m17:23:41.941968 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_orders
[0m17:23:41.961733 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_orders"
[0m17:23:41.962477 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_orders"
[0m17:23:41.962704 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_orders
  
   as (
    with source as (
    select * from raw.jaffle_shop.orders
),

transform as (
    select
        id as order_id,
        user_id as customer_id,
        order_date as order_placed_at,
        status as order_status
    from source
)

select * from transform
  );
[0m17:23:41.962911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:42.449224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:23:42.478853 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_orders (execute): 17:23:41.942142 => 17:23:42.478668
[0m17:23:42.479283 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_orders: Close
[0m17:23:42.611961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0c5a7c4-fbd6-4a86-a8f0-c285dff226fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ca8d0>]}
[0m17:23:42.613049 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_orders ....................... [[32mSUCCESS 1[0m in 0.68s]
[0m17:23:42.613960 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_orders
[0m17:23:42.615783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:42.616129 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_orders' was properly closed.
[0m17:23:42.616455 [info ] [MainThread]: 
[0m17:23:42.616854 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m17:23:42.617622 [debug] [MainThread]: Command end result
[0m17:23:42.628084 [info ] [MainThread]: 
[0m17:23:42.628437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:42.628697 [info ] [MainThread]: 
[0m17:23:42.628969 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:23:42.629367 [debug] [MainThread]: Command `cli build` succeeded at 17:23:42.629297 after 2.58 seconds
[0m17:23:42.629642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100577b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1004e7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1004e7350>]}
[0m17:23:42.629909 [debug] [MainThread]: Flushing usage events
[0m17:23:57.901825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086eb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086eb890>]}


============================== 17:23:57.903665 | 7d7e3833-4dcc-4323-8ece-ff97329bae1c ==============================
[0m17:23:57.903665 [info ] [MainThread]: Running with dbt=1.5.4
[0m17:23:57.904015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:23:58.005562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921a410>]}
[0m17:23:58.011919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f09d0>]}
[0m17:23:58.012232 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m17:23:58.029478 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m17:23:58.035408 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:23:58.035672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cb110>]}
[0m17:23:58.406455 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m17:23:58.411993 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m17:23:58.413448 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m17:23:58.414925 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m17:23:58.416504 [debug] [MainThread]: 1699: static parser successfully parsed legacy/customer_orders.sql
[0m17:23:58.462438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m17:23:58.464623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc7f10>]}
[0m17:23:58.468439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a645210>]}
[0m17:23:58.468623 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:23:58.469318 [info ] [MainThread]: 
[0m17:23:58.469656 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:58.470067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m17:23:58.475870 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m17:23:58.476033 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m17:23:58.476147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:59.102542 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m17:23:59.105716 [debug] [ThreadPool]: On list_analytics: Close
[0m17:23:59.218466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m17:23:59.223448 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m17:23:59.223700 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m17:23:59.223893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:59.570373 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m17:23:59.574588 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m17:23:59.696118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080086d0>]}
[0m17:23:59.697710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:59.698250 [info ] [MainThread]: 
[0m17:23:59.703698 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_payment
[0m17:23:59.704433 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_payment ........................... [RUN]
[0m17:23:59.705362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_payment)
[0m17:23:59.705771 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_payment
[0m17:23:59.713577 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_payment"
[0m17:23:59.714508 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (compile): 17:23:59.706038 => 17:23:59.714309
[0m17:23:59.714867 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_payment
[0m17:23:59.736271 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_payment"
[0m17:23:59.737015 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_payment"
[0m17:23:59.737238 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_payment"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_payment
  
   as (
    with source as (
    select * from raw.stripe.payment
),

transform as (
    select
        orderid as order_id,
        created,
        amount
    from source
)

select * from transform
  );
[0m17:23:59.737432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:00.188356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:24:00.197877 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (execute): 17:23:59.715071 => 17:24:00.197788
[0m17:24:00.198082 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: Close
[0m17:24:00.314113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d7e3833-4dcc-4323-8ece-ff97329bae1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a563710>]}
[0m17:24:00.314505 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_payment ...................... [[32mSUCCESS 1[0m in 0.61s]
[0m17:24:00.314799 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_payment
[0m17:24:00.315517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:00.315640 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_payment' was properly closed.
[0m17:24:00.315763 [info ] [MainThread]: 
[0m17:24:00.315909 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m17:24:00.316184 [debug] [MainThread]: Command end result
[0m17:24:00.320538 [info ] [MainThread]: 
[0m17:24:00.320744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:00.320893 [info ] [MainThread]: 
[0m17:24:00.321049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:24:00.321281 [debug] [MainThread]: Command `cli build` succeeded at 17:24:00.321242 after 2.43 seconds
[0m17:24:00.321426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3bb50>]}
[0m17:24:00.321564 [debug] [MainThread]: Flushing usage events
[0m10:11:09.013769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a665ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a677690>]}


============================== 10:11:09.015570 | 9d135a99-fe6f-4ffb-acdb-8e2beb82e780 ==============================
[0m10:11:09.015570 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:11:09.015873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:11:09.121138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af7dc50>]}
[0m10:11:09.127130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af7c610>]}
[0m10:11:09.127411 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:11:09.144633 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:11:09.162671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:09.162849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:09.163149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:11:09.165942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcd6f50>]}
[0m10:11:09.169934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb30d0>]}
[0m10:11:09.170129 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:11:09.170774 [info ] [MainThread]: 
[0m10:11:09.171119 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:09.171546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:11:09.177256 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:11:09.177422 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:11:09.177557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:09.919868 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:11:09.925045 [debug] [ThreadPool]: On list_analytics: Close
[0m10:11:10.045105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:11:10.056255 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:11:10.056736 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:11:10.057076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:10.589401 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:11:10.591393 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:11:10.707404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd2f510>]}
[0m10:11:10.708911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:10.709454 [info ] [MainThread]: 
[0m10:11:10.715718 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_payment
[0m10:11:10.716401 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_payment ........................... [RUN]
[0m10:11:10.717276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_payment)
[0m10:11:10.717684 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_payment
[0m10:11:10.725073 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_payment"
[0m10:11:10.725874 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (compile): 10:11:10.717935 => 10:11:10.725679
[0m10:11:10.726204 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_payment
[0m10:11:10.747487 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_payment"
[0m10:11:10.748238 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_payment"
[0m10:11:10.748487 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_payment"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_payment
  
   as (
    with source as (
    select * from raw.stripe.payment
),

transform as (
    select 
        orderid as order_id,
        status as payment_status
        created,
        amount
    from source
)

select * from transform
  );
[0m10:11:10.748695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:11.105134 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adf827-0000-22c6-0000-58990001102a
[0m10:11:11.105750 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 8 unexpected 'created'.
syntax error line 14 at position 4 unexpected 'from'.
syntax error line 17 at position 0 unexpected 'select'.
[0m10:11:11.106461 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (execute): 10:11:10.726390 => 10:11:11.106226
[0m10:11:11.106864 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: Close
[0m10:11:11.220857 [debug] [Thread-1 (]: Database Error in model stg_payment (models/staging/stripe/stg_payment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected 'created'.
  syntax error line 14 at position 4 unexpected 'from'.
  syntax error line 17 at position 0 unexpected 'select'.
  compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_payment.sql
[0m10:11:11.221433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d135a99-fe6f-4ffb-acdb-8e2beb82e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce11e90>]}
[0m10:11:11.222049 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.stg_payment .................. [[31mERROR[0m in 0.50s]
[0m10:11:11.222557 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_payment
[0m10:11:11.224065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:11.224349 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_payment' was properly closed.
[0m10:11:11.224623 [info ] [MainThread]: 
[0m10:11:11.224958 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m10:11:11.225511 [debug] [MainThread]: Command end result
[0m10:11:11.232827 [info ] [MainThread]: 
[0m10:11:11.233256 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:11:11.233547 [info ] [MainThread]: 
[0m10:11:11.233820 [error] [MainThread]: [33mDatabase Error in model stg_payment (models/staging/stripe/stg_payment.sql)[0m
[0m10:11:11.234071 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m10:11:11.234443 [error] [MainThread]:   syntax error line 12 at position 8 unexpected 'created'.
[0m10:11:11.234705 [error] [MainThread]:   syntax error line 14 at position 4 unexpected 'from'.
[0m10:11:11.234914 [error] [MainThread]:   syntax error line 17 at position 0 unexpected 'select'.
[0m10:11:11.235115 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/staging/stripe/stg_payment.sql
[0m10:11:11.235326 [info ] [MainThread]: 
[0m10:11:11.235561 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:11:11.235939 [debug] [MainThread]: Command `cli build` failed at 10:11:11.235866 after 2.23 seconds
[0m10:11:11.236203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6838d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a683510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e72d0>]}
[0m10:11:11.236445 [debug] [MainThread]: Flushing usage events
[0m10:11:32.643544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c62850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6bf90>]}


============================== 10:11:32.645364 | db2b8859-eebc-4a8c-8aae-a76e01ca52f4 ==============================
[0m10:11:32.645364 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:11:32.645684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:11:32.748861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d71d0>]}
[0m10:11:32.754867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d71d0>]}
[0m10:11:32.755167 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:11:32.772740 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:11:32.790676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:11:32.790968 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/staging/stripe/stg_payment.sql
[0m10:11:32.800441 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payment.sql
[0m10:11:32.808144 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:11:32.810453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655ed50>]}
[0m10:11:32.814386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652b510>]}
[0m10:11:32.814579 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:11:32.815267 [info ] [MainThread]: 
[0m10:11:32.815611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:32.816103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:11:32.821523 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:11:32.821686 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:11:32.821828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:33.473796 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:11:33.476817 [debug] [ThreadPool]: On list_analytics: Close
[0m10:11:33.594622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:11:33.604432 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:11:33.604840 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:11:33.605134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:34.154709 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:11:34.159133 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:11:34.270051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9e450>]}
[0m10:11:34.271102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:34.271547 [info ] [MainThread]: 
[0m10:11:34.275616 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_payment
[0m10:11:34.276131 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_payment ........................... [RUN]
[0m10:11:34.276816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_payment)
[0m10:11:34.277151 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_payment
[0m10:11:34.285401 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_payment"
[0m10:11:34.286243 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (compile): 10:11:34.277361 => 10:11:34.286049
[0m10:11:34.286567 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_payment
[0m10:11:34.306154 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_payment"
[0m10:11:34.306849 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_payment"
[0m10:11:34.307074 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_payment"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_payment
  
   as (
    with source as (
    select * from raw.stripe.payment
),

transform as (
    select 
        orderid as order_id,
        status as payment_status,
        created,
        amount
    from source
)

select * from transform
  );
[0m10:11:34.307271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:34.825386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:11:34.854356 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_payment (execute): 10:11:34.286781 => 10:11:34.854163
[0m10:11:34.854764 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_payment: Close
[0m10:11:34.971651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2b8859-eebc-4a8c-8aae-a76e01ca52f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647de90>]}
[0m10:11:34.972819 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_payment ...................... [[32mSUCCESS 1[0m in 0.69s]
[0m10:11:34.973830 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_payment
[0m10:11:34.975805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:34.976192 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_payment' was properly closed.
[0m10:11:34.976539 [info ] [MainThread]: 
[0m10:11:34.976963 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m10:11:34.977730 [debug] [MainThread]: Command end result
[0m10:11:34.986944 [info ] [MainThread]: 
[0m10:11:34.987403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:34.987716 [info ] [MainThread]: 
[0m10:11:34.988043 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:11:34.988475 [debug] [MainThread]: Command `cli build` succeeded at 10:11:34.988406 after 2.35 seconds
[0m10:11:34.988756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023bfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10232f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10232f350>]}
[0m10:11:34.989034 [debug] [MainThread]: Flushing usage events
[0m10:45:15.783832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e96850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9b790>]}


============================== 10:45:15.785657 | f64c33be-9a83-4384-8028-4a989ac8e394 ==============================
[0m10:45:15.785657 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:45:15.785976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:45:15.888303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f64c33be-9a83-4384-8028-4a989ac8e394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104502b90>]}
[0m10:45:15.894355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f64c33be-9a83-4384-8028-4a989ac8e394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb0dd0>]}
[0m10:45:15.894614 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:45:15.911777 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:45:15.930666 [debug] [MainThread]: Partial parsing enabled: 8 files deleted, 12 files added, 0 files changed.
[0m10:45:15.930935 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/staging/stripe/sources.yml
[0m10:45:15.931078 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/stripe/sources.yml
[0m10:45:15.931223 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/staging/jaffle_shop/sources.yml
[0m10:45:15.931344 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/stripe/stg_payment.sql
[0m10:45:15.931453 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/stg_customers.sql
[0m10:45:15.931567 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/sources.yml
[0m10:45:15.931671 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/marts/fct_customer_orders.sql
[0m10:45:15.931777 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/stg_orders.sql
[0m10:45:15.931882 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:15.931986 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/marts/fct_customer_orders.sql
[0m10:45:15.932095 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/legacy/customer_orders.sql
[0m10:45:15.932242 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/process.md
[0m10:45:15.932388 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/stripe/stg_payment.sql
[0m10:45:15.932484 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/stg_orders.sql
[0m10:45:15.932575 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:15.932664 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/stg_customers.sql
[0m10:45:15.932781 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/legacy/customer_orders.sql
[0m10:45:15.932872 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m10:45:15.942389 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/stripe/stg_payment.sql
[0m10:45:15.948322 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/stg_customers.sql
[0m10:45:15.949790 [debug] [MainThread]: 1699: static parser successfully parsed exercise/marts/fct_customer_orders.sql
[0m10:45:15.951262 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/stg_orders.sql
[0m10:45:15.952728 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:15.954476 [debug] [MainThread]: 1699: static parser successfully parsed training/marts/fct_customer_orders.sql
[0m10:45:15.955486 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fct_customer_orders".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fct_customer_orders").
  
  To fix this, change the name of one of these resources:
  - model.refactoring_for_modularity.fct_customer_orders (models/training/marts/fct_customer_orders.sql)
  - model.refactoring_for_modularity.fct_customer_orders (models/exercise/marts/fct_customer_orders.sql)
[0m10:45:15.955803 [debug] [MainThread]: Command `cli run` failed at 10:45:15.955747 after 0.18 seconds
[0m10:45:15.955966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e86090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e846d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104681250>]}
[0m10:45:15.956156 [debug] [MainThread]: Flushing usage events
[0m10:45:48.665285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e72f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e73650>]}


============================== 10:45:48.667245 | 873a6406-e353-4727-80c8-8b69cad9e9bc ==============================
[0m10:45:48.667245 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:45:48.667622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:45:48.768239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '873a6406-e353-4727-80c8-8b69cad9e9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e61550>]}
[0m10:45:48.774558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '873a6406-e353-4727-80c8-8b69cad9e9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed09d0>]}
[0m10:45:48.774884 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:45:48.792480 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:45:48.811740 [debug] [MainThread]: Partial parsing enabled: 8 files deleted, 12 files added, 0 files changed.
[0m10:45:48.812052 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/stg_orders.sql
[0m10:45:48.812231 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/staging/stripe/sources.yml
[0m10:45:48.812379 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/staging/jaffle_shop/sources.yml
[0m10:45:48.812503 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/process.md
[0m10:45:48.812643 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/sources.yml
[0m10:45:48.812763 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/stg_customers.sql
[0m10:45:48.812903 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/marts/fct_customer_orders.sql
[0m10:45:48.813051 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/stripe/sources.yml
[0m10:45:48.813176 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/stripe/stg_payment.sql
[0m10:45:48.813282 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/legacy/customer_orders.sql
[0m10:45:48.813390 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/exercise/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:48.813531 [debug] [MainThread]: Partial parsing: added file: refactoring_for_modularity://models/training/marts/fct_customer_orders_training.sql
[0m10:45:48.813722 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m10:45:48.813824 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/legacy/customer_orders.sql
[0m10:45:48.813919 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/stg_orders.sql
[0m10:45:48.814010 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/stg_customers.sql
[0m10:45:48.814097 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/stripe/stg_payment.sql
[0m10:45:48.814182 [debug] [MainThread]: Partial parsing: deleted file: refactoring_for_modularity://models/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:48.823477 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/stg_orders.sql
[0m10:45:48.829878 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/stg_customers.sql
[0m10:45:48.831362 [debug] [MainThread]: 1699: static parser successfully parsed exercise/marts/fct_customer_orders.sql
[0m10:45:48.832739 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/stripe/stg_payment.sql
[0m10:45:48.834101 [debug] [MainThread]: 1699: static parser successfully parsed exercise/legacy/customer_orders.sql
[0m10:45:48.835521 [debug] [MainThread]: 1699: static parser successfully parsed exercise/staging/jaffle_shop/base_orders_per_customer.sql
[0m10:45:48.837489 [debug] [MainThread]: 1699: static parser successfully parsed training/marts/fct_customer_orders_training.sql
[0m10:45:48.863894 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "jaffle_shop_customers".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("jaffle_shop", "customers").
  
  To fix this, change the name of one of these resources:
  - source.refactoring_for_modularity.jaffle_shop.customers (models/exercise/staging/jaffle_shop/sources.yml)
  - source.refactoring_for_modularity.jaffle_shop.customers (models/training/staging/jaffle_shop/sources.yml)
[0m10:45:48.864307 [debug] [MainThread]: Command `cli run` failed at 10:45:48.864243 after 0.21 seconds
[0m10:45:48.864528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e60610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e69f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e64890>]}
[0m10:45:48.864707 [debug] [MainThread]: Flushing usage events
[0m10:52:20.496791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108787990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108787f90>]}


============================== 10:52:20.498833 | 675937ba-a9ea-495a-9063-833d910929a1 ==============================
[0m10:52:20.498833 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:52:20.499185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:52:20.605079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '675937ba-a9ea-495a-9063-833d910929a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086457d0>]}
[0m10:52:20.611344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '675937ba-a9ea-495a-9063-833d910929a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ab110>]}
[0m10:52:20.611674 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:52:20.629369 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:52:20.647508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:20.647697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:20.647943 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:52:20.650746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '675937ba-a9ea-495a-9063-833d910929a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109080d10>]}
[0m10:52:20.654715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '675937ba-a9ea-495a-9063-833d910929a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fadad0>]}
[0m10:52:20.654927 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:52:20.655570 [info ] [MainThread]: 
[0m10:52:20.655923 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:52:20.656422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:52:20.662894 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:52:20.663087 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:52:20.663206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:21.321872 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:52:21.325718 [debug] [ThreadPool]: On list_analytics: Close
[0m10:52:21.449344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:52:21.457724 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:52:21.458091 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:52:21.458372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:22.040048 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:52:22.041415 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:52:22.150705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '675937ba-a9ea-495a-9063-833d910929a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf1a50>]}
[0m10:52:22.151403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:22.151710 [info ] [MainThread]: 
[0m10:52:22.154411 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m10:52:22.154803 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m10:52:22.155307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m10:52:22.155549 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m10:52:22.161836 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:52:22.162485 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 10:52:22.155723 => 10:52:22.162353
[0m10:52:22.162725 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m10:52:22.179973 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:52:22.181843 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m10:52:22.182119 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders as orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m10:52:22.182396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:22.702151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:52:22.728512 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 10:52:22.162861 => 10:52:22.728313
[0m10:52:22.728932 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m10:52:22.838136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675937ba-a9ea-495a-9063-833d910929a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f600d0>]}
[0m10:52:22.839349 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.68s]
[0m10:52:22.840205 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m10:52:22.842509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:22.843062 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m10:52:22.843537 [info ] [MainThread]: 
[0m10:52:22.844079 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m10:52:22.845020 [debug] [MainThread]: Command end result
[0m10:52:22.854221 [info ] [MainThread]: 
[0m10:52:22.854628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:22.854922 [info ] [MainThread]: 
[0m10:52:22.855229 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:52:22.855712 [debug] [MainThread]: Command `cli build` succeeded at 10:52:22.855630 after 2.37 seconds
[0m10:52:22.856037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee3c10>]}
[0m10:52:22.856356 [debug] [MainThread]: Flushing usage events
[0m10:52:27.735430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e1ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7290>]}


============================== 10:52:27.737224 | 1cf953a7-ec97-4b01-9ea6-b90f151ef267 ==============================
[0m10:52:27.737224 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:52:27.737537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:52:27.836328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cf953a7-ec97-4b01-9ea6-b90f151ef267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d71d0>]}
[0m10:52:27.842677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cf953a7-ec97-4b01-9ea6-b90f151ef267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682fdd0>]}
[0m10:52:27.843030 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:52:27.860688 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:52:27.878336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:27.878516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:27.878749 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:52:27.881500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cf953a7-ec97-4b01-9ea6-b90f151ef267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b6950>]}
[0m10:52:27.885440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cf953a7-ec97-4b01-9ea6-b90f151ef267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff46d0>]}
[0m10:52:27.885658 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:52:27.885827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf953a7-ec97-4b01-9ea6-b90f151ef267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104551510>]}
[0m10:52:27.886429 [info ] [MainThread]: 
[0m10:52:27.886777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:52:27.887249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:52:27.892831 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:52:27.892975 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:52:27.893115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:28.284368 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:52:28.287687 [debug] [ThreadPool]: On list_analytics: Close
[0m10:52:28.398804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:52:28.409969 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:52:28.410465 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:52:28.410816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:28.772683 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m10:52:28.776303 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:52:28.890935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf953a7-ec97-4b01-9ea6-b90f151ef267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcfc90>]}
[0m10:52:28.892408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:28.892955 [info ] [MainThread]: 
[0m10:52:28.898300 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m10:52:28.899005 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m10:52:28.899907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m10:52:28.900331 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m10:52:28.909708 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:52:28.910538 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 10:52:28.900585 => 10:52:28.910370
[0m10:52:28.910833 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m10:52:28.932102 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:52:28.934180 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m10:52:28.934509 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders as orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m10:52:28.934806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:29.383953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:52:29.411035 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 10:52:28.911005 => 10:52:29.410849
[0m10:52:29.411465 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m10:52:29.522017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf953a7-ec97-4b01-9ea6-b90f151ef267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805aa10>]}
[0m10:52:29.523310 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.62s]
[0m10:52:29.524290 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m10:52:29.526890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:29.527254 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m10:52:29.527633 [info ] [MainThread]: 
[0m10:52:29.528093 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m10:52:29.528890 [debug] [MainThread]: Command end result
[0m10:52:29.539159 [info ] [MainThread]: 
[0m10:52:29.539623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:29.539937 [info ] [MainThread]: 
[0m10:52:29.540268 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:52:29.540847 [debug] [MainThread]: Command `cli run` succeeded at 10:52:29.540750 after 1.81 seconds
[0m10:52:29.541198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f2d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f33c10>]}
[0m10:52:29.541535 [debug] [MainThread]: Flushing usage events
[0m10:53:51.886164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fee850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff7990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff7f90>]}


============================== 10:53:51.887922 | adfbc377-7f72-497f-8da7-eb9edd252af1 ==============================
[0m10:53:51.887922 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:53:51.888240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:53:51.986044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adfbc377-7f72-497f-8da7-eb9edd252af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe5590>]}
[0m10:53:51.992002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adfbc377-7f72-497f-8da7-eb9edd252af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107feacd0>]}
[0m10:53:51.992275 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:53:52.009501 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:53:52.026708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:52.026876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:52.027105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:53:52.030270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adfbc377-7f72-497f-8da7-eb9edd252af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3a850>]}
[0m10:53:52.031253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adfbc377-7f72-497f-8da7-eb9edd252af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af1050>]}
[0m10:53:52.031442 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:53:52.031630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adfbc377-7f72-497f-8da7-eb9edd252af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d71410>]}
[0m10:53:52.032376 [info ] [MainThread]: 
[0m10:53:52.032736 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:53:52.033227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m10:53:52.038851 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:53:52.039006 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:53:52.039151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:52.753257 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:53:52.756923 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:53:52.877341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adfbc377-7f72-497f-8da7-eb9edd252af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107febf10>]}
[0m10:53:52.878336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:53:52.878782 [info ] [MainThread]: 
[0m10:53:52.882983 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m10:53:52.883756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m10:53:52.884121 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m10:53:52.890729 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m10:53:52.891483 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 10:53:52.884350 => 10:53:52.891299
[0m10:53:52.891778 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m10:53:52.892105 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 10:53:52.891958 => 10:53:52.891974
[0m10:53:52.892815 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m10:53:52.893109 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m10:53:52.893666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.customer_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m10:53:52.893974 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m10:53:52.897348 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:53:52.897863 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 10:53:52.894165 => 10:53:52.897733
[0m10:53:52.898096 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m10:53:52.898356 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 10:53:52.898241 => 10:53:52.898248
[0m10:53:52.898923 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m10:53:52.899445 [debug] [Thread-1 (]: Began running node analysis.refactoring_for_modularity.compare_queries
[0m10:53:52.899912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.fct_customer_orders, now analysis.refactoring_for_modularity.compare_queries)
[0m10:53:52.900154 [debug] [Thread-1 (]: Began compiling node analysis.refactoring_for_modularity.compare_queries
[0m10:53:52.917232 [debug] [Thread-1 (]: Using snowflake connection "analysis.refactoring_for_modularity.compare_queries"
[0m10:53:52.917496 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "analysis.refactoring_for_modularity.compare_queries"} */
describe table analytics.DBT_AMOLEIRO.customer_orders
[0m10:53:52.917700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:53.442521 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.0 seconds
[0m10:53:53.457123 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.refactoring_for_modularity.compare_queries"
[0m10:53:53.458034 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (compile): 10:53:52.900328 => 10:53:53.457859
[0m10:53:53.458368 [debug] [Thread-1 (]: Began executing node analysis.refactoring_for_modularity.compare_queries
[0m10:53:53.458694 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (execute): 10:53:53.458558 => 10:53:53.458574
[0m10:53:53.458956 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: Close
[0m10:53:53.570769 [debug] [Thread-1 (]: Finished running node analysis.refactoring_for_modularity.compare_queries
[0m10:53:53.572619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:53.573139 [debug] [MainThread]: Connection 'analysis.refactoring_for_modularity.compare_queries' was properly closed.
[0m10:53:53.574261 [debug] [MainThread]: Command end result
[0m10:53:53.588961 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m10:53:53.589298 [info ] [MainThread]: Building catalog
[0m10:53:53.590931 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m10:53:53.597635 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m10:53:53.598102 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m10:53:53.598547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:55.935844 [debug] [ThreadPool]: SQL status: SUCCESS 75 in 2.0 seconds
[0m10:53:55.955211 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m10:53:56.071603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly analytics.information_schema, now raw.information_schema)
[0m10:53:56.075348 [debug] [ThreadPool]: Using snowflake connection "raw.information_schema"
[0m10:53:56.075800 [debug] [ThreadPool]: On raw.information_schema: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "raw.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from raw.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from raw.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('jaffle_shop') or upper("table_schema") = upper('stripe'))
      order by "column_index"
[0m10:53:56.076207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:57.910793 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 2.0 seconds
[0m10:53:57.918134 [debug] [ThreadPool]: On raw.information_schema: Close
[0m10:53:58.039569 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/target/catalog.json
[0m10:53:58.040120 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:53:58.040060 after 6.16 seconds
[0m10:53:58.040299 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:53:58.040433 [debug] [MainThread]: Connection 'raw.information_schema' was properly closed.
[0m10:53:58.040599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fed690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b42cd0>]}
[0m10:53:58.040787 [debug] [MainThread]: Flushing usage events
[0m08:19:47.500750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a66410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a71750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7b5d0>]}


============================== 08:19:47.502677 | 5052f310-c378-4bf2-b3fb-9684342b2add ==============================
[0m08:19:47.502677 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:19:47.502991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:19:47.604889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5052f310-c378-4bf2-b3fb-9684342b2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a62450>]}
[0m08:19:47.610865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5052f310-c378-4bf2-b3fb-9684342b2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a86e10>]}
[0m08:19:47.611124 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:19:47.628406 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:19:47.651059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:19:47.651444 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m08:19:47.662112 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m08:19:47.670963 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:19:47.673275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5052f310-c378-4bf2-b3fb-9684342b2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060933d0>]}
[0m08:19:47.677060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5052f310-c378-4bf2-b3fb-9684342b2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105450690>]}
[0m08:19:47.677252 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:19:47.677418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5052f310-c378-4bf2-b3fb-9684342b2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102119510>]}
[0m08:19:47.678048 [info ] [MainThread]: 
[0m08:19:47.678391 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:19:47.678886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:19:47.684955 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:19:47.685214 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:19:47.685344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:48.399136 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:19:48.400954 [debug] [ThreadPool]: On list_analytics: Close
[0m08:19:48.517452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:19:48.523839 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:19:48.524157 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:19:48.524403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:19:49.070364 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m08:19:49.075971 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:19:49.189799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5052f310-c378-4bf2-b3fb-9684342b2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107358ad0>]}
[0m08:19:49.190999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:19:49.191487 [info ] [MainThread]: 
[0m08:19:49.197445 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:19:49.197976 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:19:49.198714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:19:49.199042 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:19:49.206653 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:19:49.207365 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:19:49.199250 => 08:19:49.207197
[0m08:19:49.207662 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:19:49.228464 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:19:49.230640 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:19:49.230989 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    orders as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders),

    payments as (select * from analytics.DBT_AMOLEIRO.stg_stripe__payments),

    -- staging

    customer_order_history as (
        select
            customers.customer_id,
            customers.full_name,
            customers.surname,
            customers.givenname,
            min(orders.order_date) as first_order_date,
            min(
                case
                    when orders.order_status not in ('returned', 'return_pending') then orders.order_date
                end
            ) as first_non_returned_order_date,
            max(
                case
                    when orders.order_status not in ('returned', 'return_pending') then orders.order_date
                end
            ) as most_recent_non_returned_order_date,
            coalesce(max(user_order_seq), 0) as order_count,
            coalesce(
                count(case when orders.order_status != 'returned' then 1 end), 0
            ) as non_returned_order_count,
            sum(
                case
                    when orders.order_status not in ('returned', 'return_pending')
                    then payments.payment_amount
                    else 0
                end
            ) as total_lifetime_value,
            sum(
                case
                    when orders.order_status not in ('returned', 'return_pending')
                    then payments.payment_amount
                    else 0
                end
            ) / nullif(
                count(
                    case when orders.order_status not in ('returned', 'return_pending') then 1 end
                ),
                0
            ) as avg_non_returned_order_value,
            array_agg(distinct orders.order_id) as order_ids

        from orders

        join customers on orders.customer_id = customers.customer_id

        left outer join payments on orders.order_id = payments.order_id

        where orders.order_status not in ('pending') and payments.payment_status != 'fail'

        group by customers.customer_id, customers.full_name, customers.surname, customers.givenname

    ),

    -- Final CTE

    final as (
        select
            orders.order_id,
            orders.customer_id,
            customers.surname,
            customers.givenname,
            first_order_date,
            order_count,
            total_lifetime_value,
            payment.payment_amount as order_value_dollars,
            orders.order_status,
            payments.payment_status
        from orders

        join customers on orders.customer_id = customers.customer_id

        join
            customer_order_history
            on orders.customer_id = customer_order_history.customer_id

        left outer join payments on orders.order_id = payments.order_id

        where payments.payment_status != 'fail'
    )

-- Simple select statement

select *
from final
  );
[0m08:19:49.231330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:19:49.754761 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adfd57-0000-22c6-0000-5899000110fa
[0m08:19:49.755535 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 25
invalid identifier 'PAYMENTS.PAYMENT_AMOUNT'
[0m08:19:49.756429 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:19:49.207832 => 08:19:49.756117
[0m08:19:49.756989 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:19:49.871900 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)
  000904 (42000): SQL compilation error: error line 40 at position 25
  invalid identifier 'PAYMENTS.PAYMENT_AMOUNT'
  compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m08:19:49.872470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5052f310-c378-4bf2-b3fb-9684342b2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a18d0>]}
[0m08:19:49.873030 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.fct_customer_orders .......... [[31mERROR[0m in 0.67s]
[0m08:19:49.873494 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:19:49.874895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:19:49.875185 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:19:49.875437 [info ] [MainThread]: 
[0m08:19:49.875735 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m08:19:49.876207 [debug] [MainThread]: Command end result
[0m08:19:49.882485 [info ] [MainThread]: 
[0m08:19:49.882781 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:19:49.882998 [info ] [MainThread]: 
[0m08:19:49.883292 [error] [MainThread]: [33mDatabase Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)[0m
[0m08:19:49.883554 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 40 at position 25
[0m08:19:49.883767 [error] [MainThread]:   invalid identifier 'PAYMENTS.PAYMENT_AMOUNT'
[0m08:19:49.883978 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m08:19:49.884185 [info ] [MainThread]: 
[0m08:19:49.884419 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:19:49.884793 [debug] [MainThread]: Command `cli run` failed at 08:19:49.884728 after 2.39 seconds
[0m08:19:49.885050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a6b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a6b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b0e710>]}
[0m08:19:49.885284 [debug] [MainThread]: Flushing usage events
[0m08:20:04.312638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106727810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106727ed0>]}


============================== 08:20:04.314491 | 3dc64880-4a54-4f5b-9c54-14abf1c2456d ==============================
[0m08:20:04.314491 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:20:04.314827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:20:04.413195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dc64880-4a54-4f5b-9c54-14abf1c2456d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d810>]}
[0m08:20:04.419401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dc64880-4a54-4f5b-9c54-14abf1c2456d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105173590>]}
[0m08:20:04.419707 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:20:04.437262 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:20:04.455412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:04.455600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:04.455875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:20:04.458590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dc64880-4a54-4f5b-9c54-14abf1c2456d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d9af90>]}
[0m08:20:04.462732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dc64880-4a54-4f5b-9c54-14abf1c2456d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0cad0>]}
[0m08:20:04.462941 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:20:04.463747 [info ] [MainThread]: 
[0m08:20:04.464175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:20:04.464661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:20:04.470729 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:20:04.470899 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:20:04.471020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:05.190083 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:20:05.192980 [debug] [ThreadPool]: On list_analytics: Close
[0m08:20:05.305899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:20:05.313838 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:20:05.314202 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:20:05.314474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:05.672724 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m08:20:05.675156 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:20:05.787039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dc64880-4a54-4f5b-9c54-14abf1c2456d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107046410>]}
[0m08:20:05.788405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:05.788982 [info ] [MainThread]: 
[0m08:20:05.796204 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m08:20:05.796833 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ............ [RUN]
[0m08:20:05.797730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__customers)
[0m08:20:05.798124 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m08:20:05.806285 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m08:20:05.807128 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (compile): 08:20:05.798382 => 08:20:05.806919
[0m08:20:05.807473 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m08:20:05.828781 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m08:20:05.829618 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m08:20:05.829892 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers
  
   as (
    with
    source as (select * from raw.jaffle_shop.customers),

    transform as (
        select
            id as customer_id,
            last_name as surname,
            first_name as givenname,
            first_name || ' ' || last_name as full_name
        from source
    )

select *
from transform
  );
[0m08:20:05.830150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:06.532969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:20:06.561340 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (execute): 08:20:05.807672 => 08:20:06.561136
[0m08:20:06.561755 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: Close
[0m08:20:06.680413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dc64880-4a54-4f5b-9c54-14abf1c2456d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3ee50>]}
[0m08:20:06.681197 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ....... [[32mSUCCESS 1[0m in 0.88s]
[0m08:20:06.681941 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m08:20:06.683688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:06.684001 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_jaffle_shop__customers' was properly closed.
[0m08:20:06.684327 [info ] [MainThread]: 
[0m08:20:06.684722 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m08:20:06.685490 [debug] [MainThread]: Command end result
[0m08:20:06.693968 [info ] [MainThread]: 
[0m08:20:06.694409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:06.694694 [info ] [MainThread]: 
[0m08:20:06.694977 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:20:06.695425 [debug] [MainThread]: Command `cli build` succeeded at 08:20:06.695353 after 2.39 seconds
[0m08:20:06.695712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e83b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df3390>]}
[0m08:20:06.696013 [debug] [MainThread]: Flushing usage events
[0m08:20:10.516189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e96850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9b790>]}


============================== 08:20:10.517977 | fd3a0f11-ec88-48e7-8f15-ed4f1d3cb85a ==============================
[0m08:20:10.517977 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:20:10.518275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:20:10.617959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd3a0f11-ec88-48e7-8f15-ed4f1d3cb85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e8b750>]}
[0m08:20:10.624188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd3a0f11-ec88-48e7-8f15-ed4f1d3cb85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464ca50>]}
[0m08:20:10.624522 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:20:10.642120 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:20:10.660439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:10.660621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:10.660909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:20:10.663704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd3a0f11-ec88-48e7-8f15-ed4f1d3cb85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9b650>]}
[0m08:20:10.667877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd3a0f11-ec88-48e7-8f15-ed4f1d3cb85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467f350>]}
[0m08:20:10.668086 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:20:10.668796 [info ] [MainThread]: 
[0m08:20:10.669163 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:20:10.669638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:20:10.675536 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:20:10.675688 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:20:10.675804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:11.121458 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m08:20:11.124547 [debug] [ThreadPool]: On list_analytics: Close
[0m08:20:11.248308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:20:11.259342 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:20:11.259832 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:20:11.260178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:11.627631 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m08:20:11.631987 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:20:11.747836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd3a0f11-ec88-48e7-8f15-ed4f1d3cb85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c7cd0>]}
[0m08:20:11.748816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:11.749256 [info ] [MainThread]: 
[0m08:20:11.754344 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m08:20:11.754835 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders ............... [RUN]
[0m08:20:11.755534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__orders)
[0m08:20:11.755884 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m08:20:11.762887 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m08:20:11.763618 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (compile): 08:20:11.756086 => 08:20:11.763441
[0m08:20:11.763908 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m08:20:11.783974 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m08:20:11.784855 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m08:20:11.785102 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
  
   as (
    with
    source as (select * from raw.jaffle_shop.orders),

    transform as (
        select
            id as order_id,
            order_date,
            user_id as customer_id,
            status as order_status,
            row_number() over (
                partition by user_id order by order_date, id
            ) as user_order_seq
        from source
    )

select *
from transform
  );
[0m08:20:11.785320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:12.244303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:20:12.266592 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (execute): 08:20:11.764075 => 08:20:12.266418
[0m08:20:12.266950 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: Close
[0m08:20:12.375489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd3a0f11-ec88-48e7-8f15-ed4f1d3cb85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104773550>]}
[0m08:20:12.376641 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders .......... [[32mSUCCESS 1[0m in 0.62s]
[0m08:20:12.377435 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m08:20:12.379618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:12.380058 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_jaffle_shop__orders' was properly closed.
[0m08:20:12.380429 [info ] [MainThread]: 
[0m08:20:12.380856 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m08:20:12.381659 [debug] [MainThread]: Command end result
[0m08:20:12.390799 [info ] [MainThread]: 
[0m08:20:12.391205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:12.391528 [info ] [MainThread]: 
[0m08:20:12.391850 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:20:12.392359 [debug] [MainThread]: Command `cli build` succeeded at 08:20:12.392272 after 1.89 seconds
[0m08:20:12.392698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1005ebc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10055b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10055b2d0>]}
[0m08:20:12.393015 [debug] [MainThread]: Flushing usage events
[0m08:20:15.497515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105714cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adb210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adb910>]}


============================== 08:20:15.499308 | 3dc3d00a-3af2-4b3d-bb99-b56de493585c ==============================
[0m08:20:15.499308 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:20:15.499631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:20:15.600333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dc3d00a-3af2-4b3d-bb99-b56de493585c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad0f10>]}
[0m08:20:15.606676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dc3d00a-3af2-4b3d-bb99-b56de493585c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afdf50>]}
[0m08:20:15.606982 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:20:15.624258 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:20:15.642102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:15.642283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:15.642557 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:20:15.645585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dc3d00a-3af2-4b3d-bb99-b56de493585c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ec190>]}
[0m08:20:15.649747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dc3d00a-3af2-4b3d-bb99-b56de493585c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d9350>]}
[0m08:20:15.649939 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:20:15.650600 [info ] [MainThread]: 
[0m08:20:15.650963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:20:15.651368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:20:15.656982 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:20:15.657131 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:20:15.657249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:16.250059 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:20:16.253249 [debug] [ThreadPool]: On list_analytics: Close
[0m08:20:16.375506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:20:16.381278 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:20:16.381567 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:20:16.381781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:16.945905 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m08:20:16.950516 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:20:17.069840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dc3d00a-3af2-4b3d-bb99-b56de493585c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104855950>]}
[0m08:20:17.070520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:17.070804 [info ] [MainThread]: 
[0m08:20:17.074436 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_stripe__payments
[0m08:20:17.074808 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_stripe__payments .................. [RUN]
[0m08:20:17.075342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_stripe__payments)
[0m08:20:17.075587 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_stripe__payments
[0m08:20:17.080764 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m08:20:17.081375 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (compile): 08:20:17.075745 => 08:20:17.081222
[0m08:20:17.081651 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_stripe__payments
[0m08:20:17.098530 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m08:20:17.099222 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_stripe__payments"
[0m08:20:17.099423 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_stripe__payments"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_stripe__payments
  
   as (
    with
    source as (select * from raw.stripe.payment),

    transform as (
        select
            id as payment_id,
            orderid as order_id,
            status as payment_status,
            round(amount / 100.0, 2) as payment_amount
        from source
    )

select *
from transform
  );
[0m08:20:17.099609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:17.524224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:20:17.550212 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (execute): 08:20:17.081783 => 08:20:17.550017
[0m08:20:17.550613 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: Close
[0m08:20:17.657545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dc3d00a-3af2-4b3d-bb99-b56de493585c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741c8d0>]}
[0m08:20:17.658753 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_stripe__payments ............. [[32mSUCCESS 1[0m in 0.58s]
[0m08:20:17.659721 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_stripe__payments
[0m08:20:17.662290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:17.662749 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_stripe__payments' was properly closed.
[0m08:20:17.663157 [info ] [MainThread]: 
[0m08:20:17.663603 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m08:20:17.664468 [debug] [MainThread]: Command end result
[0m08:20:17.675272 [info ] [MainThread]: 
[0m08:20:17.675763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:17.676071 [info ] [MainThread]: 
[0m08:20:17.676393 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:20:17.676913 [debug] [MainThread]: Command `cli build` succeeded at 08:20:17.676822 after 2.19 seconds
[0m08:20:17.677261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103237c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031a72d0>]}
[0m08:20:17.677606 [debug] [MainThread]: Flushing usage events
[0m08:20:21.684658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081cb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081cbb10>]}


============================== 08:20:21.686525 | c3ecb0a3-0610-4c4a-9cae-8121e14a0f1f ==============================
[0m08:20:21.686525 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:20:21.686857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:20:21.786861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3ecb0a3-0610-4c4a-9cae-8121e14a0f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bfa10>]}
[0m08:20:21.792962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3ecb0a3-0610-4c4a-9cae-8121e14a0f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e6290>]}
[0m08:20:21.793262 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:20:21.811030 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:20:21.828732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:21.828912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:21.829192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:20:21.831913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3ecb0a3-0610-4c4a-9cae-8121e14a0f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a80f50>]}
[0m08:20:21.835990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3ecb0a3-0610-4c4a-9cae-8121e14a0f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089abed0>]}
[0m08:20:21.836190 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:20:21.836872 [info ] [MainThread]: 
[0m08:20:21.837248 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:20:21.837692 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:20:21.843644 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:20:21.843811 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:20:21.843929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:22.243734 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m08:20:22.247090 [debug] [ThreadPool]: On list_analytics: Close
[0m08:20:22.366495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:20:22.376148 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:20:22.376570 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:20:22.376850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:22.780387 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m08:20:22.784433 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:20:22.906747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ecb0a3-0610-4c4a-9cae-8121e14a0f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ff4d0>]}
[0m08:20:22.908191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:22.908766 [info ] [MainThread]: 
[0m08:20:22.915022 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:20:22.915731 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:20:22.916653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:20:22.917088 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:20:22.925688 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:20:22.926530 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:20:22.917360 => 08:20:22.926324
[0m08:20:22.926818 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:20:22.947349 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:20:22.949755 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:20:22.950120 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    -- imports

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    orders as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders),

    payments as (select * from analytics.DBT_AMOLEIRO.stg_stripe__payments),

    -- staging

    customer_order_history as (
        select
            customers.customer_id,
            customers.full_name,
            customers.surname,
            customers.givenname,
            min(orders.order_date) as first_order_date,
            min(
                case
                    when orders.order_status not in ('returned', 'return_pending') then orders.order_date
                end
            ) as first_non_returned_order_date,
            max(
                case
                    when orders.order_status not in ('returned', 'return_pending') then orders.order_date
                end
            ) as most_recent_non_returned_order_date,
            coalesce(max(user_order_seq), 0) as order_count,
            coalesce(
                count(case when orders.order_status != 'returned' then 1 end), 0
            ) as non_returned_order_count,
            sum(
                case
                    when orders.order_status not in ('returned', 'return_pending')
                    then payments.payment_amount
                    else 0
                end
            ) as total_lifetime_value,
            sum(
                case
                    when orders.order_status not in ('returned', 'return_pending')
                    then payments.payment_amount
                    else 0
                end
            ) / nullif(
                count(
                    case when orders.order_status not in ('returned', 'return_pending') then 1 end
                ),
                0
            ) as avg_non_returned_order_value,
            array_agg(distinct orders.order_id) as order_ids

        from orders

        join customers on orders.customer_id = customers.customer_id

        left outer join payments on orders.order_id = payments.order_id

        where orders.order_status not in ('pending') and payments.payment_status != 'fail'

        group by customers.customer_id, customers.full_name, customers.surname, customers.givenname

    ),

    -- Final CTE

    final as (
        select
            orders.order_id,
            orders.customer_id,
            customers.surname,
            customers.givenname,
            first_order_date,
            order_count,
            total_lifetime_value,
            payment.payment_amount as order_value_dollars,
            orders.order_status,
            payments.payment_status
        from orders

        join customers on orders.customer_id = customers.customer_id

        join
            customer_order_history
            on orders.customer_id = customer_order_history.customer_id

        left outer join payments on orders.order_id = payments.order_id

        where payments.payment_status != 'fail'
    )

-- Simple select statement

select *
from final
  );
[0m08:20:22.950444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:23.438799 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adfd58-0000-22c6-0000-58990001110a
[0m08:20:23.439340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 81 at position 12
invalid identifier 'PAYMENT.PAYMENT_AMOUNT'
[0m08:20:23.439938 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:20:22.926987 => 08:20:23.439751
[0m08:20:23.440254 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:20:23.558011 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)
  000904 (42000): SQL compilation error: error line 81 at position 12
  invalid identifier 'PAYMENT.PAYMENT_AMOUNT'
  compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m08:20:23.558667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ecb0a3-0610-4c4a-9cae-8121e14a0f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109999510>]}
[0m08:20:23.559379 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.fct_customer_orders .......... [[31mERROR[0m in 0.64s]
[0m08:20:23.559900 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:20:23.561399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:23.561655 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:20:23.561915 [info ] [MainThread]: 
[0m08:20:23.562257 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m08:20:23.562779 [debug] [MainThread]: Command end result
[0m08:20:23.570657 [info ] [MainThread]: 
[0m08:20:23.571023 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:20:23.571353 [info ] [MainThread]: 
[0m08:20:23.571624 [error] [MainThread]: [33mDatabase Error in model fct_customer_orders (models/marts/fct_customer_orders.sql)[0m
[0m08:20:23.571900 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 81 at position 12
[0m08:20:23.572138 [error] [MainThread]:   invalid identifier 'PAYMENT.PAYMENT_AMOUNT'
[0m08:20:23.572365 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/fct_customer_orders.sql
[0m08:20:23.572617 [info ] [MainThread]: 
[0m08:20:23.572887 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:20:23.573286 [debug] [MainThread]: Command `cli build` failed at 08:20:23.573222 after 1.90 seconds
[0m08:20:23.573548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104931910>]}
[0m08:20:23.573797 [debug] [MainThread]: Flushing usage events
[0m08:21:29.862666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451bb50>]}


============================== 08:21:29.864506 | adab2623-2a11-4e70-a6b8-94f7d1a66eb9 ==============================
[0m08:21:29.864506 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:21:29.864828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:21:29.970027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adab2623-2a11-4e70-a6b8-94f7d1a66eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104505a50>]}
[0m08:21:29.976444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adab2623-2a11-4e70-a6b8-94f7d1a66eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104527b10>]}
[0m08:21:29.976785 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:21:29.994850 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:21:30.013081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:21:30.013264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:21:30.013574 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:21:30.016821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adab2623-2a11-4e70-a6b8-94f7d1a66eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df4090>]}
[0m08:21:30.020999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adab2623-2a11-4e70-a6b8-94f7d1a66eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0c1d0>]}
[0m08:21:30.021205 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:21:30.021846 [info ] [MainThread]: 
[0m08:21:30.022202 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:21:30.022674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:21:30.028453 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:21:30.028616 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:21:30.028740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:21:30.666029 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:21:30.670126 [debug] [ThreadPool]: On list_analytics: Close
[0m08:21:30.785122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:21:30.796231 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:21:30.796772 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:21:30.797127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:21:31.360381 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m08:21:31.364482 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:21:31.485880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adab2623-2a11-4e70-a6b8-94f7d1a66eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e45f10>]}
[0m08:21:31.486968 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:21:31.487438 [info ] [MainThread]: 
[0m08:21:31.492667 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:21:31.493205 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:21:31.493954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:21:31.494295 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:21:31.501447 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:21:31.502117 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:21:31.494507 => 08:21:31.501950
[0m08:21:31.502403 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:21:31.522107 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:21:31.524464 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:21:31.524844 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    orders as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders),

    payments as (select * from analytics.DBT_AMOLEIRO.stg_stripe__payments),

    customer_order_history as (
        select
            customers.customer_id,
            customers.full_name,
            customers.surname,
            customers.givenname,
            min(orders.order_date) as first_order_date,
            min(
                case
                    when orders.order_status not in ('returned', 'return_pending')
                    then orders.order_date
                end
            ) as first_non_returned_order_date,
            max(
                case
                    when orders.order_status not in ('returned', 'return_pending')
                    then orders.order_date
                end
            ) as most_recent_non_returned_order_date,
            coalesce(max(user_order_seq), 0) as order_count,
            coalesce(
                count(case when orders.order_status != 'returned' then 1 end), 0
            ) as non_returned_order_count,
            sum(
                case
                    when orders.order_status not in ('returned', 'return_pending')
                    then payments.payment_amount
                    else 0
                end
            ) as total_lifetime_value,
            sum(
                case
                    when orders.order_status not in ('returned', 'return_pending')
                    then payments.payment_amount
                    else 0
                end
            ) / nullif(
                count(
                    case
                        when orders.order_status not in ('returned', 'return_pending')
                        then 1
                    end
                ),
                0
            ) as avg_non_returned_order_value,
            array_agg(distinct orders.order_id) as order_ids

        from orders

        join customers on orders.customer_id = customers.customer_id

        left outer join payments on orders.order_id = payments.order_id

        where
            orders.order_status not in ('pending') and payments.payment_status != 'fail'

        group by
            customers.customer_id,
            customers.full_name,
            customers.surname,
            customers.givenname

    ),

    -- Final CTE
    final as (
        select
            orders.order_id,
            orders.customer_id,
            customers.surname,
            customers.givenname,
            first_order_date,
            order_count,
            total_lifetime_value,
            payments.payment_amount as order_value_dollars,
            orders.order_status,
            payments.payment_status
        from orders

        join customers on orders.customer_id = customers.customer_id

        join
            customer_order_history
            on orders.customer_id = customer_order_history.customer_id

        left outer join payments on orders.order_id = payments.order_id

        where payments.payment_status != 'fail'
    )

-- Simple select statement
select *
from final
  );
[0m08:21:31.525200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:32.123293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:21:32.148227 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:21:31.502577 => 08:21:32.148045
[0m08:21:32.148605 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:21:32.250786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adab2623-2a11-4e70-a6b8-94f7d1a66eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d46c50>]}
[0m08:21:32.251939 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.76s]
[0m08:21:32.252827 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:21:32.255150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:21:32.255541 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:21:32.255907 [info ] [MainThread]: 
[0m08:21:32.256333 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m08:21:32.257117 [debug] [MainThread]: Command end result
[0m08:21:32.266273 [info ] [MainThread]: 
[0m08:21:32.266700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:21:32.266993 [info ] [MainThread]: 
[0m08:21:32.267264 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:21:32.267684 [debug] [MainThread]: Command `cli build` succeeded at 08:21:32.267615 after 2.41 seconds
[0m08:21:32.267959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104527790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c6bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bdb2d0>]}
[0m08:21:32.268259 [debug] [MainThread]: Flushing usage events
[0m09:03:53.664761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b67610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6bb50>]}


============================== 09:03:53.666562 | a55f0017-991f-445c-b24d-936d13be1be4 ==============================
[0m09:03:53.666562 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:03:53.666871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:03:53.767773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a55f0017-991f-445c-b24d-936d13be1be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106483110>]}
[0m09:03:53.773939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a55f0017-991f-445c-b24d-936d13be1be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107450c90>]}
[0m09:03:53.774233 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:03:53.791071 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:03:53.809636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:03:53.809831 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:03:53.810117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:03:53.812891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a55f0017-991f-445c-b24d-936d13be1be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079bcd90>]}
[0m09:03:53.817054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a55f0017-991f-445c-b24d-936d13be1be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bb690>]}
[0m09:03:53.817247 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:03:53.818055 [info ] [MainThread]: 
[0m09:03:53.818513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:03:53.818972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:03:53.825141 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:03:53.825305 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:03:53.825420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:54.267954 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m09:03:54.271227 [debug] [ThreadPool]: On list_analytics: Close
[0m09:03:54.392054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:03:54.403646 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:03:54.404161 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:03:54.404504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:03:54.773132 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:03:54.776912 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:03:54.892788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55f0017-991f-445c-b24d-936d13be1be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b66d10>]}
[0m09:03:54.894206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:03:54.894722 [info ] [MainThread]: 
[0m09:03:54.901314 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:03:54.902021 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders ............... [RUN]
[0m09:03:54.902960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__orders)
[0m09:03:54.903365 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:03:54.911067 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m09:03:54.911936 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (compile): 09:03:54.903621 => 09:03:54.911726
[0m09:03:54.912272 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:03:54.932921 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m09:03:54.933888 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m09:03:54.934154 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
  
   as (
    with
    source as (select * from raw.jaffle_shop.orders),

    transform as (
        select
            id as order_id,
            order_date,
            user_id as customer_id,
            status as order_status,
            case
                when order_status not in ('returned', 'return_pending')
                then order_date
            end as first_non_returned_order_date,
            row_number() over (
                partition by user_id order by order_date, id
            ) as user_order_seq
        from source
    )

select *
from transform
  );
[0m09:03:54.934368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:03:55.355400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:03:55.382828 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (execute): 09:03:54.912469 => 09:03:55.382627
[0m09:03:55.383243 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: Close
[0m09:03:55.493146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55f0017-991f-445c-b24d-936d13be1be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792ca90>]}
[0m09:03:55.494489 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders .......... [[32mSUCCESS 1[0m in 0.59s]
[0m09:03:55.495485 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:03:55.497963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:55.498328 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_jaffle_shop__orders' was properly closed.
[0m09:03:55.498712 [info ] [MainThread]: 
[0m09:03:55.499161 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m09:03:55.499997 [debug] [MainThread]: Command end result
[0m09:03:55.510635 [info ] [MainThread]: 
[0m09:03:55.511180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:03:55.511582 [info ] [MainThread]: 
[0m09:03:55.511922 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:03:55.512458 [debug] [MainThread]: Command `cli build` succeeded at 09:03:55.512362 after 1.86 seconds
[0m09:03:55.512849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b71f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b707d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028cfc10>]}
[0m09:03:55.513218 [debug] [MainThread]: Flushing usage events
[0m09:15:16.881489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088561d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108855510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108854250>]}


============================== 09:15:16.883302 | 1b9645a5-1bf2-4ce7-937d-4986fecec124 ==============================
[0m09:15:16.883302 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:15:16.883628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:15:16.983165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b9645a5-1bf2-4ce7-937d-4986fecec124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109010990>]}
[0m09:15:16.989331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b9645a5-1bf2-4ce7-937d-4986fecec124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bf250>]}
[0m09:15:16.989652 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:15:17.006855 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:15:17.025053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:15:17.025332 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/fct_customer_orders.sql
[0m09:15:17.035147 [debug] [MainThread]: 1699: static parser successfully parsed marts/fct_customer_orders.sql
[0m09:15:17.043153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:15:17.045457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b9645a5-1bf2-4ce7-937d-4986fecec124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109010a90>]}
[0m09:15:17.049334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b9645a5-1bf2-4ce7-937d-4986fecec124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912b6d0>]}
[0m09:15:17.049527 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:15:17.050213 [info ] [MainThread]: 
[0m09:15:17.050554 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:15:17.051049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:15:17.056762 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:15:17.056933 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:15:17.057065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:17.849712 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:15:17.852281 [debug] [ThreadPool]: On list_analytics: Close
[0m09:15:17.970233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:15:17.981713 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:15:17.982176 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:15:17.982521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:18.384120 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:15:18.390546 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:15:18.513462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b9645a5-1bf2-4ce7-937d-4986fecec124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64de10>]}
[0m09:15:18.514537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:15:18.514980 [info ] [MainThread]: 
[0m09:15:18.518667 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_orders
[0m09:15:18.519227 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.int_orders ............................ [RUN]
[0m09:15:18.519952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.int_orders)
[0m09:15:18.520290 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_orders
[0m09:15:18.527214 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_orders"
[0m09:15:18.528040 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (compile): 09:15:18.520505 => 09:15:18.527867
[0m09:15:18.528320 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_orders
[0m09:15:18.548661 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_orders"
[0m09:15:18.549714 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_orders"
[0m09:15:18.549952 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_orders
  
   as (
    with
    orders as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments where payment_status <> 'fail'
    ),
    order_totals as (
        select order_id, payment_status, sum(payment_amount) as order_value_dollars
        from payments
        group by order_id, payment_status
    ),

    order_values_joined as (
        select orders.*, order_totals.payment_status, order_totals.order_value_dollars
        from orders
        left join order_totals on orders.order_id = order_totals.order_id
    ),

select *
from order_values_joined
  );
[0m09:15:18.550176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:18.914459 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adfd8f-0000-22c6-0000-589900011132
[0m09:15:18.914951 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 0 unexpected 'select'.
[0m09:15:18.915444 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (execute): 09:15:18.528485 => 09:15:18.915280
[0m09:15:18.915753 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: Close
[0m09:15:19.033138 [debug] [Thread-1 (]: Database Error in model int_orders (models/marts/intermediate/int_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 0 unexpected 'select'.
  compiled Code at target/run/refactoring_for_modularity/models/marts/intermediate/int_orders.sql
[0m09:15:19.033703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b9645a5-1bf2-4ce7-937d-4986fecec124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a55e490>]}
[0m09:15:19.034315 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_AMOLEIRO.int_orders ................... [[31mERROR[0m in 0.51s]
[0m09:15:19.034823 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_orders
[0m09:15:19.036310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:19.036523 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.int_orders' was properly closed.
[0m09:15:19.036746 [info ] [MainThread]: 
[0m09:15:19.037025 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m09:15:19.037492 [debug] [MainThread]: Command end result
[0m09:15:19.044728 [info ] [MainThread]: 
[0m09:15:19.045031 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:15:19.045247 [info ] [MainThread]: 
[0m09:15:19.045471 [error] [MainThread]: [33mDatabase Error in model int_orders (models/marts/intermediate/int_orders.sql)[0m
[0m09:15:19.045697 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m09:15:19.045899 [error] [MainThread]:   syntax error line 22 at position 0 unexpected 'select'.
[0m09:15:19.046107 [error] [MainThread]:   compiled Code at target/run/refactoring_for_modularity/models/marts/intermediate/int_orders.sql
[0m09:15:19.046308 [info ] [MainThread]: 
[0m09:15:19.046538 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:15:19.046912 [debug] [MainThread]: Command `cli build` failed at 09:15:19.046844 after 2.17 seconds
[0m09:15:19.047175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108848150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe9750>]}
[0m09:15:19.047434 [debug] [MainThread]: Flushing usage events
[0m09:15:39.072624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c72c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c6b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c6b950>]}


============================== 09:15:39.074487 | e4a03141-7a40-4f34-8522-3cce75f13037 ==============================
[0m09:15:39.074487 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:15:39.074796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:15:39.179097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4a03141-7a40-4f34-8522-3cce75f13037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c67890>]}
[0m09:15:39.185185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4a03141-7a40-4f34-8522-3cce75f13037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a450c10>]}
[0m09:15:39.185485 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:15:39.202313 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:15:39.220964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:15:39.221278 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://models/marts/intermediate/int_orders.sql
[0m09:15:39.230707 [debug] [MainThread]: 1699: static parser successfully parsed marts/intermediate/int_orders.sql
[0m09:15:39.238641 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:15:39.240889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4a03141-7a40-4f34-8522-3cce75f13037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a490350>]}
[0m09:15:39.245052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4a03141-7a40-4f34-8522-3cce75f13037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa2ed0>]}
[0m09:15:39.245247 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:15:39.245869 [info ] [MainThread]: 
[0m09:15:39.246211 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:15:39.246667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:15:39.252195 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:15:39.252347 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:15:39.252462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:39.953464 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:15:39.956420 [debug] [ThreadPool]: On list_analytics: Close
[0m09:15:40.064738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:15:40.071019 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:15:40.071323 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:15:40.071559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:40.436235 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:15:40.439818 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:15:40.563589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a03141-7a40-4f34-8522-3cce75f13037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a52590>]}
[0m09:15:40.564512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:15:40.564939 [info ] [MainThread]: 
[0m09:15:40.568750 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_orders
[0m09:15:40.569260 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.int_orders ............................ [RUN]
[0m09:15:40.569951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.int_orders)
[0m09:15:40.570280 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_orders
[0m09:15:40.577315 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_orders"
[0m09:15:40.578105 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (compile): 09:15:40.570490 => 09:15:40.577938
[0m09:15:40.578390 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_orders
[0m09:15:40.598948 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_orders"
[0m09:15:40.599890 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_orders"
[0m09:15:40.600136 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_orders
  
   as (
    with
    orders as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments where payment_status <> 'fail'
    ),
    order_totals as (
        select order_id, payment_status, sum(payment_amount) as order_value_dollars
        from payments
        group by order_id, payment_status
    ),

    order_values_joined as (
        select orders.*, order_totals.payment_status, order_totals.order_value_dollars
        from orders
        left join order_totals on orders.order_id = order_totals.order_id
    )

select *
from order_values_joined
  );
[0m09:15:40.600376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:41.160819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:15:41.188648 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (execute): 09:15:40.578558 => 09:15:41.188469
[0m09:15:41.189024 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: Close
[0m09:15:41.296757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4a03141-7a40-4f34-8522-3cce75f13037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa7b510>]}
[0m09:15:41.297934 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.int_orders ....................... [[32mSUCCESS 1[0m in 0.73s]
[0m09:15:41.298898 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_orders
[0m09:15:41.301269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:41.301622 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.int_orders' was properly closed.
[0m09:15:41.301976 [info ] [MainThread]: 
[0m09:15:41.302432 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m09:15:41.303265 [debug] [MainThread]: Command end result
[0m09:15:41.313582 [info ] [MainThread]: 
[0m09:15:41.314087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:15:41.314399 [info ] [MainThread]: 
[0m09:15:41.314718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:15:41.315218 [debug] [MainThread]: Command `cli build` succeeded at 09:15:41.315131 after 2.26 seconds
[0m09:15:41.315566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104827b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104797390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104797350>]}
[0m09:15:41.315914 [debug] [MainThread]: Flushing usage events
[0m09:17:45.162242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069df4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dfb90>]}


============================== 09:17:45.164081 | ef0da20c-738b-4c0f-8b72-3db038fa7c4c ==============================
[0m09:17:45.164081 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:17:45.164394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:17:45.263656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef0da20c-738b-4c0f-8b72-3db038fa7c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dba10>]}
[0m09:17:45.269917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef0da20c-738b-4c0f-8b72-3db038fa7c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dba10>]}
[0m09:17:45.270242 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:17:45.287337 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:17:45.305578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:17:45.305744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:17:45.306027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:17:45.308699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef0da20c-738b-4c0f-8b72-3db038fa7c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748ee50>]}
[0m09:17:45.312914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef0da20c-738b-4c0f-8b72-3db038fa7c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073716d0>]}
[0m09:17:45.313114 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:17:45.313769 [info ] [MainThread]: 
[0m09:17:45.314118 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:17:45.314532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:17:45.320504 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:17:45.320672 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:17:45.320791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:45.988628 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:17:45.990202 [debug] [ThreadPool]: On list_analytics: Close
[0m09:17:46.109661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:17:46.117460 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:17:46.117846 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:17:46.118129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:46.503493 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:17:46.504624 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:17:46.616966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef0da20c-738b-4c0f-8b72-3db038fa7c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732fbd0>]}
[0m09:17:46.617650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:17:46.617973 [info ] [MainThread]: 
[0m09:17:46.621470 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:17:46.621890 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders ............... [RUN]
[0m09:17:46.622412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__orders)
[0m09:17:46.622660 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:17:46.628007 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m09:17:46.628660 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (compile): 09:17:46.622814 => 09:17:46.628508
[0m09:17:46.628950 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:17:46.646469 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m09:17:46.647264 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m09:17:46.647486 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
  
   as (
    with
    source as (select * from raw.jaffle_shop.orders),

    transform as (
        select
            id as order_id,
            order_date,
            user_id as customer_id,
            status as order_status,
            case
                when order_status not in ('returned', 'return_pending')
                then order_date
            end as valid_order_date,
            row_number() over (
                partition by user_id order by order_date, id
            ) as user_order_seq
        from source
    )

select *
from transform
  );
[0m09:17:46.647692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:47.300380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:17:47.324002 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (execute): 09:17:46.629105 => 09:17:47.323821
[0m09:17:47.324390 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: Close
[0m09:17:47.441047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef0da20c-738b-4c0f-8b72-3db038fa7c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073abcd0>]}
[0m09:17:47.442287 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders .......... [[32mSUCCESS 1[0m in 0.82s]
[0m09:17:47.443275 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:17:47.445739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:47.446119 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.stg_jaffle_shop__orders' was properly closed.
[0m09:17:47.446528 [info ] [MainThread]: 
[0m09:17:47.446996 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m09:17:47.447873 [debug] [MainThread]: Command end result
[0m09:17:47.458476 [info ] [MainThread]: 
[0m09:17:47.458987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:17:47.459309 [info ] [MainThread]: 
[0m09:17:47.459661 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:17:47.460223 [debug] [MainThread]: Command `cli build` succeeded at 09:17:47.460124 after 2.31 seconds
[0m09:17:47.460610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029cbc10>]}
[0m09:17:47.461005 [debug] [MainThread]: Flushing usage events
[0m09:18:22.491187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107df390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107dfa90>]}


============================== 09:18:22.493071 | 66f63c80-c461-434c-be06-25f369453d5b ==============================
[0m09:18:22.493071 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:18:22.493377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:18:22.591748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f63c80-c461-434c-be06-25f369453d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107dbd50>]}
[0m09:18:22.597980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66f63c80-c461-434c-be06-25f369453d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110801650>]}
[0m09:18:22.598284 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:18:22.615449 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:18:22.633766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:18:22.633939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:18:22.634235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:18:22.637019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66f63c80-c461-434c-be06-25f369453d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c92010>]}
[0m09:18:22.641473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66f63c80-c461-434c-be06-25f369453d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b7e190>]}
[0m09:18:22.641673 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:18:22.642325 [info ] [MainThread]: 
[0m09:18:22.642685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:18:22.643117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:18:22.648640 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:18:22.648775 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:18:22.648885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:23.227730 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:18:23.230696 [debug] [ThreadPool]: On list_analytics: Close
[0m09:18:23.342365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:18:23.353365 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:18:23.353839 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:18:23.354174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:23.733776 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m09:18:23.737066 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:18:23.857730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f63c80-c461-434c-be06-25f369453d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130e9710>]}
[0m09:18:23.858383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:18:23.858683 [info ] [MainThread]: 
[0m09:18:23.861874 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_orders
[0m09:18:23.862255 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.int_orders ............................ [RUN]
[0m09:18:23.862780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.int_orders)
[0m09:18:23.863016 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_orders
[0m09:18:23.868347 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_orders"
[0m09:18:23.868862 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (compile): 09:18:23.863166 => 09:18:23.868739
[0m09:18:23.869086 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_orders
[0m09:18:23.886183 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_orders"
[0m09:18:23.887167 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_orders"
[0m09:18:23.887415 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_orders
  
   as (
    with
    orders as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments where payment_status <> 'fail'
    ),
    order_totals as (
        select order_id, payment_status, sum(payment_amount) as order_value_dollars
        from payments
        group by order_id, payment_status
    ),

    order_values_joined as (
        select orders.*, order_totals.payment_status, order_totals.order_value_dollars
        from orders
        left join order_totals on orders.order_id = order_totals.order_id
    )

select *
from order_values_joined
  );
[0m09:18:23.887619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:24.397244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:18:24.423851 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (execute): 09:18:23.869214 => 09:18:24.423654
[0m09:18:24.424268 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: Close
[0m09:18:24.530687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f63c80-c461-434c-be06-25f369453d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb7190>]}
[0m09:18:24.531976 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.int_orders ....................... [[32mSUCCESS 1[0m in 0.67s]
[0m09:18:24.532981 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_orders
[0m09:18:24.535600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:24.535989 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.int_orders' was properly closed.
[0m09:18:24.536360 [info ] [MainThread]: 
[0m09:18:24.536803 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m09:18:24.537654 [debug] [MainThread]: Command end result
[0m09:18:24.548204 [info ] [MainThread]: 
[0m09:18:24.548727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:18:24.549040 [info ] [MainThread]: 
[0m09:18:24.549381 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:18:24.549954 [debug] [MainThread]: Command `cli build` succeeded at 09:18:24.549855 after 2.07 seconds
[0m09:18:24.550312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ab710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104663350>]}
[0m09:18:24.550662 [debug] [MainThread]: Flushing usage events
[0m09:54:06.352667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041cf450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041cfb50>]}


============================== 09:54:06.354465 | 5d7d0786-dee8-41bf-8903-46e27237e876 ==============================
[0m09:54:06.354465 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:54:06.354777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:54:06.455115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d7d0786-dee8-41bf-8903-46e27237e876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c3990>]}
[0m09:54:06.461240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d7d0786-dee8-41bf-8903-46e27237e876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f03d0>]}
[0m09:54:06.461519 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:54:06.478647 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:54:06.497167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:54:06.497353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:54:06.497641 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:54:06.500497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d7d0786-dee8-41bf-8903-46e27237e876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032c71d0>]}
[0m09:54:06.504621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d7d0786-dee8-41bf-8903-46e27237e876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e16d0>]}
[0m09:54:06.504816 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:54:06.505501 [info ] [MainThread]: 
[0m09:54:06.505855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:54:06.506364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m09:54:06.512388 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m09:54:06.512586 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m09:54:06.512727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:07.135723 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:54:07.138958 [debug] [ThreadPool]: On list_analytics: Close
[0m09:54:07.254367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m09:54:07.261831 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:54:07.262179 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:54:07.262458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:07.797627 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m09:54:07.800644 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:54:07.928860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d7d0786-dee8-41bf-8903-46e27237e876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104937650>]}
[0m09:54:07.929631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:54:07.929982 [info ] [MainThread]: 
[0m09:54:07.933924 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:54:07.934357 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m09:54:07.934970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:54:07.935251 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:54:07.941707 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:54:07.942349 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:54:07.935433 => 09:54:07.942195
[0m09:54:07.942621 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:54:07.961632 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:54:07.963508 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m09:54:07.963828 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    orders as (select * from analytics.DBT_AMOLEIRO.int_orders),

    customer_orders as (
        select
            orders.*,
            customers.full_name,
            customers.surname,
            customers.givenname,
            min(orders.order_date) over (
                partition by orders.customer_id
            ) as customer_first_order_date,
            min(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_first_non_returned_order_date,
            max(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_most_recent_non_returned_order_date,
            count(*) over (partition by orders.customer_id) as customer_order_count,
            sum(nvl2(orders.valid_order_date, 1, 0)) over (
                partition by orders.customer_id
            ) as customer_non_returned_order_count,
            sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over (
                partition by orders.customer_id
            ) as customer_total_lifetime_value,
            array_agg(distinct orders.order_id) over (
                partition by orders.customer_id
            ) as customer_order_ids

        from orders
        join customers on orders.customer_id = customers.customer_id
    ),

    add_avg_order_values as (
        select
            *,
            customer_total_lifetime_value
            / customer_non_returned_order_count as customer_avg_non_returned_order_value
        from customer_orders
    ),

    final as (
        select
            order_id,
            customer_id,
            surname,
            givenname,
            customer_first_order_date as first_order_date,
            customer_order_count as order_count,
            customer_total_lifetime_value as total_lifetime_value,
            order_value_dollars as order_value_dollars,
            order_status as order_status,
            payment_status as payment_status

        from add_avg_order_values
    )

select *
from final
  );
[0m09:54:07.964110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:08.512653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:54:08.536060 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:54:07.942774 => 09:54:08.535884
[0m09:54:08.536459 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m09:54:08.648912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d7d0786-dee8-41bf-8903-46e27237e876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105912110>]}
[0m09:54:08.650180 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.71s]
[0m09:54:08.651172 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:54:08.653591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:08.653952 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m09:54:08.654293 [info ] [MainThread]: 
[0m09:54:08.654685 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m09:54:08.655499 [debug] [MainThread]: Command end result
[0m09:54:08.665836 [info ] [MainThread]: 
[0m09:54:08.666340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:54:08.666678 [info ] [MainThread]: 
[0m09:54:08.667010 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:54:08.667556 [debug] [MainThread]: Command `cli build` succeeded at 09:54:08.667461 after 2.32 seconds
[0m09:54:08.667926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041df5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100923c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008932d0>]}
[0m09:54:08.668287 [debug] [MainThread]: Flushing usage events
[0m09:56:20.132455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c3f90>]}


============================== 09:56:20.134202 | 8d6822e9-e82d-4b21-ae54-5ac5701910dc ==============================
[0m09:56:20.134202 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:56:20.134530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:56:20.233053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d6822e9-e82d-4b21-ae54-5ac5701910dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b13d0>]}
[0m09:56:20.239123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d6822e9-e82d-4b21-ae54-5ac5701910dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cac7d0>]}
[0m09:56:20.239399 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m09:56:20.256819 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m09:56:20.274829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:56:20.275001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:56:20.275290 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m09:56:20.278350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d6822e9-e82d-4b21-ae54-5ac5701910dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7cd50>]}
[0m09:56:20.279521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d6822e9-e82d-4b21-ae54-5ac5701910dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db74d0>]}
[0m09:56:20.279729 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:56:20.279946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d6822e9-e82d-4b21-ae54-5ac5701910dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10223d350>]}
[0m09:56:20.280820 [info ] [MainThread]: 
[0m09:56:20.281208 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:56:20.281782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m09:56:20.287444 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m09:56:20.287596 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m09:56:20.287724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:20.949875 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m09:56:20.953831 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m09:56:21.070959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d6822e9-e82d-4b21-ae54-5ac5701910dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b49790>]}
[0m09:56:21.072177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:56:21.072713 [info ] [MainThread]: 
[0m09:56:21.078023 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m09:56:21.078960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m09:56:21.079393 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m09:56:21.086343 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m09:56:21.087189 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 09:56:21.079660 => 09:56:21.086995
[0m09:56:21.087534 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m09:56:21.087914 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 09:56:21.087751 => 09:56:21.087766
[0m09:56:21.088766 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m09:56:21.089104 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m09:56:21.089737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.customer_orders, now model.refactoring_for_modularity.stg_jaffle_shop__customers)
[0m09:56:21.090084 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m09:56:21.092772 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m09:56:21.093444 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (compile): 09:56:21.090285 => 09:56:21.093267
[0m09:56:21.093720 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m09:56:21.094035 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (execute): 09:56:21.093896 => 09:56:21.093903
[0m09:56:21.094680 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m09:56:21.094980 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:56:21.095544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.stg_jaffle_shop__customers, now model.refactoring_for_modularity.stg_jaffle_shop__orders)
[0m09:56:21.095872 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:56:21.098032 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m09:56:21.098588 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (compile): 09:56:21.096069 => 09:56:21.098457
[0m09:56:21.098833 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:56:21.099097 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (execute): 09:56:21.098978 => 09:56:21.098983
[0m09:56:21.099646 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m09:56:21.099917 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_stripe__payments
[0m09:56:21.100327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.stg_jaffle_shop__orders, now model.refactoring_for_modularity.stg_stripe__payments)
[0m09:56:21.100558 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_stripe__payments
[0m09:56:21.102501 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m09:56:21.102977 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (compile): 09:56:21.100716 => 09:56:21.102852
[0m09:56:21.103196 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_stripe__payments
[0m09:56:21.103460 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (execute): 09:56:21.103341 => 09:56:21.103347
[0m09:56:21.103979 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_stripe__payments
[0m09:56:21.104401 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_orders
[0m09:56:21.104923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.stg_stripe__payments, now model.refactoring_for_modularity.int_orders)
[0m09:56:21.105129 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_orders
[0m09:56:21.107008 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_orders"
[0m09:56:21.107436 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (compile): 09:56:21.105272 => 09:56:21.107328
[0m09:56:21.107631 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_orders
[0m09:56:21.107857 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (execute): 09:56:21.107759 => 09:56:21.107763
[0m09:56:21.108319 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_orders
[0m09:56:21.108662 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m09:56:21.109010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.int_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m09:56:21.109199 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m09:56:21.112057 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m09:56:21.112492 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 09:56:21.109327 => 09:56:21.112373
[0m09:56:21.112690 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m09:56:21.112900 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 09:56:21.112808 => 09:56:21.112811
[0m09:56:21.113317 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m09:56:21.113623 [debug] [Thread-1 (]: Began running node analysis.refactoring_for_modularity.compare_queries
[0m09:56:21.113988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.fct_customer_orders, now analysis.refactoring_for_modularity.compare_queries)
[0m09:56:21.114169 [debug] [Thread-1 (]: Began compiling node analysis.refactoring_for_modularity.compare_queries
[0m09:56:21.128184 [debug] [Thread-1 (]: Using snowflake connection "analysis.refactoring_for_modularity.compare_queries"
[0m09:56:21.128408 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "analysis.refactoring_for_modularity.compare_queries"} */
describe table analytics.DBT_AMOLEIRO.customer_orders
[0m09:56:21.128586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:21.478247 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m09:56:21.491367 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.refactoring_for_modularity.compare_queries"
[0m09:56:21.492147 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (compile): 09:56:21.114300 => 09:56:21.491988
[0m09:56:21.492453 [debug] [Thread-1 (]: Began executing node analysis.refactoring_for_modularity.compare_queries
[0m09:56:21.492772 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (execute): 09:56:21.492634 => 09:56:21.492643
[0m09:56:21.493052 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: Close
[0m09:56:21.599599 [debug] [Thread-1 (]: Finished running node analysis.refactoring_for_modularity.compare_queries
[0m09:56:21.601231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:21.601646 [debug] [MainThread]: Connection 'analysis.refactoring_for_modularity.compare_queries' was properly closed.
[0m09:56:21.603423 [debug] [MainThread]: Command end result
[0m09:56:21.617107 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m09:56:21.617453 [info ] [MainThread]: Building catalog
[0m09:56:21.619345 [debug] [ThreadPool]: Acquiring new snowflake connection 'analytics.information_schema'
[0m09:56:21.625933 [debug] [ThreadPool]: Using snowflake connection "analytics.information_schema"
[0m09:56:21.626384 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "analytics.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from analytics.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from analytics.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_amoleiro'))
      order by "column_index"
[0m09:56:21.626732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:23.844062 [debug] [ThreadPool]: SQL status: SUCCESS 75 in 2.0 seconds
[0m09:56:23.863022 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m09:56:23.977976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly analytics.information_schema, now raw.information_schema)
[0m09:56:23.983205 [debug] [ThreadPool]: Using snowflake connection "raw.information_schema"
[0m09:56:23.983674 [debug] [ThreadPool]: On raw.information_schema: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "raw.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from raw.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from raw.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('jaffle_shop') or upper("table_schema") = upper('stripe'))
      order by "column_index"
[0m09:56:23.984085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:26.415772 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 2.0 seconds
[0m09:56:26.425038 [debug] [ThreadPool]: On raw.information_schema: Close
[0m09:56:26.561395 [info ] [MainThread]: Catalog written to /Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/target/catalog.json
[0m09:56:26.562211 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:56:26.562117 after 6.44 seconds
[0m09:56:26.562448 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:56:26.562626 [debug] [MainThread]: Connection 'raw.information_schema' was properly closed.
[0m09:56:26.562853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a3f510>]}
[0m09:56:26.563132 [debug] [MainThread]: Flushing usage events
[0m09:56:32.510029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106787390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106787bd0>]}


============================== 09:56:32.511741 | a67d8976-cb3b-43c5-a86f-9cd66dfd652d ==============================
[0m09:56:32.511741 [info ] [MainThread]: Running with dbt=1.5.4
[0m09:56:32.512093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'version_check': 'True', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:56:32.610107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a67d8976-cb3b-43c5-a86f-9cd66dfd652d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf3550>]}
[0m09:56:32.615946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a67d8976-cb3b-43c5-a86f-9cd66dfd652d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a3c90>]}
[0m10:00:31.291843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107373810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107373ed0>]}


============================== 10:00:31.293808 | 7df02c31-487f-4db1-8c3b-c3ce95d28afd ==============================
[0m10:00:31.293808 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:00:31.294128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:00:31.398483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7df02c31-487f-4db1-8c3b-c3ce95d28afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110388050>]}
[0m10:00:31.404572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7df02c31-487f-4db1-8c3b-c3ce95d28afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107396590>]}
[0m10:00:31.404852 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:00:31.422571 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:00:31.441106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:00:31.441297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:00:31.441592 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:00:31.444435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7df02c31-487f-4db1-8c3b-c3ce95d28afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bb410>]}
[0m10:00:31.448916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7df02c31-487f-4db1-8c3b-c3ce95d28afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110390090>]}
[0m10:00:31.449111 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:00:31.449779 [info ] [MainThread]: 
[0m10:00:31.450128 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:00:31.450562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:00:31.456125 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:00:31.456285 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:00:31.456422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:32.173390 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:00:32.175798 [debug] [ThreadPool]: On list_analytics: Close
[0m10:00:32.297156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:00:32.308523 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:00:32.308925 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:00:32.309205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:32.862849 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:00:32.864570 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:00:32.977153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df02c31-487f-4db1-8c3b-c3ce95d28afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11034cf90>]}
[0m10:00:32.978267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:00:32.978734 [info ] [MainThread]: 
[0m10:00:32.983880 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m10:00:32.984376 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m10:00:32.985104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m10:00:32.985431 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m10:00:32.992391 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:00:32.993089 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 10:00:32.985640 => 10:00:32.992913
[0m10:00:32.993392 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m10:00:33.012489 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:00:33.014359 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m10:00:33.014679 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    orders as (select * from analytics.DBT_AMOLEIRO.int_orders),

    customer_orders as (
        select
            orders.*,
            customers.full_name,
            customers.surname,
            customers.givenname,
            min(orders.order_date) over (
                partition by orders.customer_id
            ) as customer_first_order_date,
            min(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_first_non_returned_order_date,
            max(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_most_recent_non_returned_order_date,
            count(*) over (partition by orders.customer_id) as customer_order_count,
            sum(nvl2(orders.valid_order_date, 1, 0)) over (
                partition by orders.customer_id
            ) as customer_non_returned_order_count,
            sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over (
                partition by orders.customer_id
            ) as customer_total_lifetime_value,
            array_agg(distinct orders.order_id) over (
                partition by orders.customer_id
            ) as customer_order_ids

        from orders
        join customers on orders.customer_id = customers.customer_id
    ),

    add_avg_order_values as (
        select
            *,
            customer_total_lifetime_value
            / customer_non_returned_order_count as customer_avg_non_returned_order_value
        from customer_orders
    ),

    final as (
        select
            order_id,
            customer_id,
            surname,
            givenname,
            customer_first_order_date as first_order_date,
            customer_order_count as order_count,
            customer_total_lifetime_value as total_lifetime_value,
            order_value_dollars as order_value_dollars,
            order_status as order_status,
            payment_status as payment_status

        from add_avg_order_values
    )

select *
from final
  );
[0m10:00:33.014990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:33.657365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:00:33.685550 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 10:00:32.993562 => 10:00:33.685347
[0m10:00:33.685965 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m10:00:33.801387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df02c31-487f-4db1-8c3b-c3ce95d28afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a8c4d0>]}
[0m10:00:33.802787 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.82s]
[0m10:00:33.803926 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m10:00:33.806527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:33.806891 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m10:00:33.807332 [info ] [MainThread]: 
[0m10:00:33.807795 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m10:00:33.809248 [debug] [MainThread]: Command end result
[0m10:00:33.818977 [info ] [MainThread]: 
[0m10:00:33.819488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:00:33.819820 [info ] [MainThread]: 
[0m10:00:33.820163 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:00:33.820717 [debug] [MainThread]: Command `cli build` succeeded at 10:00:33.820618 after 2.54 seconds
[0m10:00:33.821068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103017b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f87190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f872d0>]}
[0m10:00:33.821412 [debug] [MainThread]: Flushing usage events
[0m10:00:38.825066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b67610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b77c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b77f90>]}


============================== 10:00:38.827035 | ca2ad253-89fe-4844-8b3b-3b3261c720e7 ==============================
[0m10:00:38.827035 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:00:38.827379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:00:38.928198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca2ad253-89fe-4844-8b3b-3b3261c720e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b674d0>]}
[0m10:00:38.934436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca2ad253-89fe-4844-8b3b-3b3261c720e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092dd7d0>]}
[0m10:00:38.934743 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:00:38.951896 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:00:38.970220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:00:38.970402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:00:38.970693 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:00:38.973447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca2ad253-89fe-4844-8b3b-3b3261c720e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099baed0>]}
[0m10:00:38.978120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca2ad253-89fe-4844-8b3b-3b3261c720e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093512d0>]}
[0m10:00:38.978384 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:00:38.979057 [info ] [MainThread]: 
[0m10:00:38.979447 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:00:38.979903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:00:38.985751 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:00:38.985898 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:00:38.986016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:39.373463 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:00:39.376090 [debug] [ThreadPool]: On list_analytics: Close
[0m10:00:39.484727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:00:39.495129 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:00:39.495497 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:00:39.495772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:39.865370 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m10:00:39.869229 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:00:39.992135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca2ad253-89fe-4844-8b3b-3b3261c720e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607d490>]}
[0m10:00:39.993205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:00:39.993644 [info ] [MainThread]: 
[0m10:00:39.998890 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.customer_orders
[0m10:00:39.999449 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.customer_orders ....................... [RUN]
[0m10:00:40.000177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.customer_orders)
[0m10:00:40.000516 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.customer_orders
[0m10:00:40.006747 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.customer_orders"
[0m10:00:40.007463 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (compile): 10:00:40.000729 => 10:00:40.007303
[0m10:00:40.007749 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.customer_orders
[0m10:00:40.028612 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.customer_orders"
[0m10:00:40.030900 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.customer_orders"
[0m10:00:40.031241 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.customer_orders
  
   as (
    select
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join
    (select first_name || ' ' || last_name as name, * from raw.jaffle_shop.customers) customers
    on orders.user_id = customers.id

join
    (

        select
            b.id as customer_id,
            b.name as full_name,
            b.last_name as surname,
            b.first_name as givenname,
            min(order_date) as first_order_date,
            min(
                case when a.status not in ('returned', 'return_pending') then order_date end
            ) as first_non_returned_order_date,
            max(
                case when a.status not in ('returned', 'return_pending') then order_date end
            ) as most_recent_non_returned_order_date,
            coalesce(max(user_order_seq), 0) as order_count,
            coalesce(
                count(case when a.status != 'returned' then 1 end), 0
            ) as non_returned_order_count,
            sum(
                case
                    when a.status not in ('returned', 'return_pending')
                    then round(c.amount / 100.0, 2)
                    else 0
                end
            ) as total_lifetime_value,
            sum(
                case
                    when a.status not in ('returned', 'return_pending')
                    then round(c.amount / 100.0, 2)
                    else 0
                end
            ) / nullif(
                count(case when a.status not in ('returned', 'return_pending') then 1 end), 0
            ) as avg_non_returned_order_value,
            array_agg(distinct a.id) as order_ids

        from
            (
                select
                    row_number() over (
                        partition by user_id order by order_date, id
                    ) as user_order_seq,
                    *
                from raw.jaffle_shop.orders
            ) a

        join
            (select first_name || ' ' || last_name as name, * from raw.jaffle_shop.customers) b
            on a.user_id = b.id

        left outer join raw.stripe.payment c on a.id = c.orderid

        where a.status not in ('pending') and c.status != 'fail'

        group by b.id, b.name, b.last_name, b.first_name

    ) customer_order_history
    on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m10:00:40.031581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:40.478455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:00:40.506640 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.customer_orders (execute): 10:00:40.007922 => 10:00:40.506448
[0m10:00:40.507063 [debug] [Thread-1 (]: On model.refactoring_for_modularity.customer_orders: Close
[0m10:00:40.614102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca2ad253-89fe-4844-8b3b-3b3261c720e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38a710>]}
[0m10:00:40.615079 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.customer_orders .................. [[32mSUCCESS 1[0m in 0.61s]
[0m10:00:40.615826 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.customer_orders
[0m10:00:40.617511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:40.617822 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.customer_orders' was properly closed.
[0m10:00:40.618139 [info ] [MainThread]: 
[0m10:00:40.618558 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m10:00:40.619288 [debug] [MainThread]: Command end result
[0m10:00:40.628100 [info ] [MainThread]: 
[0m10:00:40.628541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:00:40.628828 [info ] [MainThread]: 
[0m10:00:40.629103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:00:40.629576 [debug] [MainThread]: Command `cli build` succeeded at 10:00:40.629501 after 1.81 seconds
[0m10:00:40.629869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a415810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cf3d0>]}
[0m10:00:40.630166 [debug] [MainThread]: Flushing usage events
[0m10:24:55.430567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10883ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108843410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108843ad0>]}


============================== 10:24:55.432612 | 5bdaaa8f-a67b-4c75-bb18-615d439a1813 ==============================
[0m10:24:55.432612 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:24:55.432927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:24:55.535109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bdaaa8f-a67b-4c75-bb18-615d439a1813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fca210>]}
[0m10:24:55.541356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bdaaa8f-a67b-4c75-bb18-615d439a1813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884fd50>]}
[0m10:24:55.541680 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:24:55.559524 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:24:55.577918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:24:55.578240 [debug] [MainThread]: Partial parsing: updated file: refactoring_for_modularity://analyses/compare_queries.sql
[0m10:24:55.605259 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:24:55.607435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bdaaa8f-a67b-4c75-bb18-615d439a1813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961b850>]}
[0m10:24:55.611478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bdaaa8f-a67b-4c75-bb18-615d439a1813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090dbd50>]}
[0m10:24:55.611689 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:24:55.612276 [info ] [MainThread]: 
[0m10:24:55.612441 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:24:55.612660 [debug] [MainThread]: Command end result
[0m10:24:55.616291 [debug] [MainThread]: Command `cli build` succeeded at 10:24:55.616244 after 0.19 seconds
[0m10:24:55.616483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f93b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f03350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f03410>]}
[0m10:24:55.616644 [debug] [MainThread]: Flushing usage events
[0m10:26:56.099824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106662f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a11ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106677510>]}


============================== 10:26:56.101739 | 4329ed33-4bc2-4b64-9f13-9dff63bc5184 ==============================
[0m10:26:56.101739 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:26:56.102052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:26:56.202709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4329ed33-4bc2-4b64-9f13-9dff63bc5184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066673d0>]}
[0m10:26:56.208922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4329ed33-4bc2-4b64-9f13-9dff63bc5184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edee10>]}
[0m10:26:56.209261 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:26:56.227243 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:26:56.246086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:26:56.246266 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:26:56.246565 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:26:56.249514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4329ed33-4bc2-4b64-9f13-9dff63bc5184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdd310>]}
[0m10:26:56.253812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4329ed33-4bc2-4b64-9f13-9dff63bc5184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f71f90>]}
[0m10:26:56.254024 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:26:56.254193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4329ed33-4bc2-4b64-9f13-9dff63bc5184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023ed550>]}
[0m10:26:56.254809 [info ] [MainThread]: 
[0m10:26:56.255155 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:26:56.255571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:26:56.261310 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:26:56.261464 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:26:56.261608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:56.898375 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:26:56.901601 [debug] [ThreadPool]: On list_analytics: Close
[0m10:26:57.020025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:26:57.028720 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:26:57.029078 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:26:57.029362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:57.405770 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m10:26:57.410957 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:26:57.526098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4329ed33-4bc2-4b64-9f13-9dff63bc5184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106695ed0>]}
[0m10:26:57.526925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:57.527288 [info ] [MainThread]: 
[0m10:26:57.531863 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m10:26:57.532352 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m10:26:57.532967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m10:26:57.533244 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m10:26:57.539734 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:26:57.540363 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 10:26:57.533420 => 10:26:57.540220
[0m10:26:57.540623 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m10:26:57.559151 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:26:57.561081 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m10:26:57.561421 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    orders as (select * from analytics.DBT_AMOLEIRO.int_orders),

    customer_orders as (
        select
            orders.*,
            customers.full_name,
            customers.surname,
            customers.givenname,
            min(orders.order_date) over (
                partition by orders.customer_id
            ) as customer_first_order_date,
            min(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_first_non_returned_order_date,
            max(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_most_recent_non_returned_order_date,
            count(*) over (partition by orders.customer_id) as customer_order_count,
            sum(nvl2(orders.valid_order_date, 1, 0)) over (
                partition by orders.customer_id
            ) as customer_non_returned_order_count,
            sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over (
                partition by orders.customer_id
            ) as customer_total_lifetime_value,
            array_agg(distinct orders.order_id) over (
                partition by orders.customer_id
            ) as customer_order_ids

        from orders
        join customers on orders.customer_id = customers.customer_id
    ),

    add_avg_order_values as (
        select
            *,
            customer_total_lifetime_value
            / customer_non_returned_order_count as customer_avg_non_returned_order_value
        from customer_orders
    ),

    final as (
        select
            order_id,
            customer_id,
            surname,
            givenname,
            customer_first_order_date as first_order_date,
            customer_order_count as order_count,
            customer_total_lifetime_value as total_lifetime_value,
            order_value_dollars as order_value_dollars,
            order_status as order_status,
            payment_status as payment_status

        from add_avg_order_values
    )

select *
from final
  );
[0m10:26:57.561722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:58.230306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:26:58.257154 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 10:26:57.540767 => 10:26:58.256932
[0m10:26:58.257597 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m10:26:58.373180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4329ed33-4bc2-4b64-9f13-9dff63bc5184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9d6d0>]}
[0m10:26:58.374059 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.84s]
[0m10:26:58.374826 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m10:26:58.376724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:58.377123 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m10:26:58.377476 [info ] [MainThread]: 
[0m10:26:58.377909 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m10:26:58.378665 [debug] [MainThread]: Command end result
[0m10:26:58.387329 [info ] [MainThread]: 
[0m10:26:58.387703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:26:58.387961 [info ] [MainThread]: 
[0m10:26:58.388237 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:26:58.388663 [debug] [MainThread]: Command `cli run` succeeded at 10:26:58.388590 after 2.30 seconds
[0m10:26:58.388950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009ffc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10096f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10096f2d0>]}
[0m10:26:58.389226 [debug] [MainThread]: Flushing usage events
[0m10:27:09.519283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e3710>]}


============================== 10:27:09.521155 | 5373d960-7738-499e-8588-37c365f19275 ==============================
[0m10:27:09.521155 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:27:09.521480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'debug': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:27:09.624664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5373d960-7738-499e-8588-37c365f19275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e2b50>]}
[0m10:27:09.631075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5373d960-7738-499e-8588-37c365f19275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104602c10>]}
[0m10:27:09.631402 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:27:09.648785 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:27:09.667849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:27:09.668038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:27:09.668351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:27:09.671110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5373d960-7738-499e-8588-37c365f19275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d76e90>]}
[0m10:27:09.675498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5373d960-7738-499e-8588-37c365f19275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dbc9d0>]}
[0m10:27:09.675742 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:27:09.676490 [info ] [MainThread]: 
[0m10:27:09.676875 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:27:09.677386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:27:09.683706 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:27:09.683884 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:27:09.684021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:10.429902 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:27:10.433225 [debug] [ThreadPool]: On list_analytics: Close
[0m10:27:10.562167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:27:10.571368 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:27:10.571809 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:27:10.572100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:11.136791 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:27:11.139492 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:27:11.258371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5373d960-7738-499e-8588-37c365f19275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492a650>]}
[0m10:27:11.259387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:11.259834 [info ] [MainThread]: 
[0m10:27:11.265156 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m10:27:11.265676 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m10:27:11.266391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.fct_customer_orders)
[0m10:27:11.266715 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m10:27:11.274375 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:27:11.275086 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 10:27:11.266919 => 10:27:11.274926
[0m10:27:11.275376 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m10:27:11.294673 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:27:11.296530 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m10:27:11.296840 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    orders as (select * from analytics.DBT_AMOLEIRO.int_orders),

    customer_orders as (
        select
            orders.*,
            customers.full_name,
            customers.surname,
            customers.givenname,
            min(orders.order_date) over (
                partition by orders.customer_id
            ) as customer_first_order_date,
            min(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_first_non_returned_order_date,
            max(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_most_recent_non_returned_order_date,
            count(*) over (partition by orders.customer_id) as customer_order_count,
            sum(nvl2(orders.valid_order_date, 1, 0)) over (
                partition by orders.customer_id
            ) as customer_non_returned_order_count,
            sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over (
                partition by orders.customer_id
            ) as customer_total_lifetime_value,
            array_agg(distinct orders.order_id) over (
                partition by orders.customer_id
            ) as customer_order_ids

        from orders
        join customers on orders.customer_id = customers.customer_id
    ),

    add_avg_order_values as (
        select
            *,
            customer_total_lifetime_value
            / customer_non_returned_order_count as customer_avg_non_returned_order_value
        from customer_orders
    ),

    final as (
        select
            order_id,
            customer_id,
            surname,
            givenname,
            customer_first_order_date as first_order_date,
            customer_order_count as order_count,
            customer_total_lifetime_value as total_lifetime_value,
            order_value_dollars as order_value_dollars,
            order_status as order_status,
            payment_status as payment_status

        from add_avg_order_values
    )

select *
from final
  );
[0m10:27:11.297175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:11.966406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:27:11.992109 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 10:27:11.275546 => 10:27:11.991908
[0m10:27:11.992517 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m10:27:12.109931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5373d960-7738-499e-8588-37c365f19275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104646d90>]}
[0m10:27:12.110705 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.84s]
[0m10:27:12.111312 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m10:27:12.112904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:12.113222 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m10:27:12.113512 [info ] [MainThread]: 
[0m10:27:12.113876 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m10:27:12.114535 [debug] [MainThread]: Command end result
[0m10:27:12.122324 [info ] [MainThread]: 
[0m10:27:12.122709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:27:12.123004 [info ] [MainThread]: 
[0m10:27:12.123297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:27:12.123780 [debug] [MainThread]: Command `cli build` succeeded at 10:27:12.123701 after 2.61 seconds
[0m10:27:12.124085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d3bb90>]}
[0m10:27:12.124366 [debug] [MainThread]: Flushing usage events
[0m10:27:28.716556 [error] [MainThread]: Encountered an error:

[0m10:27:28.723082 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/.venv/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:27:28.724882 [debug] [MainThread]: Command `dbt docs serve` failed at 10:27:28.724660 after 1485.74 seconds
[0m10:27:28.725500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678d690>]}
[0m10:27:28.726192 [debug] [MainThread]: Flushing usage events
[0m10:29:18.260548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f37050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e01b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4b550>]}


============================== 10:29:18.262301 | d35bdee6-a6bf-4e37-bc6b-0844a36f39b7 ==============================
[0m10:29:18.262301 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:29:18.262618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:29:18.359575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b2550>]}
[0m10:29:18.365625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f617d0>]}
[0m10:29:18.365905 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:29:18.383692 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:29:18.401539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:18.401697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:18.401984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:29:18.405049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827710>]}
[0m10:29:18.409358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ee8d0>]}
[0m10:29:18.409552 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:29:18.409741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cbd550>]}
[0m10:29:18.410461 [info ] [MainThread]: 
[0m10:29:18.410819 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:29:18.411304 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m10:29:18.417104 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m10:29:18.417261 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m10:29:18.417381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:19.132892 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:29:19.134050 [debug] [ThreadPool]: On list_analytics: Close
[0m10:29:19.246059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m10:29:19.253093 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:29:19.253399 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:29:19.253643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:19.633114 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m10:29:19.637279 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:29:19.757324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cbd550>]}
[0m10:29:19.758390 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:19.758855 [info ] [MainThread]: 
[0m10:29:19.764144 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m10:29:19.764670 [info ] [Thread-1 (]: 1 of 5 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ............ [RUN]
[0m10:29:19.765481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__customers)
[0m10:29:19.765818 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m10:29:19.772594 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m10:29:19.773300 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (compile): 10:29:19.766037 => 10:29:19.773131
[0m10:29:19.773597 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m10:29:19.793541 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m10:29:19.794318 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m10:29:19.794555 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers
  
   as (
    with
    source as (select * from raw.jaffle_shop.customers),

    transform as (
        select
            id as customer_id,
            last_name as surname,
            first_name as givenname,
            first_name || ' ' || last_name as full_name
        from source
    )

select *
from transform
  );
[0m10:29:19.794777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:20.386300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:29:20.411359 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (execute): 10:29:19.773774 => 10:29:20.411173
[0m10:29:20.411758 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: Close
[0m10:29:20.524167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687b750>]}
[0m10:29:20.525561 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ....... [[32mSUCCESS 1[0m in 0.76s]
[0m10:29:20.526566 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m10:29:20.527222 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m10:29:20.528019 [info ] [Thread-1 (]: 2 of 5 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders ............... [RUN]
[0m10:29:20.529019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.stg_jaffle_shop__customers, now model.refactoring_for_modularity.stg_jaffle_shop__orders)
[0m10:29:20.529469 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m10:29:20.534411 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m10:29:20.535532 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (compile): 10:29:20.529783 => 10:29:20.535292
[0m10:29:20.535973 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m10:29:20.540458 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m10:29:20.541860 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m10:29:20.542269 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
  
   as (
    with
    source as (select * from raw.jaffle_shop.orders),

    transform as (
        select
            id as order_id,
            order_date,
            user_id as customer_id,
            status as order_status,
            case
                when order_status not in ('returned', 'return_pending')
                then order_date
            end as valid_order_date,
            row_number() over (
                partition by user_id order by order_date, id
            ) as user_order_seq
        from source
    )

select *
from transform
  );
[0m10:29:20.542656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:21.091184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:29:21.093725 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (execute): 10:29:20.536237 => 10:29:21.093568
[0m10:29:21.094066 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: Close
[0m10:29:21.195892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107598490>]}
[0m10:29:21.196772 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders .......... [[32mSUCCESS 1[0m in 0.67s]
[0m10:29:21.197498 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m10:29:21.197928 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_stripe__payments
[0m10:29:21.198476 [info ] [Thread-1 (]: 3 of 5 START sql view model DBT_AMOLEIRO.stg_stripe__payments .................. [RUN]
[0m10:29:21.199279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.stg_jaffle_shop__orders, now model.refactoring_for_modularity.stg_stripe__payments)
[0m10:29:21.199651 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_stripe__payments
[0m10:29:21.203025 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m10:29:21.203872 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (compile): 10:29:21.199879 => 10:29:21.203687
[0m10:29:21.204191 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_stripe__payments
[0m10:29:21.207107 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m10:29:21.208091 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_stripe__payments"
[0m10:29:21.208465 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_stripe__payments"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_stripe__payments
  
   as (
    with
    source as (select * from raw.stripe.payment),

    transform as (
        select
            id as payment_id,
            orderid as order_id,
            status as payment_status,
            round(amount / 100.0, 2) as payment_amount
        from source
    )

select *
from transform
  );
[0m10:29:21.208776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:21.697359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:29:21.703208 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (execute): 10:29:21.204391 => 10:29:21.702907
[0m10:29:21.703865 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: Close
[0m10:29:21.827938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106888a90>]}
[0m10:29:21.829511 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DBT_AMOLEIRO.stg_stripe__payments ............. [[32mSUCCESS 1[0m in 0.63s]
[0m10:29:21.830362 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_stripe__payments
[0m10:29:21.831632 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_orders
[0m10:29:21.832312 [info ] [Thread-1 (]: 4 of 5 START sql view model DBT_AMOLEIRO.int_orders ............................ [RUN]
[0m10:29:21.833354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.stg_stripe__payments, now model.refactoring_for_modularity.int_orders)
[0m10:29:21.833838 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_orders
[0m10:29:21.840848 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_orders"
[0m10:29:21.841745 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (compile): 10:29:21.834093 => 10:29:21.841557
[0m10:29:21.842087 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_orders
[0m10:29:21.845481 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_orders"
[0m10:29:21.846951 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_orders"
[0m10:29:21.847325 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_orders
  
   as (
    with
    orders as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments where payment_status <> 'fail'
    ),
    order_totals as (
        select order_id, payment_status, sum(payment_amount) as order_value_dollars
        from payments
        group by order_id, payment_status
    ),

    order_values_joined as (
        select orders.*, order_totals.payment_status, order_totals.order_value_dollars
        from orders
        left join order_totals on orders.order_id = order_totals.order_id
    )

select *
from order_values_joined
  );
[0m10:29:21.847692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:22.424445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:29:22.430289 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (execute): 10:29:21.842297 => 10:29:22.430028
[0m10:29:22.430798 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: Close
[0m10:29:22.550765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105faa310>]}
[0m10:29:22.551860 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DBT_AMOLEIRO.int_orders ....................... [[32mSUCCESS 1[0m in 0.72s]
[0m10:29:22.552821 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_orders
[0m10:29:22.553988 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m10:29:22.554748 [info ] [Thread-1 (]: 5 of 5 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m10:29:22.555964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.int_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m10:29:22.556620 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m10:29:22.562531 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:29:22.563505 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 10:29:22.556954 => 10:29:22.563273
[0m10:29:22.563905 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m10:29:22.568179 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m10:29:22.571132 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m10:29:22.571641 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    orders as (select * from analytics.DBT_AMOLEIRO.int_orders),

    customer_orders as (
        select
            orders.*,
            customers.full_name,
            customers.surname,
            customers.givenname,
            min(orders.order_date) over (
                partition by orders.customer_id
            ) as customer_first_order_date,
            min(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_first_non_returned_order_date,
            max(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_most_recent_non_returned_order_date,
            count(*) over (partition by orders.customer_id) as customer_order_count,
            sum(nvl2(orders.valid_order_date, 1, 0)) over (
                partition by orders.customer_id
            ) as customer_non_returned_order_count,
            sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over (
                partition by orders.customer_id
            ) as customer_total_lifetime_value,
            array_agg(distinct orders.order_id) over (
                partition by orders.customer_id
            ) as customer_order_ids

        from orders
        join customers on orders.customer_id = customers.customer_id
    ),

    add_avg_order_values as (
        select
            *,
            customer_total_lifetime_value
            / customer_non_returned_order_count as customer_avg_non_returned_order_value
        from customer_orders
    ),

    final as (
        select
            order_id,
            customer_id,
            surname,
            givenname,
            customer_first_order_date as first_order_date,
            customer_order_count as order_count,
            customer_total_lifetime_value as total_lifetime_value,
            order_value_dollars as order_value_dollars,
            order_status as order_status,
            payment_status as payment_status

        from add_avg_order_values
    )

select *
from final
  );
[0m10:29:22.572142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:23.243439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:29:23.249591 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 10:29:22.564158 => 10:29:23.249382
[0m10:29:23.250035 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m10:29:23.364832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35bdee6-a6bf-4e37-bc6b-0844a36f39b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6d6d0>]}
[0m10:29:23.365802 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.81s]
[0m10:29:23.366659 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m10:29:23.368625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:23.369025 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m10:29:23.369407 [info ] [MainThread]: 
[0m10:29:23.369862 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m10:29:23.371190 [debug] [MainThread]: Command end result
[0m10:29:23.379897 [info ] [MainThread]: 
[0m10:29:23.380254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:23.380526 [info ] [MainThread]: 
[0m10:29:23.380896 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:29:23.381475 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:23.381389 after 5.13 seconds
[0m10:29:23.381773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f41f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024c3510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102608650>]}
[0m10:29:23.382053 [debug] [MainThread]: Flushing usage events
[0m10:34:55.249828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e72850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7ad10>]}


============================== 10:34:55.251704 | 4cefad3f-67e9-4125-8112-32fb94546050 ==============================
[0m10:34:55.251704 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:34:55.252020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:34:55.353261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cefad3f-67e9-4125-8112-32fb94546050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e866d0>]}
[0m10:34:55.359396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cefad3f-67e9-4125-8112-32fb94546050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e91e10>]}
[0m10:34:55.359702 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:34:55.377217 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:34:55.395750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:34:55.395936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:34:55.396244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:34:55.399082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cefad3f-67e9-4125-8112-32fb94546050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b41190>]}
[0m10:34:55.403669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cefad3f-67e9-4125-8112-32fb94546050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f2f10>]}
[0m10:34:55.403901 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:34:55.404073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cefad3f-67e9-4125-8112-32fb94546050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598d3d0>]}
[0m10:34:55.404672 [info ] [MainThread]: 
[0m10:34:55.404838 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:34:55.405075 [debug] [MainThread]: Command end result
[0m10:34:55.408428 [debug] [MainThread]: Command `cli test` succeeded at 10:34:55.408381 after 0.17 seconds
[0m10:34:55.408591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042df410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104382710>]}
[0m10:34:55.408728 [debug] [MainThread]: Flushing usage events
[0m10:35:26.887973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efbdd0>]}


============================== 10:35:26.889791 | 60325f5b-f52f-4024-97a8-90df109ca7bc ==============================
[0m10:35:26.889791 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:35:26.890118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:35:26.989935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60325f5b-f52f-4024-97a8-90df109ca7bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eef4d0>]}
[0m10:35:26.996152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60325f5b-f52f-4024-97a8-90df109ca7bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f16d10>]}
[0m10:35:26.996475 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:35:27.014052 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:35:27.032478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:27.032667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:27.032966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:35:27.035735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60325f5b-f52f-4024-97a8-90df109ca7bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d5610>]}
[0m10:35:27.039853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60325f5b-f52f-4024-97a8-90df109ca7bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f8a10>]}
[0m10:35:27.040075 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:35:27.040262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60325f5b-f52f-4024-97a8-90df109ca7bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6d950>]}
[0m10:35:27.040985 [info ] [MainThread]: 
[0m10:35:27.041343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:35:27.041921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m10:35:27.047635 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:35:27.047780 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:35:27.047898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:27.807402 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:35:27.812388 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:35:27.934310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60325f5b-f52f-4024-97a8-90df109ca7bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dde10>]}
[0m10:35:27.935580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:27.936089 [info ] [MainThread]: 
[0m10:35:27.940840 [debug] [Thread-1 (]: Began running node analysis.refactoring_for_modularity.compare_queries
[0m10:35:27.941772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now analysis.refactoring_for_modularity.compare_queries)
[0m10:35:27.942214 [debug] [Thread-1 (]: Began compiling node analysis.refactoring_for_modularity.compare_queries
[0m10:35:27.968823 [debug] [Thread-1 (]: Using snowflake connection "analysis.refactoring_for_modularity.compare_queries"
[0m10:35:27.969150 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "analysis.refactoring_for_modularity.compare_queries"} */
describe table analytics.DBT_AMOLEIRO.customer_orders
[0m10:35:27.969380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:28.312842 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m10:35:28.319371 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.refactoring_for_modularity.compare_queries"
[0m10:35:28.319920 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (compile): 10:35:27.942482 => 10:35:28.319799
[0m10:35:28.320136 [debug] [Thread-1 (]: Began executing node analysis.refactoring_for_modularity.compare_queries
[0m10:35:28.320347 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (execute): 10:35:28.320255 => 10:35:28.320264
[0m10:35:28.320532 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: Close
[0m10:35:28.430699 [debug] [Thread-1 (]: Finished running node analysis.refactoring_for_modularity.compare_queries
[0m10:35:28.431778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:28.432090 [debug] [MainThread]: Connection 'analysis.refactoring_for_modularity.compare_queries' was properly closed.
[0m10:35:28.432647 [debug] [MainThread]: Command end result
[0m10:35:28.440692 [info ] [MainThread]: Compiled node 'compare_queries' is:














with a as (

    
select

  

   
    "ORDER_ID" 
    
      , 
     
   
    "CUSTOMER_ID" 
    
      , 
     
   
    "SURNAME" 
    
      , 
     
   
    "GIVENNAME" 
    
      , 
     
   
    "FIRST_ORDER_DATE" 
    
      , 
     
   
    "ORDER_COUNT" 
    
      , 
     
   
    "TOTAL_LIFETIME_VALUE" 
    
      , 
     
   
    "ORDER_VALUE_DOLLARS" 
    
      , 
     
   
    "ORDER_STATUS" 
    
      , 
     
   
    "PAYMENT_STATUS" 
     
  



from analytics.DBT_AMOLEIRO.customer_orders


),

b as (

    
select

  

   
    "ORDER_ID" 
    
      , 
     
   
    "CUSTOMER_ID" 
    
      , 
     
   
    "SURNAME" 
    
      , 
     
   
    "GIVENNAME" 
    
      , 
     
   
    "FIRST_ORDER_DATE" 
    
      , 
     
   
    "ORDER_COUNT" 
    
      , 
     
   
    "TOTAL_LIFETIME_VALUE" 
    
      , 
     
   
    "ORDER_VALUE_DOLLARS" 
    
      , 
     
   
    "ORDER_STATUS" 
    
      , 
     
   
    "PAYMENT_STATUS" 
     
  



from analytics.DBT_AMOLEIRO.fct_customer_orders


),

a_intersect_b as (

    select * from a
    

    intersect


    select * from b

),

a_except_b as (

    select * from a
    

    except


    select * from b

),

b_except_a as (

    select * from b
    

    except


    select * from a

),

all_records as (

    select
        *,
        true as in_a,
        true as in_b
    from a_intersect_b

    union all

    select
        *,
        true as in_a,
        false as in_b
    from a_except_b

    union all

    select
        *,
        false as in_a,
        true as in_b
    from b_except_a

),

summary_stats as (

    select

        in_a,
        in_b,
        count(*) as count

    from all_records
    group by 1, 2

),

final as (

    select

        *,
        round(100.0 * count / sum(count) over (), 2) as percent_of_total

    from summary_stats
    order by in_a desc, in_b desc

)

select * from final




[0m10:35:28.441366 [debug] [MainThread]: Command `cli compile` succeeded at 10:35:28.441289 after 1.56 seconds
[0m10:35:28.441663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045bf2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045bf390>]}
[0m10:35:28.441969 [debug] [MainThread]: Flushing usage events
[0m10:38:49.021439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066eac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066eb350>]}


============================== 10:38:49.023469 | 6c3aa62e-945d-4040-b618-5fca9d812b8e ==============================
[0m10:38:49.023469 [info ] [MainThread]: Running with dbt=1.5.4
[0m10:38:49.023870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:38:49.126471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c3aa62e-945d-4040-b618-5fca9d812b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066df7d0>]}
[0m10:38:49.132682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c3aa62e-945d-4040-b618-5fca9d812b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106701350>]}
[0m10:38:49.132992 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m10:38:49.150994 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m10:38:49.169316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:38:49.169497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:38:49.169807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m10:38:49.172546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c3aa62e-945d-4040-b618-5fca9d812b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e2010>]}
[0m10:38:49.176569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c3aa62e-945d-4040-b618-5fca9d812b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffbb90>]}
[0m10:38:49.176767 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:38:49.176935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3aa62e-945d-4040-b618-5fca9d812b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d39950>]}
[0m10:38:49.177532 [info ] [MainThread]: 
[0m10:38:49.177866 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:38:49.178372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics_DBT_AMOLEIRO'
[0m10:38:49.184026 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m10:38:49.184185 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m10:38:49.184303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:49.946067 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m10:38:49.950924 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m10:38:50.078317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3aa62e-945d-4040-b618-5fca9d812b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703f010>]}
[0m10:38:50.080075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:38:50.080741 [info ] [MainThread]: 
[0m10:38:50.085744 [debug] [Thread-1 (]: Began running node analysis.refactoring_for_modularity.compare_queries
[0m10:38:50.086756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now analysis.refactoring_for_modularity.compare_queries)
[0m10:38:50.087205 [debug] [Thread-1 (]: Began compiling node analysis.refactoring_for_modularity.compare_queries
[0m10:38:50.112879 [debug] [Thread-1 (]: Using snowflake connection "analysis.refactoring_for_modularity.compare_queries"
[0m10:38:50.113193 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "analysis.refactoring_for_modularity.compare_queries"} */
describe table analytics.DBT_AMOLEIRO.customer_orders
[0m10:38:50.113416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:50.462639 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m10:38:50.477310 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.refactoring_for_modularity.compare_queries"
[0m10:38:50.478390 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (compile): 10:38:50.087480 => 10:38:50.478180
[0m10:38:50.478766 [debug] [Thread-1 (]: Began executing node analysis.refactoring_for_modularity.compare_queries
[0m10:38:50.479130 [debug] [Thread-1 (]: Timing info for analysis.refactoring_for_modularity.compare_queries (execute): 10:38:50.478981 => 10:38:50.478998
[0m10:38:50.479406 [debug] [Thread-1 (]: On analysis.refactoring_for_modularity.compare_queries: Close
[0m10:38:50.585588 [debug] [Thread-1 (]: Finished running node analysis.refactoring_for_modularity.compare_queries
[0m10:38:50.586261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:50.586474 [debug] [MainThread]: Connection 'analysis.refactoring_for_modularity.compare_queries' was properly closed.
[0m10:38:50.586847 [debug] [MainThread]: Command end result
[0m10:38:50.591819 [info ] [MainThread]: Compiled node 'compare_queries' is:














with a as (

    
select

  

   
    "ORDER_ID" 
    
      , 
     
   
    "CUSTOMER_ID" 
    
      , 
     
   
    "SURNAME" 
    
      , 
     
   
    "GIVENNAME" 
    
      , 
     
   
    "FIRST_ORDER_DATE" 
    
      , 
     
   
    "ORDER_COUNT" 
    
      , 
     
   
    "TOTAL_LIFETIME_VALUE" 
    
      , 
     
   
    "ORDER_VALUE_DOLLARS" 
    
      , 
     
   
    "ORDER_STATUS" 
    
      , 
     
   
    "PAYMENT_STATUS" 
     
  



from analytics.DBT_AMOLEIRO.customer_orders


),

b as (

    
select

  

   
    "ORDER_ID" 
    
      , 
     
   
    "CUSTOMER_ID" 
    
      , 
     
   
    "SURNAME" 
    
      , 
     
   
    "GIVENNAME" 
    
      , 
     
   
    "FIRST_ORDER_DATE" 
    
      , 
     
   
    "ORDER_COUNT" 
    
      , 
     
   
    "TOTAL_LIFETIME_VALUE" 
    
      , 
     
   
    "ORDER_VALUE_DOLLARS" 
    
      , 
     
   
    "ORDER_STATUS" 
    
      , 
     
   
    "PAYMENT_STATUS" 
     
  



from analytics.DBT_AMOLEIRO.fct_customer_orders


),

a_intersect_b as (

    select * from a
    

    intersect


    select * from b

),

a_except_b as (

    select * from a
    

    except


    select * from b

),

b_except_a as (

    select * from b
    

    except


    select * from a

),

all_records as (

    select
        *,
        true as in_a,
        true as in_b
    from a_intersect_b

    union all

    select
        *,
        true as in_a,
        false as in_b
    from a_except_b

    union all

    select
        *,
        false as in_a,
        true as in_b
    from b_except_a

),

summary_stats as (

    select

        in_a,
        in_b,
        count(*) as count

    from all_records
    group by 1, 2

),

final as (

    select

        *,
        round(100.0 * count / sum(count) over (), 2) as percent_of_total

    from summary_stats
    order by in_a desc, in_b desc

)

select * from final




[0m10:38:50.592300 [debug] [MainThread]: Command `cli compile` succeeded at 10:38:50.592242 after 1.58 seconds
[0m10:38:50.592504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10271bc50>]}
[0m10:38:50.592708 [debug] [MainThread]: Flushing usage events
[0m08:59:21.151895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d44490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823ba10>]}


============================== 08:59:21.153690 | 9dc590a0-6f1e-4c15-a62f-1221366c6c7b ==============================
[0m08:59:21.153690 [info ] [MainThread]: Running with dbt=1.5.4
[0m08:59:21.154051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/andremoleiro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/andremoleiro/Documents/Learning/learning-repo/dbt/dbt_exam_preparation/dbt_projects/refactoring_for_modularity/refactoring_for_modularity_training/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:59:21.251292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108608850>]}
[0m08:59:21.257323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082560d0>]}
[0m08:59:21.257592 [info ] [MainThread]: Registered adapter: snowflake=1.5.2
[0m08:59:21.275091 [debug] [MainThread]: checksum: 5d6b65bf0937b31c1cb174f5650843d5ea9953bdf3de7df3d9ed5979670d6d21, vars: {}, profile: , target: , version: 1.5.4
[0m08:59:21.293012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:59:21.293168 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:59:21.293463 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.refactoring_for_modularity.example
[0m08:59:21.296306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824b950>]}
[0m08:59:21.300253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a31790>]}
[0m08:59:21.300439 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 1 analysis, 464 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:59:21.300616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fad750>]}
[0m08:59:21.301333 [info ] [MainThread]: 
[0m08:59:21.301722 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:59:21.302274 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m08:59:21.308255 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m08:59:21.308414 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m08:59:21.308544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:21.932224 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:59:21.936545 [debug] [ThreadPool]: On list_analytics: Close
[0m08:59:22.053957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_DBT_AMOLEIRO)
[0m08:59:22.060543 [debug] [ThreadPool]: Using snowflake connection "list_analytics_DBT_AMOLEIRO"
[0m08:59:22.060870 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "connection_name": "list_analytics_DBT_AMOLEIRO"} */
show terse objects in analytics.DBT_AMOLEIRO
[0m08:59:22.061111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:22.651542 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.0 seconds
[0m08:59:22.653101 [debug] [ThreadPool]: On list_analytics_DBT_AMOLEIRO: Close
[0m08:59:22.757887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a9ddd0>]}
[0m08:59:22.758774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:22.759118 [info ] [MainThread]: 
[0m08:59:22.762287 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m08:59:22.762705 [info ] [Thread-1 (]: 1 of 5 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ............ [RUN]
[0m08:59:22.763311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_DBT_AMOLEIRO, now model.refactoring_for_modularity.stg_jaffle_shop__customers)
[0m08:59:22.763614 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m08:59:22.769346 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m08:59:22.769936 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (compile): 08:59:22.763810 => 08:59:22.769789
[0m08:59:22.770190 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m08:59:22.788668 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m08:59:22.789420 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__customers"
[0m08:59:22.789663 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__customers"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers
  
   as (
    with
    source as (select * from raw.jaffle_shop.customers),

    transform as (
        select
            id as customer_id,
            last_name as surname,
            first_name as givenname,
            first_name || ' ' || last_name as full_name
        from source
    )

select *
from transform
  );
[0m08:59:22.789868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:23.225239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:59:23.253046 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__customers (execute): 08:59:22.770344 => 08:59:23.252846
[0m08:59:23.253456 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__customers: Close
[0m08:59:23.368155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aabb10>]}
[0m08:59:23.369447 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__customers ....... [[32mSUCCESS 1[0m in 0.60s]
[0m08:59:23.370388 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__customers
[0m08:59:23.370994 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m08:59:23.371657 [info ] [Thread-1 (]: 2 of 5 START sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders ............... [RUN]
[0m08:59:23.372694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.stg_jaffle_shop__customers, now model.refactoring_for_modularity.stg_jaffle_shop__orders)
[0m08:59:23.373266 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m08:59:23.376924 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m08:59:23.378024 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (compile): 08:59:23.373570 => 08:59:23.377765
[0m08:59:23.378566 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m08:59:23.382801 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m08:59:23.384191 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_jaffle_shop__orders"
[0m08:59:23.384622 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_jaffle_shop__orders"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders
  
   as (
    with
    source as (select * from raw.jaffle_shop.orders),

    transform as (
        select
            id as order_id,
            order_date,
            user_id as customer_id,
            status as order_status,
            case
                when order_status not in ('returned', 'return_pending')
                then order_date
            end as valid_order_date,
            row_number() over (
                partition by user_id order by order_date, id
            ) as user_order_seq
        from source
    )

select *
from transform
  );
[0m08:59:23.384990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:23.846888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:59:23.855111 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_jaffle_shop__orders (execute): 08:59:23.378985 => 08:59:23.854864
[0m08:59:23.855617 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_jaffle_shop__orders: Close
[0m08:59:23.968966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6e990>]}
[0m08:59:23.969714 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DBT_AMOLEIRO.stg_jaffle_shop__orders .......... [[32mSUCCESS 1[0m in 0.60s]
[0m08:59:23.970448 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_jaffle_shop__orders
[0m08:59:23.970915 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.stg_stripe__payments
[0m08:59:23.971547 [info ] [Thread-1 (]: 3 of 5 START sql view model DBT_AMOLEIRO.stg_stripe__payments .................. [RUN]
[0m08:59:23.972449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.stg_jaffle_shop__orders, now model.refactoring_for_modularity.stg_stripe__payments)
[0m08:59:23.972859 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.stg_stripe__payments
[0m08:59:23.976564 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m08:59:23.977350 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (compile): 08:59:23.973113 => 08:59:23.977163
[0m08:59:23.977667 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.stg_stripe__payments
[0m08:59:23.981990 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.stg_stripe__payments"
[0m08:59:23.982877 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.stg_stripe__payments"
[0m08:59:23.983182 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.stg_stripe__payments"} */
create or replace   view analytics.DBT_AMOLEIRO.stg_stripe__payments
  
   as (
    with
    source as (select * from raw.stripe.payment),

    transform as (
        select
            id as payment_id,
            orderid as order_id,
            status as payment_status,
            round(amount / 100.0, 2) as payment_amount
        from source
    )

select *
from transform
  );
[0m08:59:23.983461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:24.438753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:59:24.446824 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.stg_stripe__payments (execute): 08:59:23.977866 => 08:59:24.446637
[0m08:59:24.447220 [debug] [Thread-1 (]: On model.refactoring_for_modularity.stg_stripe__payments: Close
[0m08:59:24.558103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f49190>]}
[0m08:59:24.559328 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DBT_AMOLEIRO.stg_stripe__payments ............. [[32mSUCCESS 1[0m in 0.59s]
[0m08:59:24.560293 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.stg_stripe__payments
[0m08:59:24.561579 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.int_orders
[0m08:59:24.562100 [info ] [Thread-1 (]: 4 of 5 START sql view model DBT_AMOLEIRO.int_orders ............................ [RUN]
[0m08:59:24.563031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.stg_stripe__payments, now model.refactoring_for_modularity.int_orders)
[0m08:59:24.563516 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.int_orders
[0m08:59:24.569034 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.int_orders"
[0m08:59:24.570063 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (compile): 08:59:24.563796 => 08:59:24.569827
[0m08:59:24.570466 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.int_orders
[0m08:59:24.574533 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.int_orders"
[0m08:59:24.576019 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.int_orders"
[0m08:59:24.576402 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.int_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.int_orders
  
   as (
    with
    orders as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__orders),

    payments as (
        select * from analytics.DBT_AMOLEIRO.stg_stripe__payments where payment_status <> 'fail'
    ),
    order_totals as (
        select order_id, payment_status, sum(payment_amount) as order_value_dollars
        from payments
        group by order_id, payment_status
    ),

    order_values_joined as (
        select orders.*, order_totals.payment_status, order_totals.order_value_dollars
        from orders
        left join order_totals on orders.order_id = order_totals.order_id
    )

select *
from order_values_joined
  );
[0m08:59:24.576790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:25.206258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:59:25.211568 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.int_orders (execute): 08:59:24.570709 => 08:59:25.211266
[0m08:59:25.212102 [debug] [Thread-1 (]: On model.refactoring_for_modularity.int_orders: Close
[0m08:59:25.323689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f869d0>]}
[0m08:59:25.324760 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DBT_AMOLEIRO.int_orders ....................... [[32mSUCCESS 1[0m in 0.76s]
[0m08:59:25.325594 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.int_orders
[0m08:59:25.326701 [debug] [Thread-1 (]: Began running node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:25.327288 [info ] [Thread-1 (]: 5 of 5 START sql view model DBT_AMOLEIRO.fct_customer_orders ................... [RUN]
[0m08:59:25.328231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.refactoring_for_modularity.int_orders, now model.refactoring_for_modularity.fct_customer_orders)
[0m08:59:25.328789 [debug] [Thread-1 (]: Began compiling node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:25.333517 [debug] [Thread-1 (]: Writing injected SQL for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:59:25.334437 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (compile): 08:59:25.329081 => 08:59:25.334221
[0m08:59:25.334790 [debug] [Thread-1 (]: Began executing node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:25.338292 [debug] [Thread-1 (]: Writing runtime sql for node "model.refactoring_for_modularity.fct_customer_orders"
[0m08:59:25.341253 [debug] [Thread-1 (]: Using snowflake connection "model.refactoring_for_modularity.fct_customer_orders"
[0m08:59:25.341756 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "refactoring_for_modularity", "target_name": "dev", "node_id": "model.refactoring_for_modularity.fct_customer_orders"} */
create or replace   view analytics.DBT_AMOLEIRO.fct_customer_orders
  
   as (
    with

    customers as (select * from analytics.DBT_AMOLEIRO.stg_jaffle_shop__customers),

    orders as (select * from analytics.DBT_AMOLEIRO.int_orders),

    customer_orders as (
        select
            orders.*,
            customers.full_name,
            customers.surname,
            customers.givenname,
            min(orders.order_date) over (
                partition by orders.customer_id
            ) as customer_first_order_date,
            min(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_first_non_returned_order_date,
            max(orders.valid_order_date) over (
                partition by orders.customer_id
            ) as customer_most_recent_non_returned_order_date,
            count(*) over (partition by orders.customer_id) as customer_order_count,
            sum(nvl2(orders.valid_order_date, 1, 0)) over (
                partition by orders.customer_id
            ) as customer_non_returned_order_count,
            sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over (
                partition by orders.customer_id
            ) as customer_total_lifetime_value,
            array_agg(distinct orders.order_id) over (
                partition by orders.customer_id
            ) as customer_order_ids

        from orders
        join customers on orders.customer_id = customers.customer_id
    ),

    add_avg_order_values as (
        select
            *,
            customer_total_lifetime_value
            / customer_non_returned_order_count as customer_avg_non_returned_order_value
        from customer_orders
    ),

    final as (
        select
            order_id,
            customer_id,
            surname,
            givenname,
            customer_first_order_date as first_order_date,
            customer_order_count as order_count,
            customer_total_lifetime_value as total_lifetime_value,
            order_value_dollars as order_value_dollars,
            order_status as order_status,
            payment_status as payment_status

        from add_avg_order_values
    )

select *
from final
  );
[0m08:59:25.342183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:25.924132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:59:25.929920 [debug] [Thread-1 (]: Timing info for model.refactoring_for_modularity.fct_customer_orders (execute): 08:59:25.335002 => 08:59:25.929609
[0m08:59:25.930512 [debug] [Thread-1 (]: On model.refactoring_for_modularity.fct_customer_orders: Close
[0m08:59:26.043354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc590a0-6f1e-4c15-a62f-1221366c6c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a96250>]}
[0m08:59:26.044447 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DBT_AMOLEIRO.fct_customer_orders .............. [[32mSUCCESS 1[0m in 0.72s]
[0m08:59:26.045419 [debug] [Thread-1 (]: Finished running node model.refactoring_for_modularity.fct_customer_orders
[0m08:59:26.047816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:26.048264 [debug] [MainThread]: Connection 'model.refactoring_for_modularity.fct_customer_orders' was properly closed.
[0m08:59:26.048735 [info ] [MainThread]: 
[0m08:59:26.049288 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m08:59:26.050795 [debug] [MainThread]: Command end result
[0m08:59:26.062573 [info ] [MainThread]: 
[0m08:59:26.063101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:26.063444 [info ] [MainThread]: 
[0m08:59:26.063805 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:59:26.064435 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:26.064344 after 4.92 seconds
[0m08:59:26.064780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048abe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b7510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498fbd0>]}
[0m08:59:26.065108 [debug] [MainThread]: Flushing usage events
